<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>fangle</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,fn-in,html --> 
<meta name="src" content="fangle.tex" /> 
<meta name="date" content="2010-02-20 12:53:00" /> 
<link rel="stylesheet" type="text/css" href="fangle.css" /> 
</head><body 
>
<div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">fangle</h2>
<div class="author" ><span 
class="ecrm-1200">Sam Liddicott</span></div>
<br />
<div class="date" ><span 
class="ecrm-1200">August 2009</span></div>
                                                                  

                                                                  
</div>
                                                                  

                                                                  
<h2 class="likechapterHead"><a 
 id="x1-1000"></a>Introduction</h2>
<p class="noindent" ><span 
class="eccc-1000">N<span 
class="small-caps">E</span><span 
class="small-caps">W</span><span 
class="small-caps">F</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span>is a tool for fangled literate programming. Fangled is defined as
<span 
class="ecti-1000">New and often needlessly novel </span>by <span 
class="eccc-1000">T<span 
class="small-caps">H</span><span 
class="small-caps">E</span>F<span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">E</span>D<span 
class="small-caps">I</span><span 
class="small-caps">C</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">O</span><span 
class="small-caps">N</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">Y</span>.<span 
class="small-caps">C</span><span 
class="small-caps">O</span><span 
class="small-caps">M</span></span>.
</p><p class="noindent" >In this case, fangled means yet another new and improved method for literate
programming.
</p><p class="noindent" ><span 
class="eccc-1000">L<span 
class="small-caps">I</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span> P<span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">G</span><span 
class="small-caps">R</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span> </span>has a long history starting with the great <span 
class="eccc-1000">D<span 
class="small-caps">O</span><span 
class="small-caps">N</span><span 
class="small-caps">A</span><span 
class="small-caps">L</span><span 
class="small-caps">D</span></span>
<span 
class="eccc-1000">K<span 
class="small-caps">N</span><span 
class="small-caps">U</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span> </span>himself, whose literate programming tools seem to make use of as many
escape sequences for semantic markup as <span class="TEX">T<span 
class="E">E</span>X</span> itself.
</p><p class="noindent" ><span 
class="eccc-1000">N<span 
class="small-caps">O</span><span 
class="small-caps">R</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span> R<span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span><span 
class="small-caps">Y</span> </span>wrote the <span 
class="eccc-1000"><span 
class="small-caps">N</span><span 
class="small-caps">O</span><span 
class="small-caps">W</span><span 
class="small-caps">E</span><span 
class="small-caps">B</span> </span>set of tools (notangle, noweave and noroots)
and helpfully reduced the amount of magic character sequences to pretty much just
<span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C; </span>and <span 
class="ectt-1000">@</span>, and in doing so brought the wonders of literate programming within my
reach.
</p><p class="noindent" >While using the LY X editor for <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> editing I had various troubles with the noweb
tools, some of which were my fault, some of which were noweb&#8217;s fault and some of
which were LY X&#8217;s fault.
</p><p class="noindent" ><span 
class="eccc-1000">N<span 
class="small-caps">O</span><span 
class="small-caps">W</span><span 
class="small-caps">E</span><span 
class="small-caps">B</span> </span>generally brought literate programming to the masses through removing
some of the complexity of the original literate programming, but this would be of no
advantage to me if the LY X / <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> combination brought more complications in
their place.
</p><p class="noindent" ><span 
class="eccc-1000">N<span 
class="small-caps">E</span><span 
class="small-caps">W</span><span 
class="small-caps">F</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span>was thus born &#8212; as an awk replacement for notangle, adding some
important features, like better integration with LY X and <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>, multiple output
format conversions, and fixing notangle bugs like indentation when using -L for line
numbers.
</p><p class="noindent" >Significantly, fangle is just one program which replaces various programs in
Noweb. Noweave is done away with and implemented directly as <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> macros, and
noroots is implemented as a function of the untangler <span 
class="eccc-1000"><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">W</span><span 
class="small-caps">F</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span></span>.
</p><p class="noindent" >Fangle is written in awk for portability reasons, awk being available for most
platforms. A python conversion will probably be attempted for the benefit of LY X.
(Hasn&#8217;t anyone implemented awk in python yet?)
</p><p class="noindent" >As an extension to many literate-programming styles, Fangle permits code chunks
to take parameters and thus operate somewhat like C pre-processor macros, or like
C++ templates.
                                                                  

                                                                  
</p>
<h3 class="likesectionHead"><a 
 id="x1-2000"></a>Todo</h3>
<p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2002x1">^^ is always going to be a problem, see texbytopic 1.2.2 (Work out what
     I meant by this).
     </li>
     <li 
  class="enumerate" id="x1-2004x2">copy over up to date Makefile guide from noweb-lyx document
     </li>
     <li 
  class="enumerate" id="x1-2006x3">Make chunk-name settings only apply to chunks with that name
     </li>
     <li 
  class="enumerate" id="x1-2008x4">indent of multi-line chunks may be mode dependant (i.e. not in string
     literals)
     </li>
     <li 
  class="enumerate" id="x1-2010x5">add support for other commands in =&#x003C;...&#x003E;, starting with \label which
     takes the line-number within the chunk, and maybe should also take the
     chunk name/page
     </li>
     <li 
  class="enumerate" id="x1-2012x6">cant have listing inside a ruled box
     </li>
     <li 
  class="enumerate" id="x1-2014x7">when a parameterized chunk is included as well as the #line emission, say
     what the paremeters were for that invocation.
     </li>
     <li 
  class="enumerate" id="x1-2016x8">\chunkref[3]{preamble}  to  include  a  certain  chunk  needs  to  work  in
     fangle.awk instead of failing to be recognized at all
     </li>
     <li 
  class="enumerate" id="x1-2018x9">make          in-listins          labels          track          the          chunk
     ref too, and make \chunref{[2],thing}&#x003E; resolve to 41c (or d, or whatever
     chunk the 2nd chunk of thing is
     </li>
     <li 
  class="enumerate" id="x1-2020x10">\chunkref in text needs a trailing space maybe, it keeps butting up to the
     next word
     </li>
     <li 
  class="enumerate" id="x1-2022x11">because the white-space indent is output by the parent chunk, the #line
     is that of the parent chunk. White space indents must be passed to the
     child chunk</li></ol>
                                                                  

                                                                  
<h2 class="likechapterHead"><a 
 id="x1-3000"></a>License</h2>
<a 
 id="x1-3000doc"></a>
<p class="noindent" >Fangle is licensed under the GPL 3<span class="cite">[<span 
class="ecbx-1000">?</span>]</span> (or later). This doesn&#8217;t mean that you
can&#8217;t use or distribute fangle with sources of an incompatible license, but it
means you must make the source of fangle available too.
</p><p class="noindent" >As fangle is currently written in <span 
class="eccc-1000"><span 
class="small-caps">A</span><span 
class="small-caps">W</span><span 
class="small-caps">K</span></span>, an interpreted language, this should not be
too hard.
</p>

<a 
 id="noweb.gpl3-copyright-1"></a><a 
 id="x1-3001"></a><a 
href="#noweb.gpl3-copyright-1"><span 
class="ecrm-0800">4</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">gpl3&#8211;copyright</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gpl3-copyright-1"><span 
class="ecrm-0800">4</span></a><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-3002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fully</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">featured</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">notangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">replacement</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">awk</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">Copyright</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2009</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Sam</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Liddicott</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">sam@liddicott</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">com</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">This</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">program</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">free</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">software</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">you</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">can</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">redistribute</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">it</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">and</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">or</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modify</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">it</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">under</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terms</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">of</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">GNU</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">General</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Public</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">License</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">as</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">published</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">by</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Free</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Software</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Foundation</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">either</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">version</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">of</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">License</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">or</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">at</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">your</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">option</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">any</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">later</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">version</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">This</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">program</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">distributed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">hope</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">that</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">it</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">will</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">be</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">useful</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">but</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">WITHOUT</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ANY</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">WARRANTY</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">without</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">even</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">implied</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">warranty</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">of</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">MERCHANTABILITY</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">or</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FITNESS</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FOR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">A</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">PARTICULAR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">PURPOSE</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">See</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">GNU</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">General</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Public</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">License</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">more</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">details</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">You</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">should</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">have</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">received</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">copy</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">of</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">GNU</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">General</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Public</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">License</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-3017r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">along</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">with</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">this</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">program</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">If</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">see</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">http</span><span 
class="ectt-0800">://</span><span 
class="ectt-0800">www</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">gnu</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">org</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">licenses</span><span 
class="ectt-0800">/&#x003E;.</span>
</div>
                                                                  

                                                                  
<h2 class="likechapterHead"><a 
 id="x1-4000"></a>Contents</h2> <div class="tableofcontents">
<span class="partToc" >I&#x00A0;&#x00A0;<a 
href="#x1-5000I" id="QQ2-1-6">Using Fangle</a></span>
<br /><span class="chapterToc" >1 <a 
href="#x1-60001" id="QQ2-1-7">Running Fangle</a></span>
<br />&#x00A0;<span class="sectionToc" >1.1 <a 
href="#x1-70001.1" id="QQ2-1-8">Listing roots</a></span>
<br />&#x00A0;<span class="sectionToc" >1.2 <a 
href="#x1-80001.2" id="QQ2-1-9">Extracting roots</a></span>
<br />&#x00A0;<span class="sectionToc" >1.3 <a 
href="#x1-90001.3" id="QQ2-1-10">Formatting source in <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span></a></span>
<br /><span class="chapterToc" >2 <a 
href="#x1-100002" id="QQ2-1-11">Literate Programming with Fangle</a></span>
<br /><span class="chapterToc" >3 <a 
href="#x1-110003" id="QQ2-1-12">Using Fangle with LY X</a></span>
<br />&#x00A0;<span class="sectionToc" >3.1 <a 
href="#x1-120003.1" id="QQ2-1-13">Setting up Lyx</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.1.1 <a 
href="#x1-130003.1.1" id="QQ2-1-14">Installing the LY X module</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.1.2 <a 
href="#x1-140003.1.2" id="QQ2-1-15">Configuring the build script</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.1.3 <a 
href="#x1-150003.1.3" id="QQ2-1-16">Preparing your Lyx document</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.3.1 <a 
href="#x1-160003.1.3.1" id="QQ2-1-17">Customising the listing appearance</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.3.2 <a 
href="#x1-170003.1.3.2" id="QQ2-1-18">Global customisations</a></span>
<br />&#x00A0;<span class="sectionToc" >3.2 <a 
href="#x1-180003.2" id="QQ2-1-20">txfonts</a></span>
<br />&#x00A0;<span class="sectionToc" >3.3 <a 
href="#x1-190003.3" id="QQ2-1-21">ams pmb</a></span>
<br />&#x00A0;<span class="sectionToc" >3.4 <a 
href="#x1-200003.4" id="QQ2-1-22">Luximono</a></span>
<br /><span class="chapterToc" >4 <a 
href="#x1-210004" id="QQ2-1-23">Fangle with Makefiles</a></span>
<br />&#x00A0;<span class="sectionToc" >4.1 <a 
href="#x1-220004.1" id="QQ2-1-24">A word about makefiles formats</a></span>
<br />&#x00A0;<span class="sectionToc" >4.2 <a 
href="#x1-230004.2" id="QQ2-1-25">Boot-strapping the extraction</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.2.1 <a 
href="#x1-240004.2.1" id="QQ2-1-26">Using a Makefile</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.2.2 <a 
href="#x1-250004.2.2" id="QQ2-1-28">&hellip;</a></span>
<br />&#x00A0;<span class="sectionToc" >4.3 <a 
href="#x1-260004.3" id="QQ2-1-31">Extracting Sources</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.1 <a 
href="#x1-270004.3.1" id="QQ2-1-32">Including Makefile.inc</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.2 <a 
href="#x1-280004.3.2" id="QQ2-1-35">Recursive use of Makefile.inc</a></span>
                                                                  

                                                                  
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.3 <a 
href="#x1-290004.3.3" id="QQ2-1-39">Converting from Lyx to <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span></a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.4 <a 
href="#x1-300004.3.4" id="QQ2-1-42">Extracting Program Source</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.5 <a 
href="#x1-310004.3.5" id="QQ2-1-46">Extracting C sources</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.6 <a 
href="#x1-320004.3.6" id="QQ2-1-59">Extracting Documentation</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.6.1 <a 
href="#x1-330004.3.6.1" id="QQ2-1-60">Running pdflatex</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.6.2 <a 
href="#x1-340004.3.6.2" id="QQ2-1-63">The docs as a whole</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.7 <a 
href="#x1-350004.3.7" id="QQ2-1-67">Other helpers</a></span>
<br /><span class="partToc" >II&#x00A0;&#x00A0;<a 
href="#x1-36000II" id="QQ2-1-68">Source Code</a></span>
<br /><span class="chapterToc" >5 <a 
href="#x1-370005" id="QQ2-1-69">Fangle awk source code</a></span>
<br />&#x00A0;<span class="sectionToc" >5.1 <a 
href="#x1-380005.1" id="QQ2-1-73">AWK tricks</a></span>
<br />&#x00A0;<span class="sectionToc" >5.2 <a 
href="#x1-390005.2" id="QQ2-1-76">Catching errors</a></span>
<br /><span class="chapterToc" >6 <a 
href="#x1-400006" id="QQ2-1-79">lstlistings</a></span>
<br />&#x00A0;<span class="sectionToc" >6.1 <a 
href="#x1-410006.1" id="QQ2-1-80">Additional lstlstings parameters</a></span>
<br />&#x00A0;<span class="sectionToc" >6.2 <a 
href="#x1-420006.2" id="QQ2-1-88">Parsing chunk arguments</a></span>
<br />&#x00A0;<span class="sectionToc" >6.3 <a 
href="#x1-430006.3" id="QQ2-1-90">Expanding parameters in the text</a></span>
<br /><span class="chapterToc" >7 <a 
href="#x1-440007" id="QQ2-1-96">Language Modes &amp; Quoting</a></span>
<br />&#x00A0;<span class="sectionToc" >7.1 <a 
href="#x1-450007.1" id="QQ2-1-97">Modes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.1.1 <a 
href="#x1-460007.1.1" id="QQ2-1-98">Modes to keep code together</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.1.2 <a 
href="#x1-470007.1.2" id="QQ2-1-99">Modes to included chunks</a></span>
<br />&#x00A0;<span class="sectionToc" >7.2 <a 
href="#x1-480007.2" id="QQ2-1-103">Language Mode Definitions</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.1 <a 
href="#x1-490007.2.1" id="QQ2-1-107">Backslash</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.2 <a 
href="#x1-500007.2.2" id="QQ2-1-109">Strings</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.3 <a 
href="#x1-510007.2.3" id="QQ2-1-117">Parentheses, Braces and Brackets</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.4 <a 
href="#x1-520007.2.4" id="QQ2-1-120">Customizing Standard Modes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.5 <a 
href="#x1-530007.2.5" id="QQ2-1-123">Comments</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.6 <a 
href="#x1-540007.2.6" id="QQ2-1-134">Regex</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.7 <a 
href="#x1-550007.2.7" id="QQ2-1-136">Perl</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.2.8 <a 
href="#x1-560007.2.8" id="QQ2-1-138">sh</a></span>
<br />&#x00A0;<span class="sectionToc" >7.3 <a 
href="#x1-570007.3" id="QQ2-1-140">Some tests</a></span>
<br />&#x00A0;<span class="sectionToc" >7.4 <a 
href="#x1-580007.4" id="QQ2-1-143">A non-recursive mode tracker</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.4.1 <a 
href="#x1-590007.4.1" id="QQ2-1-144">Constructor</a></span>
                                                                  

                                                                  
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.4.2 <a 
href="#x1-600007.4.2" id="QQ2-1-147">Management</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.4.3 <a 
href="#x1-610007.4.3" id="QQ2-1-156">Tracker</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >7.4.3.1 <a 
href="#x1-620007.4.3.1" id="QQ2-1-169">One happy chunk</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >7.4.3.2 <a 
href="#x1-630007.4.3.2" id="QQ2-1-171">Tests</a></span>
<br />&#x00A0;<span class="sectionToc" >7.5 <a 
href="#x1-640007.5" id="QQ2-1-175">Escaping and Quoting</a></span>
<br /><span class="chapterToc" >8 <a 
href="#x1-650008" id="QQ2-1-179">Recognizing Chunks</a></span>
<br />&#x00A0;<span class="sectionToc" >8.1 <a 
href="#x1-660008.1" id="QQ2-1-180">Chunk start</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.1.1 <a 
href="#x1-670008.1.1" id="QQ2-1-181">lstlistings</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.1.2 <a 
href="#x1-680008.1.2" id="QQ2-1-184">Noweb</a></span>
<br />&#x00A0;<span class="sectionToc" >8.2 <a 
href="#x1-690008.2" id="QQ2-1-186">Chunk end</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.2.1 <a 
href="#x1-700008.2.1" id="QQ2-1-187">lstlistings</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.2.2 <a 
href="#x1-710008.2.2" id="QQ2-1-189">noweb</a></span>
<br />&#x00A0;<span class="sectionToc" >8.3 <a 
href="#x1-720008.3" id="QQ2-1-192">Chunk contents</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.3.1 <a 
href="#x1-730008.3.1" id="QQ2-1-196">lstlistings</a></span>
<br /><span class="chapterToc" >9 <a 
href="#x1-740009" id="QQ2-1-203">Processing Options</a></span>
<br /><span class="chapterToc" >10 <a 
href="#x1-7500010" id="QQ2-1-209">Generating the output</a></span>
<br />&#x00A0;<span class="sectionToc" >10.1 <a 
href="#x1-7600010.1" id="QQ2-1-215">Assembling the chunks</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >10.1.1 <a 
href="#x1-7700010.1.1" id="QQ2-1-218">Chunk parts</a></span>
<br /><span class="chapterToc" >11 <a 
href="#x1-7800011" id="QQ2-1-233">Storing chunks</a></span>
<br /><span class="chapterToc" >12 <a 
href="#x1-7900012" id="QQ2-1-239">getopt</a></span>
<br /><span class="chapterToc" >13 <a 
href="#x1-8000013" id="QQ2-1-247">Fangle <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> source code</a></span>
<br />&#x00A0;<span class="sectionToc" >13.1 <a 
href="#x1-8100013.1" id="QQ2-1-248">fangle module</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.1.1 <a 
href="#x1-8200013.1.1" id="QQ2-1-251">The Chunk style</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.1.2 <a 
href="#x1-8300013.1.2" id="QQ2-1-254">The chunkref style</a></span>
<br />&#x00A0;<span class="sectionToc" >13.2 <a 
href="#x1-8400013.2" id="QQ2-1-256">Latex Macros</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.2.1 <a 
href="#x1-8500013.2.1" id="QQ2-1-262">The chunk command</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >13.2.1.1 <a 
href="#x1-8600013.2.1.1" id="QQ2-1-264">Chunk parameters</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.2.2 <a 
href="#x1-8700013.2.2" id="QQ2-1-267">The noweb styled caption</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.2.3 <a 
href="#x1-8800013.2.3" id="QQ2-1-270">The chunk counter</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.2.4 <a 
href="#x1-8900013.2.4" id="QQ2-1-281">Cross references</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >13.2.5 <a 
href="#x1-9000013.2.5" id="QQ2-1-283">The end</a></span>
                                                                  

                                                                  
<br /><span class="chapterToc" >14 <a 
href="#x1-9100014" id="QQ2-1-285">Extracting fangle</a></span>
<br />&#x00A0;<span class="sectionToc" >14.1 <a 
href="#x1-9200014.1" id="QQ2-1-286">Extracting from Lyx</a></span>
<br />&#x00A0;<span class="sectionToc" >14.2 <a 
href="#x1-9300014.2" id="QQ2-1-290">Extracting documentation</a></span>
<br />&#x00A0;<span class="sectionToc" >14.3 <a 
href="#x1-9400014.3" id="QQ2-1-292">Extracting from the command line</a></span>
<br />&#x00A0;<span class="sectionToc" >14.4 <a 
href="#x1-9500014.4" id="QQ2-1-294">Testing</a></span>
<br /><span class="partToc" >III&#x00A0;&#x00A0;<a 
href="#x1-96000III" id="QQ2-1-296">Tests</a></span>
<br /><span class="chapterToc" >15 <a 
href="#x1-9700015" id="QQ2-1-297">Chunk Parameters</a></span>
<br /><span class="chapterToc" >16 <a 
href="#x1-9800016" id="QQ2-1-303">Compile-log-lyx</a></span>
</div>
                                                                  

                                                                  
<p class="noindent" >
                                                                  

                                                                  
</p>
<h1 class="partHead"><span class="titlemark">Part&#x00A0;I<br /></span><a 
 id="x1-5000I"></a>Using Fangle</h1>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-60001"></a>Running Fangle</h2>
<p class="noindent" >Fangle is a replacement for noweb, which consists of <span 
class="ectt-1000">notangle</span>, <span 
class="ectt-1000">noroots </span>and
<span 
class="ectt-1000">noweave</span>.
</p><p class="noindent" >Like <span 
class="ectt-1000">notangle </span>and <span 
class="ectt-1000">noroots </span>it can read multiple named files, or from stdin.
</p>
<h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-70001.1"></a>Listing roots</h3>
<p class="noindent" >The -r option causes fangle to behave like noroots.
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;-r</span><span 
class="ectt-1000">&#x00A0;filename.tex</span></p></dd></dl>
<p class="noindent" >will print out the fangle roots of a tex file.
</p><p class="noindent" >Unlike the <span 
class="ectt-1000">noroots </span>command, the roots are not enclosed in <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;name&#x003E;&#xFEFF;&#x003E;</span>, unless at least
one of the roots is defined using the <span 
class="ectt-1000">notangle </span>style <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;name&#x003E;&#xFEFF;&#x003E;=</span>.
</p><p class="noindent" >Also, unlike noroots, it prints out all roots &#8212; not just those that are not used
elsewhere. I find that a root not being used, doesn&#8217;t make it particularly top
level, and so-called top level roots could also be included in another root as
well.
</p><p class="noindent" >My convention is that top level roots to be extracted begin with <span 
class="ectt-1000">./ </span>and have the
form of a filename.
</p><p class="noindent" >Makefile.inc, discussed in <a 
href="#x1-210004">4<!--tex4ht:ref: cha:makefile.inc --></a>, can automatically extract all such sources.
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-80001.2"></a>Extracting roots</h3>
<p class="noindent" >notangle&#8217;s <span 
class="ectt-1000">-R </span>and <span 
class="ectt-1000">-L </span>options are supported.
</p><p class="noindent" >The standard way to extract a file would be:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;-R./Makefile.inc</span><span 
class="ectt-1000">&#x00A0;fangle.tex</span><span 
class="ectt-1000">&#x00A0;&#x003E;</span><span 
class="ectt-1000">&#x00A0;./Makefile.inc</span></p></dd></dl>
                                                                  

                                                                  
<p class="noindent" >Unlike the <span 
class="ectt-1000">noroots </span>command, the <span 
class="ectt-1000">-L </span>option does not break indenting.
</p><p class="noindent" >Also, thanks to mode tracking (described in <a 
href="#x1-440007">7<!--tex4ht:ref: cha:modes --></a>) the <span 
class="ectt-1000">-L </span>option does not interrupt (and
break) multi-line C macros either.
</p><p class="noindent" >This does mean that sometimes the compiler might calculate the source line wrongly
when generating error messages in such cases, but there isn&#8217;t any other way around if
multi-line macros include other chunks.
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-90001.3"></a>Formatting source in <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span></h3>
<p class="noindent" >The noweave replacement is a set of <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> macros dependant upon <span 
class="ecti-1000">noweb.sty</span>, and
which can be included with:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\usepackage{fangle.sty}</span></p></dd></dl>
<p class="noindent" >The <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> macros are shown in section <a 
href="#x1-8400013.2">13.2<!--tex4ht:ref: sec:Latex-Macros --></a>, and are part of a LY X module file
<span 
class="ectt-1000">fangle.module</span>, which automatically includes the macros in the document
pre-amble when the fangle LY X module is used.
</p><p class="noindent" >Because the noweave replacement is impemented in <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>, there is no
processing stage required before running the <span 
class="ectt-1000">latex </span>command. <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> may need
running two or more times, so that the code chunk references can be fully
calculated.
</p><p class="noindent" >The <span 
class="ectt-1000">noweb.sty </span>package is required as it is used for formatting the code chunk
captions
</p><p class="noindent" >The <span 
class="ectt-1000">listings.sty </span>package is also required, as it is used for formatting the code
chunks themselves.
</p><p class="noindent" >The <span 
class="ectt-1000">xargs.sty </span>package is also required.
                                                                  

                                                                  
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-100002"></a>Literate Programming with Fangle</h2>
<p class="noindent" >Todo. Should really follow on from a part-0 explanation of what literate
programming is.
                                                                  

                                                                  
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-110003"></a>Using Fangle with LY X</h2>
<h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-120003.1"></a>Setting up Lyx</h3>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1.1   </span> <a 
 id="x1-130003.1.1"></a>Installing the LY X module</h4>
<p class="noindent" >Copy <span 
class="ectt-1000">fangle.module </span>to your LY X layouts directory, which for unix users will be
<span 
class="ectt-1000">~/.lyx/layouts</span>
</p><p class="noindent" >You will need to reconfigure LY X by clicking Tools <span 
class="cmmi-10">&#x22B3; </span>Reconfigure, and then re-start
LY X.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1.2   </span> <a 
 id="x1-140003.1.2"></a>Configuring the build script</h4>
<p class="noindent" >Make sure you don&#8217;t have a conversion defined for Lyx <span 
class="tcrm-1000">&rarr; </span>Program
</p><p class="noindent" >From the menu Tools <span 
class="cmmi-10">&#x22B3; </span>Preferences, add a conversion from Latex(Plain) <span 
class="tcrm-1000">&rarr; </span>Program
as:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;-x</span><span 
class="ectt-1000">&#x00A0;;</span><span 
class="ectt-1000">&#x00A0;fangle</span><span 
class="ectt-1000">&#x00A0;-Rlyx-build</span><span 
class="ectt-1000">&#x00A0;$$i</span><span 
class="ectt-1000">&#x00A0;|</span><span 
class="ectt-1000">&#x00A0;</span>
     </p><p class="noindent" ><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;env</span><span 
class="ectt-1000">&#x00A0;LYX_b=$$b</span><span 
class="ectt-1000">&#x00A0;LYX_i=$$i</span><span 
class="ectt-1000">&#x00A0;LYX_o=$$o</span><span 
class="ectt-1000">&#x00A0;LYX_p=$$p</span><span 
class="ectt-1000">&#x00A0;LYX_r=$$r</span><span 
class="ectt-1000">&#x00A0;bash</span></p></dd></dl>
<p class="noindent" >(But don&#8217;t cut-n-paste it from this document or you&#8217;ll be pasting a multi-line string
which will break your lyx preferences file).
</p><p class="noindent" >I hope that one day, LY X will set these into the environment when calling the build
script.
</p><p class="noindent" >You may also want to consider adding options to this conversion&hellip;
</p><p class="noindent" >
                                                                  

                                                                  
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">parselog=/usr/share/lyx/scripts/listerrors</span></p></dd></dl>

<p class="noindent" >&hellip;but if you do you will lose your stderr<span class="footnote-mark"><a 
href="#fn1x4" id="fn1x4-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-14001f1"></a>.
</p><p class="noindent" >Now, a shell script chunk called <span 
class="ectt-1000">lyx-build </span>will be extracted and run whenever you
choose the Document <span 
class="cmmi-10">&#x22B3; </span>Build Program menu item.
</p><p class="noindent" >The lyx-build script for this document is in section <a 
href="#x1-9200014.1">14.1<!--tex4ht:ref: lyx-build-script --></a> and on a unix system will
extract <span 
class="ectt-1000">fangle.module </span>and the <span 
class="ectt-1000">fangle </span>awk script, and run some basic
tests.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1.3   </span> <a 
 id="x1-150003.1.3"></a>Preparing your Lyx document</h4>
<p class="noindent" >It is not necessary to base your literate document on any of the original LY X literate
classes; so select a regular class for your document type.
</p><p class="noindent" >Add the new module <span 
class="ecti-1000">Fangle Literate Listings </span>and possibly also <span 
class="ecti-1000">Logical</span>
<span 
class="ecti-1000">Markup</span>.
</p><p class="noindent" >In the drop-down style listbox you should notice a new style defined, called
<span 
class="ecti-1000">Chunk</span>.
</p><p class="noindent" >When you wish to insert a literate chunk, you enter it&#8217;s plain name in the Chunk
style, instead of the older method that used <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;name&#x003E;&#xFEFF;&#x003E;= </span>type tags. Following the
chunk name, you insert a listing with: Insert <span 
class="cmmi-10">&#x22B3; </span>Program Listing.
</p><p class="noindent" >Inside the white listing box you can type (or paste using shift+ctrl+V) your listing.
There is not need to use ctrl+enter at the end of lines as with some older LY X
literate techniques &#8212; just press enter as normal.
</p><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">3.1.3.1   </span> <a 
 id="x1-160003.1.3.1"></a>Customising the listing appearance</h5>
<p class="noindent" >In the final document, the code is formatted using the <span 
class="eccc-1000"><span 
class="small-caps">L</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">L</span><span 
class="small-caps">I</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">S</span> </span>package. The
chunk style doesn&#8217;t just define the chunk name, but can also define any other chunk
options supported by the lstlistings package <span 
class="ectt-1000">\lstset </span>command. In fact, what you
type in the chunk style is raw latex. If you want to set the chunk language without
having to right-click the listing, just add <span 
class="ectt-1000">,lanuage=C </span>after the chunk name.
(Currently the language will affect all subsequent listings, so you may need to specify
<span 
class="ectt-1000">,language= </span>quite a lot).
                                                                  

                                                                  
</p><p class="noindent" >Of course you can do this by editing the listings box advanced properties by
right-clicking on the listings box, but that takes longer, and you can&#8217;t see at-a-glance
what the advanced settings are while editing the document; also advanced settings
apply only to that box &#8212; the chunk settings apply through the rest of the
document<span class="footnote-mark"><a 
href="#fn2x4" id="fn2x4-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-16001f2"></a>.
</p><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">3.1.3.2   </span> <a 
 id="x1-170003.1.3.2"></a>Global customisations</h5>
<p class="noindent" >As <span 
class="ecti-1000">lstlistings </span>is used to set the code chunks, it&#8217;s <span 
class="ectt-1000">\lstset </span>command can be used in
the pre-amble to set some document wide settings.
</p><p class="noindent" >If your source has many words with long sequences of capital letters, then
<span 
class="ectt-1000">columns=fullflexible </span>may be a good idea, or the capital letters will get crowded.
(I think lstlistings ought to use a slightly smaller font for captial letters so that they
still fit).
</p><p class="noindent" >The font family <span 
class="ectt-1000">\ttfamily </span>looks more normal for code, but has no bold (an alternate
typewriter font is used).
</p><p class="noindent" >With <span 
class="ectt-1000">\ttfamily</span>, I must also specify <span 
class="ectt-1000">columns=fullflexible </span>or the wrong letter
spacing is used.
</p><p class="noindent" >In my Le<span class="TEX">T<span 
class="E">E</span>X</span> pre-amble I usually specialise my code format with:
</p>

<a 
 id="noweb.document-preamble-1"></a><a 
 id="x1-17001"></a><a 
href="#noweb.document-preamble-1"><span 
class="ecrm-0800">16</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">document&#8211;preamble</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.document-preamble-1"><span 
class="ecrm-0800">16</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-17002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">lstset</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">numbers</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">left</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">stepnumber</span><span 
class="ectt-0800">=1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">numbersep</span><span 
class="ectt-0800">=5</span><span 
class="ectt-0800">pt</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">breaklines</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">false</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">basicstyle</span><span 
class="ectt-0800">=\</span><span 
class="ectt-0800">footnotesize</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">ttfamily</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">numberstyle</span><span 
class="ectt-0800">=\</span><span 
class="ectt-0800">tiny</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">columns</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">fullflexible</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">numberfirstline</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">true</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-17010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >Obtaining a <span 
class="ectt-1000">bold tt font </span>can be impossibly difficult and amazingly easy. I
spent many hours at it, following complicated instructions from those
who had spend many hours over it, and was finally delivered the simple
solution<span class="footnote-mark"><a 
href="#fn3x4" id="fn3x4-bk"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-17011f3"></a>
on the lyx mailing list.
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-180003.2"></a>txfonts</h3>
<p class="noindent" >The simple way was to add this to my preamble:
</p><p class="noindent" >
                                                                  

                                                                  
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\usepackage{txfonts}</span>
     </p><p class="noindent" ><span 
class="ectt-1000">\renewcommand{\ttdefault}{txtt}</span></p></dd></dl>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-190003.3"></a>ams pmb</h3>
<p class="noindent" >The next simplest way was to use ams poor-mans-bold, and add this to the
pre-amble:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\usepackage{amsbsy}</span>
     </p><p class="noindent" ><span 
class="ectt-1000">%\renewcommand{\ttdefault}{txtt}</span>
     </p><p class="noindent" ><span 
class="ectt-1000">%somehow</span><span 
class="ectt-1000">&#x00A0;make</span><span 
class="ectt-1000">&#x00A0;\pmb</span><span 
class="ectt-1000">&#x00A0;be</span><span 
class="ectt-1000">&#x00A0;the</span><span 
class="ectt-1000">&#x00A0;command</span><span 
class="ectt-1000">&#x00A0;for</span><span 
class="ectt-1000">&#x00A0;bold,</span><span 
class="ectt-1000">&#x00A0;forgot</span><span 
class="ectt-1000">&#x00A0;how,</span><span 
class="ectt-1000">&#x00A0;sorry</span></p></dd></dl>
<p class="noindent" >It works, but looks wretched on the dvi viewer.
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-200003.4"></a>Luximono</h3>
<p class="noindent" >The <span 
class="eccc-1000"><span 
class="small-caps">L</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">L</span><span 
class="small-caps">I</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">S</span> </span>documention suggests using Luximono.
</p><p class="noindent" >Luximono was installed according to the instructions in Ubuntu Forums:
http://ubuntuforums.org/showthread.php?t=1159181 with tips from
http://miknight.blogspot.com/2005/11/how-to-install-luxi-mono-font-in.html stating
that:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">sudo</span><span 
class="ectt-1000">&#x00A0;updmap</span><span 
class="ectt-1000">&#x00A0;--enable</span><span 
class="ectt-1000">&#x00A0;MixedMap</span><span 
class="ectt-1000">&#x00A0;ul9.map</span></p></dd></dl>
                                                                  

                                                                  
<p class="noindent" >is required.
</p><p class="noindent" >It looks fine in PDF and PS view but still looks rotten in dvi view.
                                                                  

                                                                  
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-210004"></a>Fangle with Makefiles</h2>
<p class="noindent" ><span id="textcolor1"></span> This chapter needs revising 
Here we describe a Makefile.inc that you can include in your own Makefiles, or glue
as a recursive make to other projects.
</p><p class="noindent" >The Makefile.inc described here was put together for a Samba4 vfs module, but can
be used in any Make project, including automake projects.
</p>
<h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-220004.1"></a>A word about makefiles formats</h3>
<p class="noindent" >Whitespace formatting is very important in a Makefile. The first character of each
command line must be a TAB.
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">target:</span><span 
class="ectt-1000">&#x00A0;pre-requisite</span><span 
class="ectt-1000">&#x00A0;</span><br />
     <span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&rarr;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;action</span><span 
class="ectt-1000">&#x00A0;</span><br />
     <span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="tctt-1000">&rarr;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;action</span></p></dd></dl>
<p class="noindent" >But a TAB is pretty hard to enter into most of the Lyx formats and insets I&#8217;ve been
using. An alternative is to use a semi-colon after the pre-requisite, and a backslash at
the end of each line (except the last). Then any whitespace (or none) can prefix each
action.
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">target:</span><span 
class="ectt-1000">&#x00A0;pre-requisite</span><span 
class="ectt-1000">&#x00A0;;</span><span 
class="ectt-1000">&#x00A0;\</span><span 
class="ectt-1000">&#x00A0;</span><br />
     <span 
class="ectt-1000">&#x2423;&#x2423;action</span><span 
class="ectt-1000">&#x00A0;\</span><span 
class="ectt-1000">&#x00A0;</span><br />
     <span 
class="ectt-1000">&#x2423;&#x2423;action</span></p></dd></dl>
<p class="noindent" >This is the style that we use and it works pretty well for GNU make at
least.
</p><p class="noindent" >We also adopt a convention that code chunks whose names beginning with ./ should
always be automatically extracted from the document. Code chunks whose names do
not begin with ./ are for internal reference. (This doesn&#8217;t prevent such chunks from
being extracted directly).
                                                                  

                                                                  
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-230004.2"></a>Boot-strapping the extraction</h3>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.2.1   </span> <a 
 id="x1-240004.2.1"></a>Using a Makefile</h4>
<p class="noindent" >It seems convenient to have the makefile extract or update the C source files as part
of it&#8217;s operation. It also seems convenient to have the makefile itself extracted from
this document.
</p><p class="noindent" >It would also be convenient to have the code to extract the makefile from this
document to also be part of this document, however we have to start somewhere and
this unfortunately requires us to type at least a few words by hand to start things
off.
</p><p class="noindent" >Therefore we will have a minimal root fragment, which, when extracted, can cope
with extracting the rest of the source. perhaps with this shell script, which could be
called <span 
class="ecti-1000">autoboot</span>.
</p>

<a 
 id="noweb.*-1"></a><a 
 id="x1-24001"></a><a 
href="#noweb.*-1"><span 
class="ecrm-0800">20</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">* </span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.*-1"><span 
class="ecrm-0800">20</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-24002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">#!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">bin</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">sh</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">="${1:-${</span><span 
class="ectt-0800">NW</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">:-../../</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">3.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">}}"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">=&#8216;</span><span 
class="ectt-0800">dirname</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">"&#8216;/&#8216;</span><span 
class="ectt-0800">basename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">&#8216;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">NOWEB</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">="${2:-${</span><span 
class="ectt-0800">NOWEB</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">:-$</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">}}"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">latex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">${</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">}.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">sed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"/</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=/</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">/^/#/;</span><span 
class="ectt-0800">T</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">aNOWEB</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=$</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cpif</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-24013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">make</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span>
</div>
<p class="noindent" >The general Makefile can be invoked with <span 
class="ecti-1000">./autoboot </span>and can also be included into
any automake file to automatically re-generate the source files.
</p><p class="noindent" >The <span 
class="ecti-1000">autoboot </span>can be extracted with this command:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;-e</span><span 
class="ectt-1000">&#x00A0;latex</span><span 
class="ectt-1000">&#x00A0;fangle.lyx</span><span 
class="ectt-1000">&#x00A0;&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;\</span>
     </p><p class="noindent" ><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;fangle.lyx</span><span 
class="ectt-1000">&#x00A0;&#x003E;</span><span 
class="ectt-1000">&#x00A0;./autoboot</span></p></dd></dl>
<p class="noindent" >This looks simple enough, but as mentioned, fangle has to be had from
somewhere before it can be extracted.
                                                                  

                                                                  
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.2.2   </span> <a 
 id="x1-250004.2.2"></a>&hellip;</h4>
<p class="noindent" >When the lyx-build chunk is executed, the current directory will be a temporary
directory, and <span 
class="ectt-1000">LYX_SOURCE </span>will refer to the tex file in this temporary directory. This
is unfortunate as our makefile wants to run from the project directory where the Lyx
file is kept.
</p><p class="noindent" >We can extract the project directory from $$r, and derive the probable Lyx filename
from the noweb file that Lyx generated.
</p>

<a 
 id="noweb.lyx-build-helper-1"></a><a 
 id="x1-25001"></a><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build&#8211;helper</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-helper-2"><span 
class="ecrm-0800">86c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-25002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">PROJECT</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DIR</span><span 
class="ectt-0800">="$</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">="$</span><span 
class="ectt-0800">PROJECT</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DIR</span><span 
class="ectt-0800">/${</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">i</span><span 
class="ecit-0800">%</span><span 
class="ecit-0800">.</span><span 
class="ecit-0800">tex</span><span 
class="ecit-0800">}.</span><span 
class="ecit-0800">lyx</span><span 
class="ecit-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DIR</span><span 
class="ectt-0800">="$</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SRC</span><span 
class="ectt-0800">="$</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DIR</span><span 
class="ectt-0800">/$</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">"</span>
</div>
<p class="noindent" >And then we can define a lyx-build fragment similar to the autoboot fragment
</p>

<a 
 id="noweb.lyx-build-1"></a><a 
 id="x1-25006"></a><a 
href="#noweb.lyx-build-1"><span 
class="ecrm-0800">21b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-1"><span 
class="ecrm-0800">21b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-2"><span 
class="ecrm-0800">86a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-25007r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">#!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">bin</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">sh</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25008r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">lyx&#8211;build&#8211;helper</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25009r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">PROJECT</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DIR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25010r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25011r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">#/</span><span 
class="ectt-0800">usr</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">bin</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">filter</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">notanglefix</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">filter</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25012r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"../../</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">3.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25013r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">sed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#8217;/</span><span 
class="ectt-0800">NOWEB</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=/</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">/=.*/=</span><span 
class="ectt-0800">samba</span><span 
class="ectt-0800">4-</span><span 
class="ectt-0800">dfs</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">/&#8217;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25014r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25015r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-25016r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">make</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">./</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-260004.3"></a>Extracting Sources</h3>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.1   </span> <a 
 id="x1-270004.3.1"></a>Including Makefile.inc</h4>
<p class="noindent" >Makefile.inc will cope with extracting all the other source files from this document
and keeping them up to date.
</p><p class="noindent" >It may also be included by a Makefile or Makefile.am defined in a Lyx document to
automatically deal with the extraction of source files and documents.
</p><p class="noindent" >A makefile has two parts; variables must be defined before the targets that use
them.
                                                                  

                                                                  
</p>

<a 
 id="noweb../Makefile.inc-1"></a><a 
 id="x1-27001"></a><a 
href="#noweb../Makefile.inc-1"><span 
class="ecrm-0800">22a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./Makefile.inc</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../Makefile.inc-1"><span 
class="ecrm-0800">22a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;  </span><div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-27002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We first define <span 
class="ectt-1000">NOWEB_SOURCE </span>to hold the name of this Lyx file.
</p>

<a 
 id="noweb.Makefile.inc-vars-1"></a><a 
 id="x1-27004"></a><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-2"><span 
class="ecrm-0800">23c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-27005r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27006r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">LITERATE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.2   </span> <a 
 id="x1-280004.3.2"></a>Recursive use of Makefile.inc</h4>
<p class="noindent" >The makefile glue described here is used when building Samba4 vfs modules.
</p><p class="noindent" >If you are defining a module of an existing program you may find it easier to use a
slight recursive make instead of including the makefile directly. This way there is
less chance of definitions in Makefile.inc interfering with definitions in the
main makefile, or with definitions in other Makefile.inc from other noweb
modules.
</p><p class="noindent" >The glue works by adding a .PHONY target to call the recursive make, and adding
this target as an additional pre-requisite to the existing targets.
</p><p class="noindent" >In this example, the existing build system already has a build target for <span 
class="ectt-1000">example.o</span>,
so we just add another pre-requisite to that. In this case we use <span 
class="ectt-1000">example.tex.stamp</span>
as a pre-requisite, the stamp file&#8217;s modified time indicating when all sources were
extracted.
</p>

<a 
 id="noweb.makefile-glue-1"></a><a 
 id="x1-28001"></a><a 
href="#noweb.makefile-glue-1"><span 
class="ecrm-0800">22c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">makefile&#8211;glue</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.makefile-glue-1"><span 
class="ecrm-0800">22c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.makefile-glue-2"><span 
class="ecrm-0800">23a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-28002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)/</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">o</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)/</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">stamp</span>
</div>
<p class="noindent" >The target for this new pre-requisite is generated by a recursive make using
Makefile.inc which will make sure that the source is up to date, before it is built by
the main projects makefile.
</p>

                                                                  

                                                                  
<a 
 id="noweb.makefile-glue-2"></a><a 
 id="x1-28003"></a><a 
href="#noweb.makefile-glue-2"><span 
class="ecrm-0800">23a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">makefile&#8211;glue</span><span 
class="ecrm-0800">[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.makefile-glue-1"><span 
class="ecrm-0800">22c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.makefile-glue-1"><span 
class="ecrm-0800">22c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.makefile-glue-3"><span 
class="ecrm-0800">23b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-28004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)/</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">stamp</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)/</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span>
</div>
<p class="noindent" >We can do similar glue for the docs, clean and distclean targets. In this example our
build system is using a double colon for these targets, so we use the same in our
glue.
</p>

<a 
 id="noweb.makefile-glue-3"></a><a 
 id="x1-28007"></a><a 
href="#noweb.makefile-glue-3"><span 
class="ecrm-0800">23b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">makefile&#8211;glue</span><span 
class="ecrm-0800">[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.makefile-glue-1"><span 
class="ecrm-0800">22c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.makefile-glue-2"><span 
class="ecrm-0800">23a</span></a><div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-28008r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">::</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28009r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28010r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">::</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28011r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28012r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28013r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">::</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28014r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONEY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28015r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28016r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28017r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28018r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">::</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28019r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28020r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">example</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">srcdir</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-28021r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">MAKE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Makefile</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">inc</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">distclean</span>
</div>
<p class="noindent" >We could do similarly for install targets to install the generated docs.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.3   </span> <a 
 id="x1-290004.3.3"></a>Converting from Lyx to <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span></h4>
<p class="noindent" >The first stage will always be to convert the Lyx file to a <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> file; this must be so not
only because fangle needs to to run on a <span class="TEX">T<span 
class="E">E</span>X</span> file, but also because the Lyx command
<span 
class="ecti-1000">server-goto-file-line</span><span class="footnote-mark"><a 
href="#fn1x5" id="fn1x5-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-29001f1"></a>
insists that the line number provided is a line in the <span class="TEX">T<span 
class="E">E</span>X</span> file, and always reverse
maps this to derive the line in the Lyx docment.
</p><p class="noindent" >The command [[lyx -e literate noweb-lyx.lyx]] will produce [[noweb-lyx.nw]] a tex file,
so we define the noweb target to be the same as the Lyx file but with the .nw
extension.
</p>

<a 
 id="noweb.Makefile.inc-vars-2"></a><a 
 id="x1-29002"></a><a 
href="#noweb.Makefile.inc-vars-2"><span 
class="ecrm-0800">23c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-3"><span 
class="ecrm-0800">24a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-29003r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">:.</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">)</span>
</div>

<a 
 id="noweb.Makefile.inc-targets-1"></a><a 
 id="x1-29004"></a><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-2"><span 
class="ecrm-0800">24c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-12"><span class="label"><a 
 id="x1-29005r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">):</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">LYX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29006r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lyx</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">latex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$&#x003C;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-29007r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rm</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.4   </span> <a 
 id="x1-300004.3.4"></a>Extracting Program Source</h4>
<p class="noindent" >The program source is extracted using fangle, which is designed to operate on a
<span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> document.
</p>

<a 
 id="noweb.Makefile.inc-vars-3"></a><a 
 id="x1-30001"></a><a 
href="#noweb.Makefile.inc-vars-3"><span 
class="ecrm-0800">24a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span> <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-2"><span 
class="ecrm-0800">23c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-4"><span 
class="ecrm-0800">24b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-13"><span class="label"><a 
 id="x1-30002r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >The Lyx document can result in any number of source documents, but not all of
these will be changed each time the Lyx document is updated. We certainly don&#8217;t
want to update the timestamps of these files and cause the whole source tree to be
recompiled just because the Lyx document was edited.
</p><p class="noindent" >To solve this problem we use a stamp file which is always updated each time the
sources are extracted from the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> document. If the stamp file is older
than the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> document, then we can make an attempt to re-extract the
sources.
</p>

<a 
 id="noweb.Makefile.inc-vars-4"></a><a 
 id="x1-30003"></a><a 
href="#noweb.Makefile.inc-vars-4"><span 
class="ecrm-0800">24b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-3"><span 
class="ecrm-0800">24a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-5"><span 
class="ecrm-0800">25a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-14"><span class="label"><a 
 id="x1-30004r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">).</span><span 
class="ectt-0800">stamp</span>
</div>

<a 
 id="noweb.Makefile.inc-targets-2"></a><a 
 id="x1-30005"></a><a 
href="#noweb.Makefile.inc-targets-2"><span 
class="ecrm-0800">24c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-3"><span 
class="ecrm-0800">25b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-15"><span class="label"><a 
 id="x1-30006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">):</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCES</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">stamp</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rm</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-30010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">stamp</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.5   </span> <a 
 id="x1-310004.3.5"></a>Extracting C sources</h4>
<p class="noindent" >We compute <span 
class="ectt-1000">FANGLE_SOURCES </span>to hold the names of all the C source files defined
in this document. We compute this only once, by means of := in assignent. The sed
deletes the any &#x003C;&#x003C; and &#x003E;&#x003E; which may surround the roots names (for noroots
compatibility).
                                                                  

                                                                  
</p><p class="noindent" >As we use chunk names beginning with ./ to denote top level fragments
that should be extracted, we filter out all fragments that do not begin with
./
</p>

<a 
 id="noweb.Makefile.inc-vars-5"></a><a 
 id="x1-31001"></a><a 
href="#noweb.Makefile.inc-vars-5"><span 
class="ecrm-0800">25a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-4"><span 
class="ecrm-0800">24b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-6"><span 
class="ecrm-0800">25e</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-31002r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PREFIX</span><span 
class="ectt-0800">:=\.\/</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31003r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCES</span><span 
class="ectt-0800">:=$(</span><span 
class="ectt-0800">shell</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31004r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31005r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">sed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">/^[&#x003C;][&#x003C;]//;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">/[&#x003E;][&#x003E;]$$//;/^$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PREFIX</span><span 
class="ectt-0800">)/!</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31006r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">/^$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PREFIX</span><span 
class="ectt-0800">)/\.\//&#8217;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31007r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">@</span>
</div>

<a 
 id="noweb.Makefile.inc-targets-3"></a><a 
 id="x1-31008"></a><a 
href="#noweb.Makefile.inc-targets-3"><span 
class="ecrm-0800">25b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-2"><span 
class="ecrm-0800">24c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-4"><span 
class="ecrm-0800">25c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-17"><span class="label"><a 
 id="x1-31009r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31010r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">@echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCES</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >We define a convenient target called <span 
class="ectt-1000">fangle_sources </span>to re-extract the source if
the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> file has been updated.
</p>

<a 
 id="noweb.Makefile.inc-targets-4"></a><a 
 id="x1-31011"></a><a 
href="#noweb.Makefile.inc-targets-4"><span 
class="ecrm-0800">25c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-3"><span 
class="ecrm-0800">25b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-5"><span 
class="ecrm-0800">25d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-18"><span class="label"><a 
 id="x1-31012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >And also a convenient target to remove extracted sources.
</p>

<a 
 id="noweb.Makefile.inc-targets-5"></a><a 
 id="x1-31014"></a><a 
href="#noweb.Makefile.inc-targets-5"><span 
class="ecrm-0800">25d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-4"><span 
class="ecrm-0800">25c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-6"><span 
class="ecrm-0800">27b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-19"><span class="label"><a 
 id="x1-31015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rm</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">STAMP</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCES</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >This <span 
class="ectt-1000">if_extension </span>macro takes 4 arguments: the filename (1), some extensions to
match (2) and a some shell command to return if the filename matches the exentions
(3), or not (4).
</p>

<a 
 id="noweb.Makefile.inc-vars-6"></a><a 
 id="x1-31018"></a><a 
href="#noweb.Makefile.inc-vars-6"><span 
class="ecrm-0800">25e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-5"><span 
class="ecrm-0800">25a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-7"><span 
class="ecrm-0800">26a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-31019r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">extension</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">findstring</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">suffix</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(1)),$(2)),$(3),$(4))</span>
</div>
<p class="noindent" >For some source files like C files, we want to output the line number and filename of
the original <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> document from which the source came.
                                                                  

                                                                  
</p><p class="noindent" >To make this easier we define the file extensions for which we want to do
this.
</p>

<a 
 id="noweb.Makefile.inc-vars-7"></a><a 
 id="x1-31020"></a><a 
href="#noweb.Makefile.inc-vars-7"><span 
class="ecrm-0800">26a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[7]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>       <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-6"><span 
class="ecrm-0800">25e</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-8"><span 
class="ecrm-0800">26b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-31021r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">EXTENSIONS</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">h</span>
</div>
<p class="noindent" >We can then use the if_extensions macro to define a macro which expands out to the
<span 
class="ectt-1000">-L </span>option if fangle is being invoked in a C source file, so that C compile errors
will refer to the line number in the Lyx document.
</p>

<a 
 id="noweb.Makefile.inc-vars-8"></a><a 
 id="x1-31022"></a><a 
href="#noweb.Makefile.inc-vars-8"><span 
class="ecrm-0800">26b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[8]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-7"><span 
class="ecrm-0800">26a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-9"><span 
class="ecrm-0800">26c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-31023r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">TABS</span><span 
class="ectt-0800">=8</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31024r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">nf</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">=-</span><span 
class="ectt-0800">L</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">T</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TABS</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31025r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31026r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">call</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">extension</span><span 
class="ectt-0800">,$(2),$(</span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">EXTENSIONS</span><span 
class="ectt-0800">),$(</span><span 
class="ectt-0800">nf</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31027r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">"$(2)"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(1)</span>
</div>
<p class="noindent" >We can use a similar trick to define an <span 
class="ecti-1000">indent </span>macro which takes just the filename as
an argument and can return a pipeline stage calling the indent command. Indent can
be turned off with <span 
class="ectt-1000">make fangle_sources indent=</span>
</p>

<a 
 id="noweb.Makefile.inc-vars-9"></a><a 
 id="x1-31028"></a><a 
href="#noweb.Makefile.inc-vars-9"><span 
class="ecrm-0800">26c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[9]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-8"><span 
class="ecrm-0800">26b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-10"><span 
class="ecrm-0800">26d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-23"><span class="label"><a 
 id="x1-31029r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">=-</span><span 
class="ectt-0800">npro</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">kr</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">8</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">ts</span><span 
class="ectt-0800">8</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">sob</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">80</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">ss</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">ncs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31030r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">call</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">extension</span><span 
class="ectt-0800">,$(1),$(</span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">EXTENSIONS</span><span 
class="ectt-0800">),\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31031r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">))</span>
</div>
<p class="noindent" >We now define the pattern for extracting a file. The files are written using noweb&#8217;s
<span 
class="ecti-1000">cpif</span> <span class="footnote-mark"><a 
href="#fn2x5" id="fn2x5-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-31032f2"></a>
so that the file timestamp will not be touched if the contents haven&#8217;t changed. This
avoids the need to rebuild the entire project because of a typographical change in the
documentation, or if only a few C source files have changed.
</p>

<a 
 id="noweb.Makefile.inc-vars-10"></a><a 
 id="x1-31033"></a><a 
href="#noweb.Makefile.inc-vars-10"><span 
class="ecrm-0800">26d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[10]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-9"><span 
class="ecrm-0800">26c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-11"><span 
class="ecrm-0800">27a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-24"><span class="label"><a 
 id="x1-31034r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">extract</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">@mkdir</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">dir</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(1))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31035r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">call</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">,$(2),$(1))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$(1).</span><span 
class="ectt-0800">tmp</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31036r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cat</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$(1).</span><span 
class="ectt-0800">tmp</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cpif</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$(1)"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31037r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rm</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"$(1).</span><span 
class="ectt-0800">tmp</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31038r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">newfangling</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">from</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(2)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span>
</div>
<p class="noindent" >We define a target which will extract or update all sources. To do this we first
defined a makefile template that can do this for any source file in the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>
document.
</p>

                                                                  

                                                                  
<a 
 id="noweb.Makefile.inc-vars-11"></a><a 
 id="x1-31039"></a><a 
href="#noweb.Makefile.inc-vars-11"><span 
class="ecrm-0800">27a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[11]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-10"><span 
class="ecrm-0800">26d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-12"><span 
class="ecrm-0800">27d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-25"><span class="label"><a 
 id="x1-31040r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">define</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">template</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31041r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(1):</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(2);</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31042r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$$(</span><span 
class="ectt-0800">call</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">extract</span><span 
class="ectt-0800">,$(1),$(2))</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31043r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">TARGETS</span><span 
class="ectt-0800">+=$(1)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31044r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">endef</span>
</div>
<p class="noindent" >We then enumerate the discovered <span 
class="ectt-1000">NEWTANGLE_SOURCES </span>to generate a makefile rule
for each one using the makefile template we defined above.
</p>

<a 
 id="noweb.Makefile.inc-targets-6"></a><a 
 id="x1-31045"></a><a 
href="#noweb.Makefile.inc-targets-6"><span 
class="ecrm-0800">27b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-5"><span 
class="ecrm-0800">25d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-7"><span 
class="ecrm-0800">27c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-26"><span class="label"><a 
 id="x1-31046r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">foreach</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">source</span><span 
class="ectt-0800">,$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCES</span><span 
class="ectt-0800">),\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31047r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">eval</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">call</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">template</span><span 
class="ectt-0800">,$(</span><span 
class="ectt-0800">source</span><span 
class="ectt-0800">),$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">)))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-31048r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >These will all be built with FANGLE_SOURCE_STAMP.
</p><p class="noindent" >We also remove the generated sources on a <span 
class="ecti-1000">make distclean</span>.
</p>

<a 
 id="noweb.Makefile.inc-targets-7"></a><a 
 id="x1-31049"></a><a 
href="#noweb.Makefile.inc-targets-7"><span 
class="ecrm-0800">27c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[7]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-6"><span 
class="ecrm-0800">27b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-8"><span 
class="ecrm-0800">28a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-27"><span class="label"><a 
 id="x1-31050r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">sources</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.6   </span> <a 
 id="x1-320004.3.6"></a>Extracting Documentation</h4>
<p class="noindent" >We then identify the intermediate stages of the documentation and their build and
clean targets.
</p><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">4.3.6.1   </span> <a 
 id="x1-330004.3.6.1"></a>Running pdflatex</h5>
<p class="noindent" >We produce a pdf file from the tex file.
</p>

<a 
 id="noweb.Makefile.inc-vars-12"></a><a 
 id="x1-33001"></a><a 
href="#noweb.Makefile.inc-vars-12"><span 
class="ecrm-0800">27d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[12]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-11"><span 
class="ecrm-0800">27a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-13"><span 
class="ecrm-0800">28b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-28"><span class="label"><a 
 id="x1-33002r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PDF</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">:.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">pdf</span><span 
class="ectt-0800">)</span>
                                                                  

                                                                  
</div>
<p class="noindent" >We run pdflatex twice to be sure that the contents and aux files are up to
date. We certainly are required to run pdflatex twice if these files do not
exist!
</p>

<a 
 id="noweb.Makefile.inc-targets-8"></a><a 
 id="x1-33003"></a><a 
href="#noweb.Makefile.inc-targets-8"><span 
class="ecrm-0800">28a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[8]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-7"><span 
class="ecrm-0800">27c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-9"><span 
class="ecrm-0800">28c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-29"><span class="label"><a 
 id="x1-33004r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PDF</span><span 
class="ectt-0800">):</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">pdflatex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$&#x003C;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">pdflatex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$&#x003C;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-33005r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">pdf</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rm</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PDF</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-33006r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">:.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">toc</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-33007r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">:.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">log</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-33008r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">TEX</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">SOURCE</span><span 
class="ectt-0800">:.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">=.</span><span 
class="ectt-0800">aux</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">4.3.6.2   </span> <a 
 id="x1-340004.3.6.2"></a>The docs as a whole</h5>
<p class="noindent" >Currently we only build pdf as a final format, but FANGLE_DOCS may later
hold other output formats.
</p>

<a 
 id="noweb.Makefile.inc-vars-13"></a><a 
 id="x1-34001"></a><a 
href="#noweb.Makefile.inc-vars-13"><span 
class="ecrm-0800">28b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;vars</span><span 
class="ecrm-0800">[13]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-vars-1"><span 
class="ecrm-0800">22b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>   <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-vars-12"><span 
class="ecrm-0800">27d</span></a><div class="lstlisting" id="listing-30"><span class="label"><a 
 id="x1-34002r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DOCS</span><span 
class="ectt-0800">=$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">PDF</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >We also define fangle_docs as a convenient phony target&#x003C;
</p>

<a 
 id="noweb.Makefile.inc-targets-9"></a><a 
 id="x1-34003"></a><a 
href="#noweb.Makefile.inc-targets-9"><span 
class="ecrm-0800">28c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[9]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-8"><span 
class="ecrm-0800">28a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-10"><span 
class="ecrm-0800">28d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-31"><span class="label"><a 
 id="x1-34004r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34005r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$(</span><span 
class="ectt-0800">FANGLE</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">DOCS</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34006r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span>
</div>
<p class="noindent" >And define a convenient clean_noweb_docs which we add to the regular clean
target
</p>

<a 
 id="noweb.Makefile.inc-targets-10"></a><a 
 id="x1-34007"></a><a 
href="#noweb.Makefile.inc-targets-10"><span 
class="ecrm-0800">28d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">Makefile.inc&#8211;targets</span><span 
class="ecrm-0800">[10]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.Makefile.inc-targets-1"><span 
class="ecrm-0800">23d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.Makefile.inc-targets-9"><span 
class="ecrm-0800">28c</span></a><div class="lstlisting" id="listing-32"><span class="label"><a 
 id="x1-34008r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">PHONEY</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34009r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">pdf</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34010r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34011r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34012r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-34013r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">clean</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">distclean</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">docs</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3.7   </span> <a 
 id="x1-350004.3.7"></a>Other helpers</h4>
<p class="noindent" >If Makefile.inc is included into Makefile, then extracted files can be updated with this
command:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">make</span><span 
class="ectt-1000">&#x00A0;fangle_sources</span></p></dd></dl>
<p class="noindent" >otherwise, with:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">make</span><span 
class="ectt-1000">&#x00A0;-f</span><span 
class="ectt-1000">&#x00A0;Makefile.inc</span><span 
class="ectt-1000">&#x00A0;fangle_sources</span></p></dd></dl>
                                                                  

                                                                  
<p class="noindent" >
                                                                  

                                                                  
</p>
<h1 class="partHead"><span class="titlemark">Part&#x00A0;II<br /></span><a 
 id="x1-36000II"></a>Source Code</h1>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-370005"></a>Fangle awk source code</h2>
<p class="noindent" >We use the copyright notice from chapter <a 
href="#x1-3000doc"><!--tex4ht:ref: cha:License --></a>.
</p>

<a 
 id="noweb../fangle-1"></a><a 
 id="x1-37001"></a><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle</span><span 
class="ecrm-0800">[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;    </span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-2"><span 
class="ecrm-0800">32b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-33"><span class="label"><a 
 id="x1-37002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">!</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">/</span><span 
class="ecit-0800">usr</span><span 
class="ecit-0800">/</span><span 
class="ecit-0800">bin</span><span 
class="ecit-0800">/</span><span 
class="ecit-0800">awk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">-</span><span 
class="ecit-0800">f</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">gpl3&#8211;copyright</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gpl3-copyright-1"><span 
class="ecrm-0800">4</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We also use code from Arnold Robbins public domain getopt (1993 revision) defined
in chapter <a 
href="#x1-7900012">12<!--tex4ht:ref: cha:getopt --></a>, and naturally want to attribute this appropriately.
</p>

<a 
 id="noweb../fangle-2"></a><a 
 id="x1-37006"></a><a 
href="#noweb../fangle-2"><span 
class="ecrm-0800">32b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle</span><span 
class="ecrm-0800">[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-3"><span 
class="ecrm-0800">32c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-34"><span class="label"><a 
 id="x1-37007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">NOTE</span><span 
class="ecit-0800">:</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Arnold</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Robbins</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">public</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">domain</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">getopt</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">for</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">awk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">is</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">also</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">used</span><span 
class="ecit-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;header</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-header-1"><span 
class="ecrm-0800">73a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;getopt()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >And include the following chunks
</p>

<a 
 id="noweb../fangle-3"></a><a 
 id="x1-37014"></a><a 
href="#noweb../fangle-3"><span 
class="ecrm-0800">32c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle</span><span 
class="ecrm-0800">[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle-2"><span 
class="ecrm-0800">32b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-4"><span 
class="ecrm-0800">35</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-35"><span class="label"><a 
 id="x1-37015r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">helper&#8211;functions</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.helper-functions-1"><span 
class="ecbx-0800">??</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37016r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode&#8211;tracker</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-tracker-1"><span 
class="ecrm-0800">56b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37017r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse_chunk_args</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-1"><span 
class="ecrm-0800">38</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37018r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">chunk&#8211;storage&#8211;functions</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37019r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">output_chunk_names()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.output_chunk_names()-1"><span 
class="ecrm-0800">66d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37020r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">output_chunks()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.output_chunks()-1"><span 
class="ecrm-0800">66e</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37021r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">write_chunk()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37022r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">expand_chunk_args()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.expand_chunk_args()-1"><span 
class="ecrm-0800">39a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37023r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">begin</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.begin-1"><span 
class="ecrm-0800">65d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37024r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">recognize&#8211;chunk</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-37025r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">end</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.end-1"><span 
class="ecrm-0800">66c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-380005.1"></a>AWK tricks</h3>
<p class="noindent" >The portable way to erase an array in awk is to split the empty string, like
this:
</p>

<a 
 id="noweb.awk-delete-array-1"></a><a 
 id="x1-38001"></a><a 
href="#noweb.awk-delete-array-1"><span 
class="ecrm-0800">32d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">awk&#8211;delete&#8211;array</span><span 
class="ecrm-0800">(ARRAY)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.awk-delete-array-1"><span 
class="ecrm-0800">32d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;          </span><div class="lstlisting" id="listing-36"><span class="label"><a 
 id="x1-38002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">ARRAY</span><span 
class="ectt-0800">});</span>
</div>

<a 
 id="noweb.dump-array-1"></a><a 
 id="x1-38003"></a><a 
href="#noweb.dump-array-1"><span 
class="ecrm-0800">32e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">dump&#8211;array</span><span 
class="ecrm-0800">(ARRAY)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.dump-array-1"><span 
class="ecrm-0800">32e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-37"><span class="label"><a 
 id="x1-38004r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">nDump</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">ARRAY</span><span 
class="ectt-0800">}\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">--------\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38005r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_x</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">ARRAY</span><span 
class="ectt-0800">})</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38006r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_x</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">ARRAY</span><span 
class="ectt-0800">}[</span><span 
class="ectt-0800">_x</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38007r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-38008r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">========\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-390005.2"></a>Catching errors</h3>
<p class="noindent" >Fatal errors are issued with the error function:
</p>

<a 
 id="noweb.error()-1"></a><a 
 id="x1-39001"></a><a 
href="#noweb.error()-1"><span 
class="ecrm-0800">33a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">error()</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.error()-1"><span 
class="ecrm-0800">33a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;helper-functions</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.error()-2"><span 
class="ecrm-0800">33b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-38"><span class="label"><a 
 id="x1-39002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">message</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">ERROR</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FNR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">message</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.error()-2"></a><a 
 id="x1-39007"></a><a 
href="#noweb.error()-2"><span 
class="ecrm-0800">33b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">error()</span><span 
class="ecrm-0800">()[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.error()-1"><span 
class="ecrm-0800">33a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.error()-1"><span 
class="ecrm-0800">33a</span></a><div class="lstlisting" id="listing-39"><span class="label"><a 
 id="x1-39008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">warning</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">message</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">WARNING</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FNR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">message</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">warnings</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-39012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">}</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-400006"></a>lstlistings</h2>
<p class="noindent" ><span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> arguments to lstlistings macros are a comma seperated list of key-value
pairs. Values containing commas are enclosed in <span 
class="ectt-1000">{ </span>braces <span 
class="ectt-1000">}</span>, which is to be expected
for <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>.
</p><p class="noindent" >A sample expressions is:
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">name=thomas,</span><span 
class="ectt-1000">&#x00A0;params={a,</span><span 
class="ectt-1000">&#x00A0;b},</span><span 
class="ectt-1000">&#x00A0;something,</span><span 
class="ectt-1000">&#x00A0;something-else</span></p></dd></dl>
<p class="noindent" >but we see that this is just a simpler form of this expression:
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">name=freddie,</span><span 
class="ectt-1000">&#x00A0;foo={bar=baz,</span><span 
class="ectt-1000">&#x00A0;quux={quirk,</span><span 
class="ectt-1000">&#x00A0;a=fleeg}},</span><span 
class="ectt-1000">&#x00A0;etc</span></p></dd></dl>
<p class="noindent" >We may consider that we need a function that can parse such
<span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> expressions and assign the values to an <span 
class="eccc-1000">AWK </span>associated
array, perhaps using a recursive parser into a multi-dimensional
hash<span class="footnote-mark"><a 
href="#fn1x7" id="fn1x7-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-40001f1"></a>,
resulting in:
</p>
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11">key                   </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td11">value  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11">a[name]              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11">freddie</td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11">a[foo, bar]           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td11">baz    </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11">a[foo, quux, quirk]</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11">      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11">a[foo, quux, a]     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-2"  
class="td11">fleeg   </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-1"  
class="td11">a[etc]                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-2"  
class="td11">      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-1"  
class="td11">               </td>
</tr></table></div>
<p class="noindent" >Oon reflection it seems that sometimes such nesting is not desirable, as the braces
are also used to delimit values that contain commas &#8212; we may consider
that
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">name={williamson,</span><span 
class="ectt-1000">&#x00A0;freddie}</span></p></dd></dl>
<p class="noindent" >should assign <span 
class="ectt-1000">williamson, freddie </span>to <span 
class="ectt-1000">name</span>.
</p><p class="noindent" >In fact we are not so interested in the detail so as to be bothered by this, which turns
out to be a good thing for two reasons. Firstly <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> has a malleable parser with
no strict syntax, and secondly whether or not <span 
class="ectt-1000">williamson </span>and <span 
class="ectt-1000">freddie </span>should count
as two items will be context dependant anyway.
                                                                  

                                                                  
</p><p class="noindent" >We need to parse this latex for only one reason; which is that we are extending
lstlistings to add some additional arguments which will be used to express chunk
parameters and other chunk options.
</p>
<h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-410006.1"></a>Additional lstlstings parameters</h3>
<p class="noindent" >Further on we define a <span 
class="ectt-1000">\Chunk </span><span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> macro whose arguments will consist of a the
chunk name, optionally followed by a comma and then a comma separated list of
arguments. In fact we will just need to prefix <span 
class="ectt-1000">name= </span>to the arguments to in order to
create valid lstlistings arguments.
</p><p class="noindent" >There will be other arguments supported too;
     </p><dl class="description"><dt class="description">
<span 
class="ecbx-1000">params</span> </dt><dd 
class="description">As  an  extension  to  many  literate-programming  styles,  fangle
     permits code chunks to take parameters and thus operate somewhat like
     C pre-processor macros, or like C++ templates. Chunk parameters are
     declared with a chunk argument called <span 
class="ectt-1000">params</span>, which holds a semi-colon
     separated list of parameters, like this:</dd></dl>
<p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">achunk,language=C,params=name;address</span></p></dd></dl>
     <dl class="description"><dt class="description">
<span 
class="ecbx-1000">addto</span> </dt><dd 
class="description">a named chunk that this chunk is to be included into. This saves the
     effort of having to declare another listing of the named chunk merely to
     include this one.</dd></dl>
<p class="noindent" >Function <span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">get_chunk_args()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="cmsy-10">&#x27E9;</span>will accept two paramters, <span 
class="ectt-1000">text </span>being the text to
parse, and <span 
class="ectt-1000">values </span>being an array to receive the parsed values as described
above. The optional parameter <span 
class="ectt-1000">path </span>is used during recursion to build up the
multi-dimensional array path.
</p>

<a 
 id="noweb../fangle-4"></a><a 
 id="x1-41001"></a><a 
href="#noweb../fangle-4"><span 
class="ecrm-0800">35</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle</span><span 
class="ecrm-0800">()[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle-1"><span 
class="ecrm-0800">32a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>           <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle-3"><span 
class="ecrm-0800">32c</span></a><div class="lstlisting" id="listing-40"><span class="label"><a 
 id="x1-41002r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">get_chunk_args()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>

                                                                  

                                                                  
<a 
 id="noweb.get_chunk_args()-1"></a><a 
 id="x1-41003"></a><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">get_chunk_args()</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-2"><span 
class="ecrm-0800">36b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-41"><span class="label"><a 
 id="x1-41004r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">get_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41005r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">optional</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">parameters</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41006r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">path</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">hierarchical</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">precursors</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41007r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41008r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >The strategy is to parse the name, and then look for a value. If the value begins with
a brace <span 
class="ectt-1000">{</span>, then we recurse and consume as much of the text as necessary, returning
the remaining text when we encounter a leading close-brace <span 
class="ectt-1000">}</span>. This being the
strategy &#8212; and executed in a loop &#8212; we realise that we must first look for the
closing brace (perhaps preceded by white space) in order to terminate the recursion,
and returning remaining text.
</p>

<a 
 id="noweb.get_chunk_args()-2"></a><a 
 id="x1-41009"></a><a 
href="#noweb.get_chunk_args()-2"><span 
class="ecrm-0800">36b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">get_chunk_args()</span><span 
class="ecrm-0800">()[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><div class="lstlisting" id="listing-42"><span class="label"><a 
 id="x1-41010r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41011r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next_chunk_args</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41012r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">while</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41013r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*}(.*)</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41014r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41015r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41016r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse-chunk-args-1"><span 
class="ecrm-0800">36c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41017r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41018r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41019r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We can see that the text could be inspected with this regex:
</p>

<a 
 id="noweb.parse-chunk-args-1"></a><a 
 id="x1-41020"></a><a 
href="#noweb.parse-chunk-args-1"><span 
class="ecrm-0800">36c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">parse&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse-chunk-args-1"><span 
class="ecrm-0800">36c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse-chunk-args-2"><span 
class="ecrm-0800">36d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-43"><span class="label"><a 
 id="x1-41021r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*([^,=]*[^,=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*(([,=])</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*(([^,}]*)</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*,*</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*(.*))|)</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41022r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41023r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >and that <span 
class="ectt-1000">a </span>will have the following values:
</p>
<div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-1"  
class="td11">a[n]</td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-2"  
class="td11">assigned text                                                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-1"  
class="td11"> 1  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-2"  
class="td11">freddie                                                              </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-1"  
class="td11"> 2  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-2"  
class="td11">=freddie, foo={bar=baz, quux={quirk, a=fleeg}}, etc</td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-4-1"  
class="td11"> 3  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-2"  
class="td11">=                                                                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-5-1"  
class="td11"> 4  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-2"  
class="td11">freddie, foo={bar=baz, quux={quirk, a=fleeg}}, etc  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-6-1"  
class="td11"> 5  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-2"  
class="td11">freddie                                                              </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-7-1"  
class="td11"> 6  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-2"  
class="td11">, foo={bar=baz, quux={quirk, a=fleeg}}, etc           </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-8-1"  
class="td11">    </td>
</tr></table></div>
<p class="noindent" >a[3] will be either <span 
class="ectt-1000">= </span>or <span 
class="ectt-1000">, </span>and signify whether the option named in <span 
class="ectt-1000">a[1] </span>has a value or
not (respectively).
</p><p class="noindent" >If the option does have a value, then if the expression <span 
class="ectt-1000">substr(a[4],1,1) </span>returns a
brace <span 
class="ectt-1000">{ </span>it will signify that we need to recurse:
</p>

<a 
 id="noweb.parse-chunk-args-2"></a><a 
 id="x1-41024"></a><a 
href="#noweb.parse-chunk-args-2"><span 
class="ecrm-0800">36d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">parse&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">()[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse-chunk-args-1"><span 
class="ecrm-0800">36c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.parse-chunk-args-1"><span 
class="ecrm-0800">36c</span></a><div class="lstlisting" id="listing-44"><span class="label"><a 
 id="x1-41025r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41026r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[3]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41027r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[4],1,1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41028r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">get_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[4],2),</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">path</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41029r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41030r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">path</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[5];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41031r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[6];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41032r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41033r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41034r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">path</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41035r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41036r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">}</span>
                                                                  

                                                                  
</div>
<p class="noindent" >We can test this function like this:
</p>

<a 
 id="noweb.gca-test.awk-1"></a><a 
 id="x1-41037"></a><a 
href="#noweb.gca-test.awk-1"><span 
class="ecrm-0800">37a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">gca&#8211;test.awk</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gca-test.awk-1"><span 
class="ecrm-0800">37a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-45"><span class="label"><a 
 id="x1-41038r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">get_chunk_args()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.get_chunk_args()-1"><span 
class="ecrm-0800">36a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41039r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">BEGIN</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41040r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41041r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41042r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">get_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">freddie</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">={</span><span 
class="ectt-0800">bar</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">baz</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">quux</span><span 
class="ectt-0800">={</span><span 
class="ectt-0800">quirk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">fleeg</span><span 
class="ectt-0800">}},</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">etc</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41043r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41044r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41045r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41046r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >which should give this output:
</p>

<a 
 id="noweb.gca-test.awk-results-1"></a><a 
 id="x1-41047"></a><a 
href="#noweb.gca-test.awk-results-1"><span 
class="ecrm-0800">37b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">gca&#8211;test.awk&#8211;results</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gca-test.awk-results-1"><span 
class="ecrm-0800">37b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-46"><span class="label"><a 
 id="x1-41048r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quux</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quirk</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41049r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quux</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fleeg</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41050r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">bar</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">baz</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41051r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">etc</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-41052r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">freddie</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-420006.2"></a>Parsing chunk arguments</h3>
<p class="noindent" >Arguments to paramterized chunks are expressed in round brackets as a comma
separated list of optional arguments. For example, a chunk that is defined
with:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\Chunk{achunk,</span><span 
class="ectt-1000">&#x00A0;params=name</span><span 
class="ectt-1000">&#x00A0;;</span><span 
class="ectt-1000">&#x00A0;address}</span></p></dd></dl>
<p class="noindent" >could be invoked as:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\chunkref{achunk}(John</span><span 
class="ectt-1000">&#x00A0;Jones,</span><span 
class="ectt-1000">&#x00A0;jones@example.com)</span></p></dd></dl>
<p class="noindent" >An argument list may be as simple as in <span 
class="ectt-1000">\chunkref{pull}(thing, otherthing) </span>or
as complex as:
</p><p class="noindent" >
                                                                  

                                                                  
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">\chunkref{pull}(things[x,</span><span 
class="ectt-1000">&#x00A0;y],</span><span 
class="ectt-1000">&#x00A0;get_other_things(a,</span><span 
class="ectt-1000">&#x00A0;"(all)"))</span><span 
class="ectt-1000">&#x00A0;</span></p></dd></dl>
<p class="noindent" >&#8212; which for all it&#8217;s commas and quotes and parenthesis represents only two
parameters: <span 
class="ectt-1000">things[x, y] </span>and <span 
class="ectt-1000">get_other_things(a, "(all)")</span>.
</p><p class="noindent" >If we simply split parameter list on commas, then the comma in <span 
class="ectt-1000">things[x,y] </span>would
split into two seperate arguments: <span 
class="ectt-1000">things[x </span>and <span 
class="ectt-1000">y]</span>&#8212; neither of which make sense on
their own.
</p><p class="noindent" >One way to prevent this would be by refusing to split text between matching
delimiters, such as <span 
class="ectt-1000">[</span>, <span 
class="ectt-1000">]</span>, <span 
class="ectt-1000">(</span>, <span 
class="ectt-1000">)</span>, <span 
class="ectt-1000">{</span>, <span 
class="ectt-1000">} </span>and most likely also <span 
class="ectt-1000">"</span>, <span 
class="ectt-1000">" </span>and <span 
class="ectt-1000">&#8217;</span>, <span 
class="ectt-1000">&#8217;</span>. Of
course this also makes it impossible to pass such mis-matched code fragments
as parameters, but I think that it would be hard for readers to cope
with authors who would pass such code unbalanced fragments as chunk
parameters<span class="footnote-mark"><a 
href="#fn2x7" id="fn2x7-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-42001f2"></a>.
</p><p class="noindent" >Unfortunately, the full set of matching delimiters may vary from language to
language. In certain C++ template contexts, <span 
class="ectt-1000">&#x003C; </span>and <span 
class="ectt-1000">&#x003E; </span>would count as delimiters, and
yet in other contexts they would not.
</p><p class="noindent" >This puts me in the unfortunate position of having to parse-somewhat all
programming languages without knowing what they are!
</p><p class="noindent" >However, if this universal mode-tracking is possible, then parsing the arguments
would be trivial. Such a mode tracker is described in chapter <a 
href="#x1-440007">7<!--tex4ht:ref: cha:modes --></a> and used here with
simplicity.
</p>

<a 
 id="noweb.parse_chunk_args-1"></a><a 
 id="x1-42002"></a><a 
href="#noweb.parse_chunk_args-1"><span 
class="ecrm-0800">38</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">parse_chunk_args</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-1"><span 
class="ecrm-0800">38</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-47"><span class="label"><a 
 id="x1-42003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rest</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">new&#8211;mode&#8211;tracker</span><span 
class="ecrm-0800">(context,</span>
<span 
class="ecrm-0800">language,mode)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new-mode-tracker-1"><span 
class="ecrm-0800">52a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">extract</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">values</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[0,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[0,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">rest</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-42014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-430006.3"></a>Expanding parameters in the text</h3>
<p class="noindent" >Within the body of the chunk, the parameters are referred to with: <span 
class="ectt-1000">${name} </span>and
<span 
class="ectt-1000">${address}</span>. There is a strong case that a <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> style notation should be used, like
\param{name} which would be expressed in the listing as =&#x003C;\param{name}&#x003E; and be
rendered as <span class="lstinline"><span 
class="ectt-0800">=&#x003C;\</span><span 
class="ectt-0800">param</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">}&#x003E;</span></span>. Such notation would make me go blind, but I do intend to
adopt it<span class="footnote-mark"><a 
href="#fn3x7" id="fn3x7-bk"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-43001f3"></a>.
                                                                  

                                                                  
</p><p class="noindent" >We therefore need a function <span 
class="ectt-1000">expand_chunk_args </span>which will take a block of text, a
list of permitted parameters, and the arguments which must substitute for the
parameters.
</p><p class="noindent" >Here we split the text on <span 
class="ectt-1000">${ </span>which means that all parts except the first will begin
with a parameter name which will be terminated by <span 
class="ectt-1000">}</span>. The split function will
consume the literal <span 
class="ectt-1000">${ </span>in each case.
</p>

<a 
 id="noweb.expand_chunk_args()-1"></a><a 
 id="x1-43002"></a><a 
href="#noweb.expand_chunk_args()-1"><span 
class="ecrm-0800">39a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">expand_chunk_args()</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.expand_chunk_args()-1"><span 
class="ecrm-0800">39a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-48"><span class="label"><a 
 id="x1-43003r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">expand_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">args</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next_text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">v</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43005r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43006r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">substitute&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >First, we produce an associative array of substitution values indexed by parameter
names. This will serve as a cache, allowing us to look up the replacement values as we
extract each name.
</p>

<a 
 id="noweb.substitute-chunk-args-1"></a><a 
 id="x1-43012"></a><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">substitute&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-2"><span 
class="ecrm-0800">39c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-49"><span class="label"><a 
 id="x1-43013r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43014r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">v</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">]]=</span><span 
class="ectt-0800">args</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43015r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We accumulate substituted text in the variable <span 
class="ectt-1000">text</span>. As the first part of the split
function is the part before the delimiter &#8212; which is <span 
class="ectt-1000">${ </span>in our case &#8212; this part will
never contain a parameter reference, so we assign this directly to the result kept in
<span 
class="ectt-1000">$text</span>. </p>
<a 
 id="noweb.substitute-chunk-args-2"></a><a 
 id="x1-43016"></a><a 
href="#noweb.substitute-chunk-args-2"><span 
class="ecrm-0800">39c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">substitute&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">()[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>   <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-3"><span 
class="ecrm-0800">39d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-50"><span class="label"><a 
 id="x1-43017r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">[1];</span>
</div>
<p class="noindent" >We then iterate over the remaining values in the
array<span class="footnote-mark"><a 
href="#fn4x7" id="fn4x7-bk"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-43018f4"></a>,
and substitute each reference for it&#8217;s argument.
</p>

<a 
 id="noweb.substitute-chunk-args-3"></a><a 
 id="x1-43019"></a><a 
href="#noweb.substitute-chunk-args-3"><span 
class="ecrm-0800">39d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">substitute&#8211;chunk&#8211;args</span><span 
class="ecrm-0800">()[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-args-1"><span 
class="ecrm-0800">39b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.substitute-chunk-args-2"><span 
class="ecrm-0800">39c</span></a><div class="lstlisting" id="listing-51"><span class="label"><a 
 id="x1-43020r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">=2;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43021r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">substitute&#8211;chunk&#8211;arg</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-arg-1"><span 
class="ecrm-0800">40</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43022r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >After the split on <span 
class="ectt-1000">${ </span>a valid parameter reference will consist of valid parameter name
terminated by a close-brace <span 
class="ectt-1000">}</span>. A valid character name begins with the underscore or
a letter, and may contain letters, digits or underscores.
                                                                  

                                                                  
</p><p class="noindent" >A valid looking reference that is not actually the name of a parameter will be and not
substituted. This is good because there is nothing to substitute anyway, and it avoids
clashes when writing code for languages where ${&hellip;} is a valid construct &#8212;
such constructs will not be interfered with unless the parameter name also
matches.
</p>

<a 
 id="noweb.substitute-chunk-arg-1"></a><a 
 id="x1-43023"></a><a 
href="#noweb.substitute-chunk-arg-1"><span 
class="ecrm-0800">40</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">substitute&#8211;chunk&#8211;arg</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.substitute-chunk-arg-1"><span 
class="ecrm-0800">40</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-52"><span class="label"><a 
 id="x1-43024r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^([</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">zA</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Z_</span><span 
class="ectt-0800">][</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">zA</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Z0</span><span 
class="ectt-0800">-9</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">]*)}</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43025r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">v</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43026r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43027r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">v</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">[1]]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">l</span><span 
class="ectt-0800">[1])+2);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43028r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43029r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text_array</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43030r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-440007"></a>Language Modes &amp; Quoting</h2>
<h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-450007.1"></a>Modes</h3>
<p class="noindent" >lstlistings and fangle both recognize source languages, and perform some basic
parsing. lstlistings can detect strings and comments within a language definition and
perform suitable rendering, such as italics for comments, and visible-spaces within
strings.
</p><p class="noindent" >Fangle similarly can recognize strings, and comments, etc, within a language, so
that any chunks included with <span 
class="ectt-1000">\chunkref </span>can be suitably escape or quoted.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.1.1   </span> <a 
 id="x1-460007.1.1"></a>Modes to keep code together</h4>
<p class="noindent" >As an example, in the C language there are a few parse modes, affecting the
interpretation of characters.
</p><p class="noindent" >One parse mode is the strings mode. The string mode is commenced by an
un-escaped quotation mark <span 
class="ectt-1000">" </span>and terminated by the same. Within the string mode,
only one additional mode can be commenced, it is the backslash mode <span 
class="ectt-1000">\</span>, which is
always terminated by the folloing character.
</p><p class="noindent" >Other modes are <span 
class="ectt-1000">[ </span>which is terminated by a <span 
class="ectt-1000">] </span>(unless it occurs in a string).
</p><p class="noindent" >Consider this line of C code:
</p><p class="noindent" ><span 
class="cmtt-10">things</span><img 
src="fangle0x.png" alt="[x, y]
&#x25DF;&#x25DD;&#x25DC; &#x25DE;"  /><sub><span 
class="cmtt-8x-x-87">1</span><span 
class="cmmi-7">.</span><span 
class="cmtt-8x-x-87">&#x00A0;</span><span 
class="cmr-7">[</span><span 
class="cmtt-8x-x-87">&#x00A0;mode</span></sub><span 
class="cmmi-10">,</span><span 
class="cmtt-10">&#x00A0;get</span>_<span 
class="cmtt-10">other</span>_<span 
class="cmtt-10">things</span><img 
src="fangle1x.png" alt="   &#x25DC;-&#x25DE;&#x25DF;-&#x25DD;
(a,&#8221;(all)&#8221;)
&#x25DF;   &#x25DD;&#x25DC;   &#x25DE;"  /><sub><span 
class="cmtt-8x-x-87">2</span><span 
class="cmmi-7">.</span><span 
class="cmtt-8x-x-87">&#x00A0;</span><span 
class="cmr-7">(</span><span 
class="cmtt-8x-x-87">&#x00A0;mode</span></sub><sup><span 
class="cmtt-8x-x-87">3</span><span 
class="cmmi-7">.</span><span 
class="cmtt-8x-x-87">&#x00A0;</span><span 
class="cmr-7">&#8221;</span><span 
class="cmtt-8x-x-87">&#x00A0;mode</span></sup>
</p><p class="noindent" >Mode nesting prevents the close parenthesis in quote mode (part 3) from terminating
the parenthesis mode (part 2).
</p><p class="noindent" >Each language has a set of modes, the default mode being the null mode. Each mode
can lead to other modes.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.1.2   </span> <a 
 id="x1-470007.1.2"></a>Modes to included chunks</h4>
<p class="noindent" >For instance, consider this chunk with <span 
class="ectt-1000">language=perl</span>:
</p>

                                                                  

                                                                  
<a 
 id="noweb.example-perl-1"></a><a 
 id="x1-47001"></a><a 
href="#noweb.example-perl-1"><span 
class="ecrm-0800">42a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">example&#8211;perl</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.example-perl-1"><span 
class="ecrm-0800">42a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;             </span><div class="lstlisting" id="listing-53"><span class="label"><a 
 id="x1-47002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">hello</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">world</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >If it were included in a chunk with <span 
class="ectt-1000">language=sh</span>, like this:
</p>

<a 
 id="noweb.example-sh-1"></a><a 
 id="x1-47003"></a><a 
href="#noweb.example-sh-1"><span 
class="ecrm-0800">42b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">example&#8211;sh</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.example-sh-1"><span 
class="ecrm-0800">42b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;             </span><div class="lstlisting" id="listing-54"><span class="label"><a 
 id="x1-47004r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">perl</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">example&#8211;perl</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.example-perl-1"><span 
class="ecrm-0800">42a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">"</span>
</div>
<p class="noindent" >fangle would need to generate output like this if it were to work:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">perl</span><span 
class="ectt-1000">&#x00A0;-e</span><span 
class="ectt-1000">&#x00A0;"print</span><span 
class="ectt-1000">&#x00A0;\"hello</span><span 
class="ectt-1000">&#x00A0;world</span><span 
class="ectt-1000">&#x00A0;$0\\n\";"</span><span 
class="ectt-1000">&#x00A0;</span></p></dd></dl>
<p class="noindent" >See that the double quote <span 
class="ectt-1000">"</span>, and <span 
class="ectt-1000">$ </span>in the regex have been quoted with a back-slash
to protect them from shell interpretation.
</p><p class="noindent" >If that were then included in a chunk with <span 
class="ectt-1000">language=make</span>, like this:
</p>

<a 
 id="noweb.example-makefile-1"></a><a 
 id="x1-47005"></a><a 
href="#noweb.example-makefile-1"><span 
class="ecrm-0800">42c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">example&#8211;makefile</span><span 
class="ecrm-0800">()[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.example-makefile-1"><span 
class="ecrm-0800">42c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-55"><span class="label"><a 
 id="x1-47006r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">target</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">pre</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">req</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-47007r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">example&#8211;sh</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.example-sh-1"><span 
class="ecrm-0800">42b</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We would need the output to look like this &#8212; note the $$:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">target:</span><span 
class="ectt-1000">&#x00A0;pre-req</span>
     </p><p class="noindent" ><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;perl</span><span 
class="ectt-1000">&#x00A0;-pe</span><span 
class="ectt-1000">&#x00A0;"s/\"\$$/&#8217;/;"</span></p></dd></dl>
<p class="noindent" >In order to make this work, we need to define a mode-tracker supporting
each language, that can detect the various quoting modes, and provide a
transformation that must be applied to any included text so that included text will
be interpreted correctly after any interpolation that it may be subject to at
run-time.
                                                                  

                                                                  
</p><p class="noindent" >For example, the sed transformation for text to be inserted into sh double-quoted
strings would be something like:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">s/\\/\\\\/g;s/$/\\$/g;s/"/\\"/g;</span></p></dd></dl>
<p class="noindent" >which protects <span 
class="ectt-1000">\ $ "</span>.
</p><p class="noindent" >The mode tracker must also track nested mode-changes, as in this <span 
class="ectt-1000">sh </span>example.
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;"hello</span><span 
class="ectt-1000">&#x00A0;&#8216;id</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&hellip;&#8216;"</span>
     </p><p class="noindent" >               <span 
class="tctt-1000">&uarr;</span></p></dd></dl>
<p class="noindent" >Any characters inserted at the point marked <span 
class="tcrm-1000">&uarr; </span>would need to be escaped, including <span 
class="ectt-1000">&#8216;</span>
<span 
class="ectt-1000">| * </span>among others. First it would need escaping for the back-ticks &#8216;, and then for the
double-quotes ".
</p><p class="noindent" >Escaping need not occur if the format and mode of the included chunk matches that
of the including chunk.
</p><p class="noindent" >As each chunk is output a new mode tracker for that language is initialized in it&#8217;s
normal state. As text is output for that chunk the output mode is tracked. When a
new chunk is included, a transformation appropriate to that mode is selected and
pushed onto a stack of transformations. Any text to be output is first passed through
this stack of transformations.
</p><p class="noindent" >It remains to consider if the chunk-include function should return it&#8217;s generated text
so that the caller can apply any transformations (and formatting), or if it should
apply the stack of transformations itself.
</p><p class="noindent" >Note that the transformed text should have the property of not being able to change
the mode in the current chunk.
</p><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-480007.2"></a>Language Mode Definitions</h3>
                                                                  

                                                                  
<p class="noindent" >All modes are stored in a single multi-dimensional hash. The first index is the
language, and the second index is the mode-identifier. The third indexes are
terminators, and optionally, submodes, and delimiters.
</p><p class="noindent" >A useful set of mode definitions for a nameless general C-type language is shown
here. (Don&#8217;t be confused by the double backslash escaping needed in awk. One
set of escaping is for the string, and the second set of escaping is for the
regex).
</p><p class="noindent" >Submodes are entered by the characters <span 
class="ectt-1000">\ " &#8217; { ( [ /*</span>
</p>

<a 
 id="noweb.common-mode-definitions-1"></a><a 
 id="x1-48001"></a><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-2"><span 
class="ecrm-0800">44b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-56"><span class="label"><a 
 id="x1-48002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\|\"|&#8217;|{|\\(|\\[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >In the default mode, a comma surrounded by un-important white space is a delimiter
of language items.
</p>

<a 
 id="noweb.common-mode-definitions-2"></a><a 
 id="x1-48003"></a><a 
href="#noweb.common-mode-definitions-2"><span 
class="ecrm-0800">44b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-3"><span 
class="ecrm-0800">45a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-57"><span class="label"><a 
 id="x1-48004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >and should pass this test:
</p>

<a 
 id="noweb.test:mode-definitions-1"></a><a 
 id="x1-48005"></a><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-2"><span 
class="ecrm-0800">46e</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-58"><span class="label"><a 
 id="x1-48006r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">1,2,3</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48007r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48008r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">2</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48009r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[3]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">3</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48010r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48011r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48012r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48013r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">joe</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">red</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48014r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">joe</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48015r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">red</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48016r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48017r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48018r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48019r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">colour</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48020r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">colour</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48021r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-48022r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >Nested modes are identified by a backslash, a double or single quote, various bracket
styles or a /* comment.
</p><p class="noindent" >For each of these sub-modes modes we must also identify at a
mode terminator, and any sub-modes or delimiters that may be
entered<span class="footnote-mark"><a 
href="#fn1x8" id="fn1x8-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-48023f1"></a>.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.1   </span> <a 
 id="x1-490007.2.1"></a>Backslash</h4>
                                                                  

                                                                  
<p class="noindent" >The backslash mode has no submodes or delimiters, and is terminated by any
character. Note that we are not so much interested in evaluating or interpolating
content as we are in delineating content. It is no matter that a double backslash (<span 
class="ectt-1000">\\</span>)
may represent a single backslash while a backslash-newline may represent white
space, but it does matter that the newline in a backslash newline should not be able
to terminate a C pre-processor statement; and so the newline will be consumed by
the backslash however it is to be interpreted.
</p>

<a 
 id="noweb.common-mode-definitions-3"></a><a 
 id="x1-49001"></a><a 
href="#noweb.common-mode-definitions-3"><span 
class="ecrm-0800">45a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.common-mode-definitions-2"><span 
class="ecrm-0800">44b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-4"><span 
class="ecrm-0800">46d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-59"><span class="label"><a 
 id="x1-49002r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.2   </span> <a 
 id="x1-500007.2.2"></a>Strings</h4>
<p class="noindent" >Common languages support two kinds of strings quoting, double quotes and single
quotes.
</p><p class="noindent" >In a string we have one special mode, which is the backslash. This may escape
an embedded quote and prevent us thinking that it should terminate the
string.
</p>

<a 
 id="noweb.mode:common-string-1"></a><a 
 id="x1-50001"></a><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;string</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-2"><span 
class="ecrm-0800">45c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-60"><span class="label"><a 
 id="x1-50002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >Otherwise, the string will be terminated by the same character that commenced
it.
</p>

<a 
 id="noweb.mode:common-string-2"></a><a 
 id="x1-50003"></a><a 
href="#noweb.mode:common-string-2"><span 
class="ecrm-0800">45c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;string</span><span 
class="ecrm-0800">(language;quote)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-3"><span 
class="ecrm-0800">46a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-61"><span class="label"><a 
 id="x1-50004r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">};</span>
</div>
<p class="noindent" >In C type languages, certain escape sequences exist in strings. We need to define
mechanism to enclode any chunks included in this mode using those escape
sequences. These are expressed in two parts, s meaning search, and r meaning
replace.
                                                                  

                                                                  
</p><p class="noindent" >The first substitution is to replace a backslash with a double backslash. We do this
first as other substitutions may introduce a backslash which we would not then want
to escape again here.
</p><p class="noindent" >Note: Backslashes need double-escaping in the search pattern but not in the
replacement string, hence we are replacing a literal \ with a literal \\.
</p>

<a 
 id="noweb.mode:common-string-3"></a><a 
 id="x1-50005"></a><a 
href="#noweb.mode:common-string-3"><span 
class="ecrm-0800">46a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;string</span><span 
class="ecrm-0800">(language;quote)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode:common-string-2"><span 
class="ecrm-0800">45c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-4"><span 
class="ecrm-0800">46b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-62"><span class="label"><a 
 id="x1-50006r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50007r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >If the quote character occurs in the text, it should be preceded by a backslash,
otherwise it would terminate the string unexpectedly.
</p>

<a 
 id="noweb.mode:common-string-4"></a><a 
 id="x1-50008"></a><a 
href="#noweb.mode:common-string-4"><span 
class="ecrm-0800">46b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;string</span><span 
class="ecrm-0800">(language;quote)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode:common-string-3"><span 
class="ecrm-0800">46a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-5"><span 
class="ecrm-0800">46c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-63"><span class="label"><a 
 id="x1-50009r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">};</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50010r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">};</span>
</div>
<p class="noindent" >Any newlines in the string, must be replaced by <span 
class="ectt-1000">\n</span>
</p>

<a 
 id="noweb.mode:common-string-5"></a><a 
 id="x1-50011"></a><a 
href="#noweb.mode:common-string-5"><span 
class="ecrm-0800">46c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;string</span><span 
class="ecrm-0800">(language;quote)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode:common-string-4"><span 
class="ecrm-0800">46b</span></a><div class="lstlisting" id="listing-64"><span class="label"><a 
 id="x1-50012r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50013r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >For the common modes, we define this string handling for double and single
quotes.
</p>

<a 
 id="noweb.common-mode-definitions-4"></a><a 
 id="x1-50014"></a><a 
href="#noweb.common-mode-definitions-4"><span 
class="ecrm-0800">46d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.common-mode-definitions-3"><span 
class="ecrm-0800">45a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-5"><span 
class="ecrm-0800">47b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-65"><span class="label"><a 
 id="x1-50015r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:common&#8211;string</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"\"")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50016r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:common&#8211;string</span><span 
class="ecrm-0800">($language,"&#8217;")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-string-1"><span 
class="ecrm-0800">45b</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >Working strings should pass this test:
</p>

<a 
 id="noweb.test:mode-definitions-2"></a><a 
 id="x1-50017"></a><a 
href="#noweb.test:mode-definitions-2"><span 
class="ecrm-0800">46e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-3"><span 
class="ecrm-0800">51a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-66"><span class="label"><a 
 id="x1-50018r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">say</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\"</span><span 
class="ectt-0800">I</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">said</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\\\"</span><span 
class="ectt-0800">Hello</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">how</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">are</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">you</span><span 
class="ectt-0800">\\\".\",</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">me</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50019r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">say</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\"</span><span 
class="ectt-0800">I</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">said</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\\\"</span><span 
class="ectt-0800">Hello</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">how</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">are</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">you</span><span 
class="ectt-0800">\\\".\"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50020r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">me</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50021r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-50022r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.3   </span> <a 
 id="x1-510007.2.3"></a>Parentheses, Braces and Brackets</h4>
<p class="noindent" >Where quotes are closed by the same character, parentheses, brackets and braces are
closed by an alternate character.
</p>

<a 
 id="noweb.mode:common-brackets-1"></a><a 
 id="x1-51001"></a><a 
href="#noweb.mode:common-brackets-1"><span 
class="ecrm-0800">47a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:common&#8211;brackets</span><span 
class="ecrm-0800">(language;open;close)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-brackets-1"><span 
class="ecrm-0800">47a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-67"><span class="label"><a 
 id="x1-51002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">open</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\|\"|{|\\(|\\[|&#8217;|/\\*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">open</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">open</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">close</span><span 
class="ectt-0800">};</span>
</div>
<p class="noindent" >Note that the open is NOT a regex but the close token IS.
</p>

<a 
 id="noweb.common-mode-definitions-5"></a><a 
 id="x1-51005"></a><a 
href="#noweb.common-mode-definitions-5"><span 
class="ecrm-0800">47b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.common-mode-definitions-4"><span 
class="ecrm-0800">46d</span></a><div class="lstlisting" id="listing-68"><span class="label"><a 
 id="x1-51006r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:common&#8211;brackets</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"","")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-brackets-1"><span 
class="ecrm-0800">47a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51007r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:common&#8211;brackets</span><span 
class="ecrm-0800">($language,"[","\\]")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-brackets-1"><span 
class="ecrm-0800">47a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-51008r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:common&#8211;brackets</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"(","\\)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:common-brackets-1"><span 
class="ecrm-0800">47a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">")</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.4   </span> <a 
 id="x1-520007.2.4"></a>Customizing Standard Modes</h4>

<a 
 id="noweb.mode:add-submode-1"></a><a 
 id="x1-52001"></a><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:add&#8211;submode</span><span 
class="ecrm-0800">(language;mode;submode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-69"><span class="label"><a 
 id="x1-52002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">submode</span><span 
class="ectt-0800">};</span>
</div>

<a 
 id="noweb.mode:add-escapes-1"></a><a 
 id="x1-52003"></a><a 
href="#noweb.mode:add-escapes-1"><span 
class="ecrm-0800">47d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:add&#8211;escapes</span><span 
class="ecrm-0800">(language;mode;search;replace)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-escapes-1"><span 
class="ecrm-0800">47d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-70"><span class="label"><a 
 id="x1-52004r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">search</span><span 
class="ectt-0800">};</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-52005r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">replace</span><span 
class="ectt-0800">};</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.5   </span> <a 
 id="x1-530007.2.5"></a>Comments</h4>
<p class="noindent" >We can define <span 
class="ectt-1000">/* comment */ </span>style comments and <span 
class="ectt-1000">//comment </span>style comments to be
added to any language:
</p>

<a 
 id="noweb.mode:multi-line-comments-1"></a><a 
 id="x1-53001"></a><a 
href="#noweb.mode:multi-line-comments-1"><span 
class="ecrm-0800">48a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:multi&#8211;line&#8211;comments</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:multi-line-comments-1"><span 
class="ecrm-0800">48a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-71"><span class="label"><a 
 id="x1-53002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;submode</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"","/\\*")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\*/</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>

<a 
 id="noweb.mode:single-line-slash-comments-1"></a><a 
 id="x1-53004"></a><a 
href="#noweb.mode:single-line-slash-comments-1"><span 
class="ecrm-0800">48b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:single&#8211;line&#8211;slash&#8211;comments</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:single-line-slash-comments-1"><span 
class="ecrm-0800">48b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-72"><span class="label"><a 
 id="x1-53005r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;submode</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"","//")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53006r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">//</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53007r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;escapes</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"//","\n","\n//")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-escapes-1"><span 
class="ecrm-0800">47d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We can also define <span 
class="ectt-1000"># comment </span>style comments (as used in awk and shell scripts) in a
similar manner.
</p>

<a 
 id="noweb.mode:add-hash-comments-1"></a><a 
 id="x1-53008"></a><a 
href="#noweb.mode:add-hash-comments-1"><span 
class="ecrm-0800">48c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:add&#8211;hash&#8211;comments</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-comments-1"><span 
class="ecrm-0800">48c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-73"><span class="label"><a 
 id="x1-53009r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;submode</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"","#")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53010r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53011r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;escapes</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"#","\n","\n#")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-escapes-1"><span 
class="ecrm-0800">47d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >In C, the <span 
class="ectt-1000"># </span>denotes pre-processor directives which can be multi-line
</p>

<a 
 id="noweb.mode:add-hash-defines-1"></a><a 
 id="x1-53012"></a><a 
href="#noweb.mode:add-hash-defines-1"><span 
class="ecrm-0800">48d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:add&#8211;hash&#8211;defines</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-defines-1"><span 
class="ecrm-0800">48d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-74"><span class="label"><a 
 id="x1-53013r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;submode</span><span 
class="ecrm-0800">($language,"",</span>
<span 
class="ecrm-0800">"#")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53014r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53015r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53016r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;escapes</span><span 
class="ecrm-0800">($language,</span>
<span 
class="ecrm-0800">"#","\n","\\\\\n")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-escapes-1"><span 
class="ecrm-0800">47d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>

<a 
 id="noweb.mode:quote-dollar-escape-1"></a><a 
 id="x1-53017"></a><a 
href="#noweb.mode:quote-dollar-escape-1"><span 
class="ecrm-0800">48e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:quote&#8211;dollar&#8211;escape</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:quote-dollar-escape-1"><span 
class="ecrm-0800">48e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-75"><span class="label"><a 
 id="x1-53018r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53019r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">}],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
                                                                  

                                                                  
</div>
<p class="noindent" >We can add these definitions to various languages
</p>

<a 
 id="noweb.mode-definitions-1"></a><a 
 id="x1-53020"></a><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode&#8211;definitions</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-2"><span 
class="ecrm-0800">50b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-76"><span class="label"><a 
 id="x1-53021r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">("c&#8211;like")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53022r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53023r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">("c")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53024r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:multi&#8211;line&#8211;comments</span><span 
class="ecrm-0800">("c")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:multi-line-comments-1"><span 
class="ecrm-0800">48a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53025r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:single&#8211;line&#8211;slash&#8211;comments</span><span 
class="ecrm-0800">("c")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:single-line-slash-comments-1"><span 
class="ecrm-0800">48b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53026r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;hash&#8211;defines</span><span 
class="ecrm-0800">("c")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-defines-1"><span 
class="ecrm-0800">48d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53027r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53028r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">("awk")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53029r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;hash&#8211;comments</span><span 
class="ecrm-0800">("awk")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-comments-1"><span 
class="ecrm-0800">48c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53030r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;naked&#8211;regex</span><span 
class="ecrm-0800">("awk")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-naked-regex-1"><span 
class="ecrm-0800">50a</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >The awk definitions should allow a comment block like this:
</p>

<a 
 id="noweb.test:comment-quote-1"></a><a 
 id="x1-53031"></a><a 
href="#noweb.test:comment-quote-1"><span 
class="ecrm-0800">49b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:comment&#8211;quote</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:comment-quote-1"><span 
class="ecrm-0800">49b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-77"><span class="label"><a 
 id="x1-53032r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Comment</span><span 
class="ecit-0800">:</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">test:comment&#8211;text</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:comment-text-1"><span 
class="ecrm-0800">49c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>

<a 
 id="noweb.test:comment-text-1"></a><a 
 id="x1-53033"></a><a 
href="#noweb.test:comment-text-1"><span 
class="ecrm-0800">49c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:comment&#8211;text</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:comment-text-1"><span 
class="ecrm-0800">49c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-78"><span class="label"><a 
 id="x1-53034r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">Now</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">time</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53035r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">quick</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">brown</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fox</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">bring</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lemonade</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53036r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">party</span>
</div>
<p class="noindent" >to come out like this:
</p>

<a 
 id="noweb.test:comment-quote:result-1"></a><a 
 id="x1-53037"></a><a 
href="#noweb.test:comment-quote:result-1"><span 
class="ecrm-0800">49d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:comment&#8211;quote:result</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:comment-quote:result-1"><span 
class="ecrm-0800">49d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-79"><span class="label"><a 
 id="x1-53038r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Comment</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Now</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">time</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53039r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">quick</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">brown</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fox</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">bring</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lemonade</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53040r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">party</span>
</div>
<p class="noindent" >The C definition for such a block should have it come out like this:
</p>

<a 
 id="noweb.test:comment-quote:C-result-1"></a><a 
 id="x1-53041"></a><a 
href="#noweb.test:comment-quote:C-result-1"><span 
class="ecrm-0800">49e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:comment&#8211;quote:C&#8211;result</span><span 
class="ecrm-0800">(language;quote)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:comment-quote:C-result-1"><span 
class="ecrm-0800">49e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-80"><span class="label"><a 
 id="x1-53042r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Comment</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Now</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">time</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53043r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">quick</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">brown</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fox</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">bring</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lemonade</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-53044r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">party</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.6   </span> <a 
 id="x1-540007.2.6"></a>Regex</h4>
<p class="noindent" >This pattern is in-complete, but meant to detect naked regular expressions in awk
and perl; e.g. <span 
class="ectt-1000">/.*$/</span>, however required capabilities are not present.
</p><p class="noindent" >Current it only detects regexes anchored with <span 
class="ectt-1000">^ </span>as used in fangle.
</p><p class="noindent" >For full regex support, modes need to be named not after their starting character,
but some other more fully qualified name.
</p>

<a 
 id="noweb.mode:add-naked-regex-1"></a><a 
 id="x1-54001"></a><a 
href="#noweb.mode:add-naked-regex-1"><span 
class="ecrm-0800">50a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode:add&#8211;naked&#8211;regex</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-naked-regex-1"><span 
class="ecrm-0800">50a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-81"><span class="label"><a 
 id="x1-54002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;submode</span><span 
class="ecrm-0800">($language,"",</span>
<span 
class="ecrm-0800">"/\\</span><img 
src="fangle2x.png" alt="&#x02C6;""  class="circ"  /><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-submode-1"><span 
class="ecrm-0800">47c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-54003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"/^",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"]="/";</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.7   </span> <a 
 id="x1-550007.2.7"></a>Perl</h4>

<a 
 id="noweb.mode-definitions-2"></a><a 
 id="x1-55001"></a><a 
href="#noweb.mode-definitions-2"><span 
class="ecrm-0800">50b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-3"><span 
class="ecrm-0800">50c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-82"><span class="label"><a 
 id="x1-55002r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">("perl")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55003r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:multi&#8211;line&#8211;comments</span><span 
class="ecrm-0800">("perl")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:multi-line-comments-1"><span 
class="ecrm-0800">48a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-55004r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;hash&#8211;comments</span><span 
class="ecrm-0800">("perl")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-comments-1"><span 
class="ecrm-0800">48c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >Still need to add add s/, submod /, terminate both with //
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.2.8   </span> <a 
 id="x1-560007.2.8"></a>sh</h4>

<a 
 id="noweb.mode-definitions-3"></a><a 
 id="x1-56001"></a><a 
href="#noweb.mode-definitions-3"><span 
class="ecrm-0800">50c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode-definitions-2"><span 
class="ecrm-0800">50b</span></a><div class="lstlisting" id="listing-83"><span class="label"><a 
 id="x1-56002r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">common&#8211;mode&#8211;definitions</span><span 
class="ecrm-0800">("sh")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.common-mode-definitions-1"><span 
class="ecrm-0800">44a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56003r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">#&#x003C;\</span><span 
class="ectt-0800">chunkref</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">common</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">string</span><span 
class="ectt-0800">}("</span><span 
class="ectt-0800">sh</span><span 
class="ectt-0800">",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"\</span><span 
class="ectt-0800">textbackslash</span><span 
class="ectt-0800">{}"")&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56004r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">#&#x003C;\</span><span 
class="ectt-0800">chunkref</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">common</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">string</span><span 
class="ectt-0800">}("</span><span 
class="ectt-0800">sh</span><span 
class="ectt-0800">",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"&#8217;")&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56005r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:add&#8211;hash&#8211;comments</span><span 
class="ecrm-0800">("sh")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:add-hash-comments-1"><span 
class="ecrm-0800">48c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-56006r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode:quote&#8211;dollar&#8211;escape</span><span 
class="ecrm-0800">("sh",</span>
<span 
class="ecrm-0800">"</span><img 
src="fangle3x.png" alt="""  class="uml"  /><span 
class="ecrm-0800">)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode:quote-dollar-escape-1"><span 
class="ecrm-0800">48e</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-570007.3"></a>Some tests</h3>
<p class="noindent" >Also, the parser must return any spare text at the end that has not been processed
due to a mode terminator being found.
</p>

<a 
 id="noweb.test:mode-definitions-3"></a><a 
 id="x1-57001"></a><a 
href="#noweb.test:mode-definitions-3"><span 
class="ecrm-0800">51a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.test:mode-definitions-2"><span 
class="ecrm-0800">46e</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-4"><span 
class="ecrm-0800">51b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-84"><span class="label"><a 
 id="x1-57002r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">rest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">("</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">spare</span><span 
class="ectt-0800">",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"(");</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57003r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57004r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57005r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[3]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57006r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57007r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">rest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">spare</span><span 
class="ectt-0800">")</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57008r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We must also be able to parse the example given earlier.
</p>

<a 
 id="noweb.test:mode-definitions-4"></a><a 
 id="x1-57009"></a><a 
href="#noweb.test:mode-definitions-4"><span 
class="ecrm-0800">51b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:mode&#8211;definitions</span><span 
class="ecrm-0800">(language)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.test:mode-definitions-3"><span 
class="ecrm-0800">51a</span></a><div class="lstlisting" id="listing-85"><span class="label"><a 
 id="x1-57010r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">("</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">things</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">x</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">y</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">get_other_things</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\"(</span><span 
class="ectt-0800">all</span><span 
class="ectt-0800">)\"),</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">99",</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"(");</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57011r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">things</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">x</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">y</span><span 
class="ectt-0800">]")</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57012r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">get_other_things</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\"(</span><span 
class="ectt-0800">all</span><span 
class="ectt-0800">)\")")</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57013r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[3]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"99")</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57014r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">3)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-57015r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">7.4   </span> <a 
 id="x1-580007.4"></a>A non-recursive mode tracker</h3>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.4.1   </span> <a 
 id="x1-590007.4.1"></a>Constructor</h4>
<p class="noindent" >The mode tracker holds its state in a stack based on a hash. This function, when
passed an empty hash will intialize it.
</p>

<a 
 id="noweb.new_mode_tracker()-1"></a><a 
 id="x1-59001"></a><a 
href="#noweb.new_mode_tracker()-1"><span 
class="ecrm-0800">51c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">new_mode_tracker()</span><span 
class="ecrm-0800">(language)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new_mode_tracker()-1"><span 
class="ecrm-0800">51c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-86"><span class="label"><a 
 id="x1-59002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-59003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[""]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-59004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[0,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-59005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[0,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-59006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >Because awk functions cannot return an array, we must create the array first and
pass it in, so we have a fangle macro to do this:
</p>

                                                                  

                                                                  
<a 
 id="noweb.new-mode-tracker-1"></a><a 
 id="x1-59007"></a><a 
href="#noweb.new-mode-tracker-1"><span 
class="ecrm-0800">52a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">new&#8211;mode&#8211;tracker</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new-mode-tracker-1"><span 
class="ecrm-0800">52a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-87"><span class="label"><a 
 id="x1-59008r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">awk&#8211;delete&#8211;array</span><span 
class="ecrm-0800">($context)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.awk-delete-array-1"><span 
class="ecrm-0800">32d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-59009r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">new_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">},</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">});</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.4.2   </span> <a 
 id="x1-600007.4.2"></a>Management</h4>
<p class="noindent" >And for tracking modes, we dispatch to a mode-tracker action based on the current
language
</p>

<a 
 id="noweb.mode_tracker-1"></a><a 
 id="x1-60001"></a><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-2"><span 
class="ecrm-0800">52c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-88"><span class="label"><a 
 id="x1-60002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">push_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">new&#8211;mode&#8211;tracker</span><span 
class="ecrm-0800">(context,</span>
<span 
class="ecrm-0800">language,mode)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new-mode-tracker-1"><span 
class="ecrm-0800">52a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">top</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.mode_tracker-2"></a><a 
 id="x1-60017"></a><a 
href="#noweb.mode_tracker-2"><span 
class="ecrm-0800">52c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker</span><span 
class="ecrm-0800">(context;language;mode)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-3"><span 
class="ecrm-0800">52d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-89"><span class="label"><a 
 id="x1-60018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">dump_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60021r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60022r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%2</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">:%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60023r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60024r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%2</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60025r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60026r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60027r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.mode_tracker-3"></a><a 
 id="x1-60028"></a><a 
href="#noweb.mode_tracker-3"><span 
class="ecrm-0800">52d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker</span><span 
class="ecrm-0800">(context;language;mode)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker-2"><span 
class="ecrm-0800">52c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-4"><span 
class="ecrm-0800">57b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-90"><span class="label"><a 
 id="x1-60029r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">finalize_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60030r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60031r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60032r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60033r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >This implies that any chunk must be syntactically whole; for instance, this is
fine:
</p>

<a 
 id="noweb.test:whole-chunk-1"></a><a 
 id="x1-60034"></a><a 
href="#noweb.test:whole-chunk-1"><span 
class="ecrm-0800">52e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:whole&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:whole-chunk-1"><span 
class="ecrm-0800">52e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-91"><span class="label"><a 
 id="x1-60035r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60036r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">test:say&#8211;hello</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:say-hello-1"><span 
class="ecrm-0800">52f</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60037r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.test:say-hello-1"></a><a 
 id="x1-60038"></a><a 
href="#noweb.test:say-hello-1"><span 
class="ecrm-0800">52f</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:say&#8211;hello</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:say-hello-1"><span 
class="ecrm-0800">52f</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;        </span><div class="lstlisting" id="listing-92"><span class="label"><a 
 id="x1-60039r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">hello</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
                                                                  

                                                                  
</div>
<p class="noindent" >But this is not fine; the chunk <span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:hidden&#8211;else</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:hidden-else-1"><span 
class="ecrm-0800">53b</span></a><span 
class="cmsy-10">&#x27E9;</span>is not properly cromulent.
</p>

<a 
 id="noweb.test:partial-chunk-1"></a><a 
 id="x1-60040"></a><a 
href="#noweb.test:partial-chunk-1"><span 
class="ecrm-0800">53a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:partial&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:partial-chunk-1"><span 
class="ecrm-0800">53a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-93"><span class="label"><a 
 id="x1-60041r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60042r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">test:hidden&#8211;else</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:hidden-else-1"><span 
class="ecrm-0800">53b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60043r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.test:hidden-else-1"></a><a 
 id="x1-60044"></a><a 
href="#noweb.test:hidden-else-1"><span 
class="ecrm-0800">53b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:hidden&#8211;else</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:hidden-else-1"><span 
class="ecrm-0800">53b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-94"><span class="label"><a 
 id="x1-60045r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">I</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">m</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">fine</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60046r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60047r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">I</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">m</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >These tests will check for correct behaviour:
</p>

<a 
 id="noweb.test:cromulence-1"></a><a 
 id="x1-60048"></a><a 
href="#noweb.test:cromulence-1"><span 
class="ecrm-0800">53c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:cromulence</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:cromulence-1"><span 
class="ecrm-0800">53c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-95"><span class="label"><a 
 id="x1-60049r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Cromulence</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">test</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60050r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">passtest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$FANGLE</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Rtest</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">whole</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$TEX_SRC</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&#x003E;/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">null</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Whole</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">failed</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-60051r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">failtest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$FANGLE</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Rtest</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">partial</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$TEX_SRC</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&#x003E;/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">null</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Partial</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">failed</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">)</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">7.4.3   </span> <a 
 id="x1-610007.4.3"></a>Tracker</h4>
<p class="noindent" >We must avoid recursion as a language construct because we intend to employ
mode-tracking to track language mode of emitted code, and the code is emitted from
a function which is itself recursive, so instead we implement psuedo-recursion using
our own stack based on a hash.
</p>

<a 
 id="noweb.mode_tracker()-1"></a><a 
 id="x1-61001"></a><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-2"><span 
class="ecrm-0800">54a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-96"><span class="label"><a 
 id="x1-61002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">optional</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">parameters</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">result</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_values</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">{</span>
</div>
<p class="noindent" >We could be re-commencing with a valid context, so we need to setup the state
according to the last context.
</p>

                                                                  

                                                                  
<a 
 id="noweb.mode_tracker()-2"></a><a 
 id="x1-61009"></a><a 
href="#noweb.mode_tracker()-2"><span 
class="ecrm-0800">54a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-3"><span 
class="ecrm-0800">54d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-97"><span class="label"><a 
 id="x1-61010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">];</span>
</div>
<p class="noindent" >First we construct a single large regex combining the possible sub-modes for the
current mode along with the terminators for the current mode.
</p>

<a 
 id="noweb.parse_chunk_args-reset-modes-1"></a><a 
 id="x1-61013"></a><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">parse_chunk_args&#8211;reset&#8211;modes</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-2"><span 
class="ecrm-0800">54c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-98"><span class="label"><a 
 id="x1-61014r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61015r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61016r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">((</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61017r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61018r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">)&#x003E;0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61019r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61020r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61021r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">((</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61022r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61023r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">)&#x003E;0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">|</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61024r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61025r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >If we don&#8217;t find anything to match on &#8212; probably because the language is not
supported &#8212; then we return the entire text without matching anything.
</p>

<a 
 id="noweb.parse_chunk_args-reset-modes-2"></a><a 
 id="x1-61026"></a><a 
href="#noweb.parse_chunk_args-reset-modes-2"><span 
class="ecrm-0800">54c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">parse_chunk_args&#8211;reset&#8211;modes</span><span 
class="ecrm-0800">(context;language;mode)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><div class="lstlisting" id="listing-99"><span class="label"><a 
 id="x1-61027r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span>
</div>

<a 
 id="noweb.mode_tracker()-3"></a><a 
 id="x1-61028"></a><a 
href="#noweb.mode_tracker()-3"><span 
class="ecrm-0800">54d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-2"><span 
class="ecrm-0800">54a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-4"><span 
class="ecrm-0800">54e</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-100"><span class="label"><a 
 id="x1-61029r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse_chunk_args&#8211;reset&#8211;modes</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We then iterate the text (until there is none left) looking for sub-modes or
terminators in the regex.
</p>

<a 
 id="noweb.mode_tracker()-4"></a><a 
 id="x1-61030"></a><a 
href="#noweb.mode_tracker()-4"><span 
class="ecrm-0800">54e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-3"><span 
class="ecrm-0800">54d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-5"><span 
class="ecrm-0800">54f</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-101"><span class="label"><a 
 id="x1-61031r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">while</span><span 
class="ectt-0800">((</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61032r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span>
</div>
<p class="noindent" >A bug that creeps in regularly during development is bad regexes of zero length
which result in an infinite loop (as no text is consumed), so I catch that right away
with this test.
</p>

<a 
 id="noweb.mode_tracker()-5"></a><a 
 id="x1-61033"></a><a 
href="#noweb.mode_tracker()-5"><span 
class="ecrm-0800">54f</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-4"><span 
class="ecrm-0800">54e</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-6"><span 
class="ecrm-0800">55a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-102"><span class="label"><a 
 id="x1-61034r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">RLENGTH</span><span 
class="ectt-0800">&#x003C;1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61035r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">sprintf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Internal</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">matched</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">zero</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">submode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">should</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">be</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">impossible</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">likely</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">regex</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">computation</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61036r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Language</span><span 
class="ectt-0800">=%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">nmode</span><span 
class="ectt-0800">=%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">nmatch</span><span 
class="ectt-0800">=%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">submodes</span><span 
class="ectt-0800">));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61037r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
                                                                  

                                                                  
</div>
<p class="noindent" ><span 
class="ectt-1000">part </span>is defined as the text up to the sub-mode or terminator, and this is appended to
<span 
class="ectt-1000">item </span>&#8212; which is the current text being gathered. If a mode has a delimiter, then
item is reset each time a delimiter is found.
</p><p class="noindent" ><img 
src="fangle4x.png" alt="&#x25DC;-----&#x25DE;&#x25DF;----&#x25DD;
  item   item
  &#x25DC;&#x25DE;&#x25DF;&#x25DD; &#x25DC; &#x25DE;&#x25DF;-&#x25DD;
&#8221; hello,there&#8221; "  /><sup><span 
class="cmtt-8x-x-87">item</span></sup><span 
class="cmmi-10">,</span><span 
class="cmtt-10">&#x00A0;</span><img 
src="fangle5x.png" alt="&#x25DC;-&#x25DE;&#x25DF;-&#x25DD;
he said.  "  /><sup><span 
class="cmtt-8x-x-87">item</span></sup>
</p>

<a 
 id="noweb.mode_tracker()-6"></a><a 
 id="x1-61038"></a><a 
href="#noweb.mode_tracker()-6"><span 
class="ecrm-0800">55a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-5"><span 
class="ecrm-0800">54f</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-7"><span 
class="ecrm-0800">55b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-103"><span class="label"><a 
 id="x1-61039r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">RSTART</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-1);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61040r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >We must now determine what was matched. If it was a terminator, then we must
restore the previous mode.
</p>

<a 
 id="noweb.mode_tracker()-7"></a><a 
 id="x1-61041"></a><a 
href="#noweb.mode_tracker()-7"><span 
class="ecrm-0800">55b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[7]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-6"><span 
class="ecrm-0800">55a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-8"><span 
class="ecrm-0800">55c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-104"><span class="label"><a 
 id="x1-61042r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61043r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">printf</span><span 
class="ecit-0800">("%2</span><span 
class="ecit-0800">d</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">EXIT</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">MODE</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">[%</span><span 
class="ecit-0800">s</span><span 
class="ecit-0800">]</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">by</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">[%</span><span 
class="ecit-0800">s</span><span 
class="ecit-0800">]</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">[%</span><span 
class="ecit-0800">s</span><span 
class="ecit-0800">]\</span><span 
class="ecit-0800">n</span><span 
class="ecit-0800">",</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">cindex</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">mode</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">a</span><span 
class="ecit-0800">[1],</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">text</span><span 
class="ecit-0800">)</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x003E;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">"/</span><span 
class="ecit-0800">dev</span><span 
class="ecit-0800">/</span><span 
class="ecit-0800">stderr</span><span 
class="ecit-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61044r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61045r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delete</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61046r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61047r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">&#x003E;=0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61048r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61049r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61050r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse_chunk_args&#8211;reset&#8211;modes</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61051r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61052r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61053r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61054r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >If a delimiter was matched, then we must store the current item in the parsed values
array, and reset the item.
</p>

<a 
 id="noweb.mode_tracker()-8"></a><a 
 id="x1-61055"></a><a 
href="#noweb.mode_tracker()-8"><span 
class="ecrm-0800">55c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[8]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-7"><span 
class="ecrm-0800">55b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-9"><span 
class="ecrm-0800">55d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-105"><span class="label"><a 
 id="x1-61056r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">delimiters</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61057r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">==0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61058r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61059r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61060r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61061r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61062r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61063r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61064r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >otherwise, if a new submode is detected (all submodes have terminators), we
must create a nested parse context until we find the terminator for this
mode.
</p>

<a 
 id="noweb.mode_tracker()-9"></a><a 
 id="x1-61065"></a><a 
href="#noweb.mode_tracker()-9"><span 
class="ecrm-0800">55d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[9]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-8"><span 
class="ecrm-0800">55c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-10"><span 
class="ecrm-0800">56a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-106"><span class="label"><a 
 id="x1-61066r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">((</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">terminators</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">modes</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61067r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">check</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">if</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">new_mode</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">is</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">defined</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61068r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61069r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">printf</span><span 
class="ecit-0800">("%2</span><span 
class="ecit-0800">d</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">ENTER</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">MODE</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">[%</span><span 
class="ecit-0800">s</span><span 
class="ecit-0800">]</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">in</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">[%</span><span 
class="ecit-0800">s</span><span 
class="ecit-0800">]\</span><span 
class="ecit-0800">n</span><span 
class="ecit-0800">",</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">cindex</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">a</span><span 
class="ecit-0800">[1],</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">text</span><span 
class="ecit-0800">)</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x003E;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">"/</span><span 
class="ecit-0800">dev</span><span 
class="ecit-0800">/</span><span 
class="ecit-0800">stderr</span><span 
class="ecit-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61070r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61071r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61072r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61073r49"></a><span 
class="ecrm-0500">49</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61074r50"></a><span 
class="ecrm-0500">50</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61075r51"></a><span 
class="ecrm-0500">51</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse_chunk_args&#8211;reset&#8211;modes</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args-reset-modes-1"><span 
class="ecrm-0800">54b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61076r52"></a><span 
class="ecrm-0500">52</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61077r53"></a><span 
class="ecrm-0500">53</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">sprintf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Submode</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#8217;%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#8217;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">set</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">unknown</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">nLanguage</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">Mode</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61078r54"></a><span 
class="ecrm-0500">54</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[1]));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61079r55"></a><span 
class="ecrm-0500">55</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61080r56"></a><span 
class="ecrm-0500">56</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >In the final case, we parsed to the end of the string. If the string was entire, then we
should have no nested mode context, but if the string was just a fragment we
may have a mode context which must be preserved for the next fragment.
Todo: Consideration ought to be given if sub-mode strings are split over two
fragments.
                                                                  

                                                                  
</p>

<a 
 id="noweb.mode_tracker()-10"></a><a 
 id="x1-61081"></a><a 
href="#noweb.mode_tracker()-10"><span 
class="ecrm-0800">56a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker()</span><span 
class="ecrm-0800">(context;language;mode)[10]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker()-9"><span 
class="ecrm-0800">55d</span></a><div class="lstlisting" id="listing-107"><span class="label"><a 
 id="x1-61082r57"></a><span 
class="ecrm-0500">57</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61083r58"></a><span 
class="ecrm-0500">58</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61084r59"></a><span 
class="ecrm-0500">59</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61085r60"></a><span 
class="ecrm-0500">60</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61086r61"></a><span 
class="ecrm-0500">61</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61087r62"></a><span 
class="ecrm-0500">62</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61088r63"></a><span 
class="ecrm-0500">63</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61089r64"></a><span 
class="ecrm-0500">64</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61090r65"></a><span 
class="ecrm-0500">65</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61091r66"></a><span 
class="ecrm-0500">66</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cindex</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">values</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">item</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61092r67"></a><span 
class="ecrm-0500">67</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-61093r68"></a><span 
class="ecrm-0500">68</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">7.4.3.1   </span> <a 
 id="x1-620007.4.3.1"></a>One happy chunk</h5>
<p class="noindent" >All the mode tracker chunks are referred to here:
</p>

<a 
 id="noweb.mode-tracker-1"></a><a 
 id="x1-62001"></a><a 
href="#noweb.mode-tracker-1"><span 
class="ecrm-0800">56b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode&#8211;tracker</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-tracker-1"><span 
class="ecrm-0800">56b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-108"><span class="label"><a 
 id="x1-62002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">new_mode_tracker()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new_mode_tracker()-1"><span 
class="ecrm-0800">51c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-62003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode_tracker()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker()-1"><span 
class="ecrm-0800">53d</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">7.4.3.2   </span> <a 
 id="x1-630007.4.3.2"></a>Tests</h5>
<p class="noindent" >We can test this function like this:
</p>

<a 
 id="noweb.pca-test.awk-1"></a><a 
 id="x1-63001"></a><a 
href="#noweb.pca-test.awk-1"><span 
class="ecrm-0800">56c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">pca&#8211;test.awk</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk-1"><span 
class="ecrm-0800">56c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-109"><span class="label"><a 
 id="x1-63002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">error()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.error()-1"><span 
class="ecrm-0800">33a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode&#8211;tracker</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-tracker-1"><span 
class="ecrm-0800">56b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">parse_chunk_args()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.parse_chunk_args()-1"><span 
class="ecbx-0800">??</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">BEGIN</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode&#8211;definitions</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">test:mode&#8211;definitions</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:mode-definitions-1"><span 
class="ecrm-0800">44c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.pca-test.awk:summary-1"></a><a 
 id="x1-63011"></a><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">pca&#8211;test.awk:summary</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk:summary-1"><span 
class="ecrm-0800">56d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-110"><span class="label"><a 
 id="x1-63012r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63013r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Failed</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63014r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63015r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63016r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63017r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63018r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Passed</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63019r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63020r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63021r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">=0;</span>
</div>
<p class="noindent" >which should give this output:
</p>

                                                                  

                                                                  
<a 
 id="noweb.pca-test.awk-results-1"></a><a 
 id="x1-63022"></a><a 
href="#noweb.pca-test.awk-results-1"><span 
class="ecrm-0800">57a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">pca&#8211;test.awk&#8211;results</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.pca-test.awk-results-1"><span 
class="ecrm-0800">57a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-111"><span class="label"><a 
 id="x1-63023r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quux</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quirk</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63024r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">quux</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fleeg</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63025r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">foo</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">bar</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">baz</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63026r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">etc</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63027r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">freddie</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">7.5   </span> <a 
 id="x1-640007.5"></a>Escaping and Quoting</h3>
<p class="noindent" >Each nested mode can optionally define a set of transforms to be applied to any text
that is included from another language.
</p><p class="noindent" >This code can perform transforms
</p>

<a 
 id="noweb.mode_tracker-4"></a><a 
 id="x1-64001"></a><a 
href="#noweb.mode_tracker-4"><span 
class="ecrm-0800">57b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker</span><span 
class="ecrm-0800">(context;language;mode)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker-3"><span 
class="ecrm-0800">52d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-5"><span 
class="ecrm-0800">57c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-112"><span class="label"><a 
 id="x1-64002r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">transform_escape</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64003r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">optional</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64004r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64005r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64006r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64007r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64008r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64009r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64010r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64011r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64012r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >This function must append from index <span 
class="ectt-1000">c </span>onwards, and escape transforms from the
supplied context, and return c + number of new transforms.
</p>

<a 
 id="noweb.mode_tracker-5"></a><a 
 id="x1-64013"></a><a 
href="#noweb.mode_tracker-5"><span 
class="ecrm-0800">57c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">mode_tracker</span><span 
class="ecrm-0800">(context;language;mode)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode_tracker-1"><span 
class="ecrm-0800">52b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.mode_tracker-4"><span 
class="ecrm-0800">57b</span></a><div class="lstlisting" id="listing-113"><span class="label"><a 
 id="x1-64014r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode_escaper</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64015r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cpl</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64016r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64017r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">--)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64018r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64019r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cpl</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64020r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cpl</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64021r49"></a><span 
class="ecrm-0500">49</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64022r50"></a><span 
class="ecrm-0500">50</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64023r51"></a><span 
class="ecrm-0500">51</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">language</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">mode</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cp</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64024r52"></a><span 
class="ecrm-0500">52</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64025r53"></a><span 
class="ecrm-0500">53</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64026r54"></a><span 
class="ecrm-0500">54</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64027r55"></a><span 
class="ecrm-0500">55</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64028r56"></a><span 
class="ecrm-0500">56</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64029r57"></a><span 
class="ecrm-0500">57</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">dump_escaper</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64030r58"></a><span 
class="ecrm-0500">58</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64031r59"></a><span 
class="ecrm-0500">59</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">%2</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">[%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">[%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">]\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">cc</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64032r60"></a><span 
class="ecrm-0500">60</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64033r61"></a><span 
class="ecrm-0500">61</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.test:escapes-1"></a><a 
 id="x1-64034"></a><a 
href="#noweb.test:escapes-1"><span 
class="ecrm-0800">57d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:escapes</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:escapes-1"><span 
class="ecrm-0800">57d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-114"><span class="label"><a 
 id="x1-64035r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">escapes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">test</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64036r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">passtest</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$FANGLE</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Rtest</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">comment</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$TEX_SRC</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&#x003E;/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">null</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">echo</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Comment</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">quote</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">failed</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">)</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;8</span><br /><a 
 id="x1-650008"></a>Recognizing Chunks</h2>
<p class="noindent" >Fangle recognizes noweb chunks, but as we also want better <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> integration
we will recognize any of these: </p>
     <ul class="itemize1">
     <li class="itemize">notangle chunks matching the pattern <span 
class="ectt-1000">^&#x003C;&#x003C;.*?&#x003E;&#x003E;=</span>
     </li>
     <li class="itemize">a chunks beginning with <span 
class="ectt-1000">\begin{lstlistings}</span>, possibly with \Chunk{&hellip;}
     on the previous line
     </li>
     <li class="itemize">an older form I have used, beginning with <span 
class="ectt-1000">\begin{Chunk}[options] </span>&#8212;
     also more suitable for plain <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> users<span class="footnote-mark"><a 
href="#fn1x9" id="fn1x9-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-65001f1"></a>.</li></ul>
<h3 class="sectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-660008.1"></a>Chunk start</h3>
<p class="noindent" >The variable <span 
class="ectt-1000">chunking </span>is used to signify that we are processing a code chunk and not
document. In such a state, input lines will be assigned to the current chunk;
otherwise they are ignored.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.1.1   </span> <a 
 id="x1-670008.1.1"></a>lstlistings</h4>
<p class="noindent" >Our current scheme is to recognize the new lstlisting chunks, but these may be
preceded by a <span 
class="ectt-1000">\Chunk </span>command which in LY X is a more convenient way to pass the
chunk name to the <span 
class="ectt-1000">\begin{lstlistings} </span>command, and a more visible way to
specify other <span 
class="ectt-1000">lstset </span>settings.
</p><p class="noindent" >The arguments to the <span 
class="ectt-1000">\Chunk </span>command are a name, and then a comma-seperated list
of key-value pairs after the manner of <span 
class="ectt-1000">\lstset</span>. (In fact within the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> <span 
class="ectt-1000">\Chunk</span>
macro (section <a 
href="#x1-8500013.2.1">13.2.1<!--tex4ht:ref: sub:The-chunk-command --></a>) the text <span 
class="ectt-1000">name= </span>is prefixed to the argument which is then
literally passed to <span 
class="ectt-1000">\lstset</span>).
</p>

<a 
 id="noweb.recognize-chunk-1"></a><a 
 id="x1-67001"></a><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-2"><span 
class="ecrm-0800">59a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-115"><span class="label"><a 
 id="x1-67002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">/^\\</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">{/</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^\\\\</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*([^</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">,}]*),?(.*)}</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next_chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">get_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[2],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next_chunk_args</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span>
</div>
                                                                  

                                                                  
<p class="noindent" >We also make a basic attempt to parse the name out of the <span 
class="ectt-1000">\lstlistings[name=</span>
<span 
class="ectt-1000">chunk-name] </span>text, otherwise we fall back to the name found in the previous chunk command.
This attempt is very basic and doesn&#8217;t support commas or spaces or square brackets as
part of the chunkname. We also recognize <span 
class="ectt-1000">\begin{Chunk} </span>which is convenient for some
users<span class="footnote-mark"><a 
href="#fn2x9" id="fn2x9-bk"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-67009f2"></a>.
</p>

<a 
 id="noweb.recognize-chunk-2"></a><a 
 id="x1-67010"></a><a 
href="#noweb.recognize-chunk-2"><span 
class="ecrm-0800">59a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-3"><span 
class="ecrm-0800">59b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-116"><span class="label"><a 
 id="x1-67011r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">/^\\</span><span 
class="ectt-0800">begin</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">lstlisting</span><span 
class="ectt-0800">}|^\\</span><span 
class="ectt-0800">begin</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">}/</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67012r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">}.*[[,]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">name</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*{?</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*([^],</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">}]*)</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67013r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1]);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67014r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67015r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">next_chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next_chunk_args</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67016r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67017r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunking</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67018r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-67019r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.1.2   </span> <a 
 id="x1-680008.1.2"></a>Noweb</h4>
<p class="noindent" >We recognize notangle style chunks too:
</p>

<a 
 id="noweb.recognize-chunk-3"></a><a 
 id="x1-68001"></a><a 
href="#noweb.recognize-chunk-3"><span 
class="ecrm-0800">59b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-2"><span 
class="ecrm-0800">59a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-4"><span 
class="ecrm-0800">60a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-117"><span class="label"><a 
 id="x1-68002r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">/^[&#x003C;]&#x003C;.*[&#x003E;]&#x003E;=/</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68003r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^[&#x003C;]&#x003C;(.*)[&#x003E;]&#x003E;=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68004r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunking</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68005r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">notangle_mode</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68006r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1]);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68007r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68008r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-68009r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-690008.2"></a>Chunk end</h3>
<p class="noindent" >Likewise, we need to recognize when a chunk ends.
</p><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.2.1   </span> <a 
 id="x1-700008.2.1"></a>lstlistings</h4>
<p class="noindent" >The <span 
class="ectt-1000">e </span>in <span 
class="ectt-1000">[e]end{lislisting} </span>is surrounded by square brackets so that
when this document is processed, this chunk doesn&#8217;t terminate early when
the lstlistings package recognizes it&#8217;s own end-string! <span id="textcolor2"></span> This doesn&#8217;t make
sense as the regex is anchored with ^, which this line does not begin with! 
                                                                  

                                                                  
</p>

<a 
 id="noweb.recognize-chunk-4"></a><a 
 id="x1-70001"></a><a 
href="#noweb.recognize-chunk-4"><span 
class="ecrm-0800">60a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-3"><span 
class="ecrm-0800">59b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-5"><span 
class="ecrm-0800">60b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-118"><span class="label"><a 
 id="x1-70002r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">/^\\[</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">nd</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">lstlisting</span><span 
class="ectt-0800">}|^\\[</span><span 
class="ectt-0800">e</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">nd</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">}/</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-70003r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunking</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-70004r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-70005r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-70006r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.2.2   </span> <a 
 id="x1-710008.2.2"></a>noweb</h4>

<a 
 id="noweb.recognize-chunk-5"></a><a 
 id="x1-71001"></a><a 
href="#noweb.recognize-chunk-5"><span 
class="ecrm-0800">60b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-4"><span 
class="ecrm-0800">60a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-6"><span 
class="ecrm-0800">60c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-119"><span class="label"><a 
 id="x1-71002r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">/^</span><span 
class="ectt-0800">@</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-71003r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunking</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-71004r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-71005r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >All other recognizers are only of effect if we are chunking; there&#8217;s no point in looking
at lines if they aren&#8217;t part of a chunk, so we just ignore them as efficiently as we
can.
</p>

<a 
 id="noweb.recognize-chunk-6"></a><a 
 id="x1-71006"></a><a 
href="#noweb.recognize-chunk-6"><span 
class="ecrm-0800">60c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-5"><span 
class="ecrm-0800">60b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-7"><span 
class="ecrm-0800">61a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-120"><span class="label"><a 
 id="x1-71007r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunking</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">next</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-720008.3"></a>Chunk contents</h3>
<p class="noindent" >Chunk contents are any lines read while <span 
class="ectt-1000">chunking </span>is true. Some chunk contents are
special in that they refer to other chunks, and will be replaced by the contents of
these chunks when the file is generated.
</p><p class="noindent" >We add the output record separator <span 
class="ectt-1000">ORS </span>to the line now, because
we will set <span 
class="ectt-1000">ORS </span>to the empty string when we generate the
output<span class="footnote-mark"><a 
href="#fn3x9" id="fn3x9-bk"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-72001f3"></a>.
</p>

                                                                  

                                                                  
<a 
 id="noweb.recognize-chunk-7"></a><a 
 id="x1-72002"></a><a 
href="#noweb.recognize-chunk-7"><span 
class="ecrm-0800">61a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">recognize&#8211;chunk</span><span 
class="ecrm-0800">(context;language;mode)[7]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.recognize-chunk-1"><span 
class="ecrm-0800">58</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.recognize-chunk-6"><span 
class="ecrm-0800">60c</span></a><div class="lstlisting" id="listing-121"><span class="label"><a 
 id="x1-72003r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-72004r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">process&#8211;chunk&#8211;tabs</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-tabs-1"><span 
class="ecrm-0800">61c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-72005r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">process&#8211;chunk</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-72006r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >If a chunk just consisted of plain text, we could handle the chunk like this:
</p>

<a 
 id="noweb.process-chunk-simple-1"></a><a 
 id="x1-72007"></a><a 
href="#noweb.process-chunk-simple-1"><span 
class="ecrm-0800">61b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk&#8211;simple</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-simple-1"><span 
class="ecrm-0800">61b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-122"><span class="label"><a 
 id="x1-72008r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ORS</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >but in fact a chunk can include references to other chunks. Chunk includes are
traditionally written as <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;chunk-name&#x003E;&#xFEFF;&#x003E;</span>, but we support other variations.
</p><p class="noindent" >However, we also process tabs at this point, a tab at input can be replaced by a
number of spaces defined by the <span 
class="ectt-1000">tabs </span>variable, set by the <span 
class="ectt-1000">-T </span>option. Of course this is
poor tab behaviour, we should probably have the option to use proper counted
tab-stops and process this on output.
</p>

<a 
 id="noweb.process-chunk-tabs-1"></a><a 
 id="x1-72009"></a><a 
href="#noweb.process-chunk-tabs-1"><span 
class="ecrm-0800">61c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk&#8211;tabs</span><span 
class="ecrm-0800">(context;language;mode)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-tabs-1"><span 
class="ecrm-0800">61c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-123"><span class="label"><a 
 id="x1-72010r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">tabs</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-72011r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tabs</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-72012r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">8.3.1   </span> <a 
 id="x1-730008.3.1"></a>lstlistings</h4>
<p class="noindent" >If <span 
class="ectt-1000">\lstset{escapeinside={=&#x003C;}{&#x003E;}} </span>is set, then we can use <span 
class="ectt-1000">=&#x003C;\chunkref{</span>
<span 
class="ectt-1000">chunk-name}&#x003E; </span>in listings. The sequence <span 
class="ectt-1000">=&#x003C; </span>was chosen because:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-73002x1">it is a better mnemonic than <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;chunk-name&#x003E;&#xFEFF;&#x003E; </span>in that the = sign signifies
     equivalent or substitutability,
     </li>
     <li 
  class="enumerate" id="x1-73004x2">and because =&#x003C; is not valid in C or in any language I can think of
     </li>
     <li 
  class="enumerate" id="x1-73006x3">and also because lstlistings doesn&#8217;t like <span 
class="ectt-1000">&#x003E;&#xFEFF;&#x003E; </span>as an end delimiter for the <span 
class="ecti-1000">texcl</span>
     escape, so we must make do with a single <span 
class="ectt-1000">&#x003E;</span>, which is better matched by
     <span 
class="ectt-1000">=&#x003C; </span>than <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;</span>.</li></ol>
                                                                  

                                                                  
<p class="noindent" >Unfortunately the <span 
class="ectt-1000">=&#x003C;</span><span 
class="ectt-1000">&hellip;&#x003E; </span>that we use re-enters a <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> parsing mode in
which some characters are special, e.g. <span 
class="ectt-1000"># \</span>, and so these cause trouble if
used in arguments to <span 
class="ectt-1000">\chunkref</span>. At some point I must fix the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span>
command <span 
class="ectt-1000">\chunkref </span>so that it can accept these literally, but until then, when
writing chunkref argumemts that need these characters, I must use the forms
<span 
class="ectt-1000">\textbackslash{} </span>and <span 
class="ectt-1000">\#</span>; so I also define a hacky chunk <span 
class="ectt-1000">delatex </span>whose purpose it
is to remove these from any arguments parsed by fangle, and used further
on.
</p>

<a 
 id="noweb.delatex-1"></a><a 
 id="x1-73007"></a><a 
href="#noweb.delatex-1"><span 
class="ecrm-0800">62a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">delatex</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.delatex-1"><span 
class="ecrm-0800">62a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-124"><span class="label"><a 
 id="x1-73008r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">FILTHY</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">HACK</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73009r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\#</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">});</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73010r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\</span><span 
class="ectt-0800">textbackslash</span><span 
class="ectt-0800">{}</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">});</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73011r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\\\\\^</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">});</span>
</div>
<p class="noindent" >As each chunk line may contain more than one chunk include, we will split out chunk includes in an
iterative fashion<span class="footnote-mark"><a 
href="#fn4x9" id="fn4x9-bk"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-73012f4"></a>.
</p><p class="noindent" >First, as long as the chunk contains a <span 
class="ectt-1000">\chunkref </span>command we take as much as we
can up to the first <span 
class="ectt-1000">\chunkref </span>command.
</p>

<a 
 id="noweb.process-chunk-1"></a><a 
 id="x1-73013"></a><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-2"><span 
class="ecrm-0800">62c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-125"><span class="label"><a 
 id="x1-73014r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">$0</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73015r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73016r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">while</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73017r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">([=]&#x003C;\\\\</span><span 
class="ectt-0800">chunkref</span><span 
class="ectt-0800">{([^}&#x003E;]*)}(\\(.*\\)|)&#x003E;|&#x003C;&#x003C;([</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">zA</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Z_</span><span 
class="ectt-0800">][-</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">zA</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">Z0</span><span 
class="ectt-0800">-9</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">]*)&#x003E;&#x003E;)</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73018r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">)\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73019r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73020r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">RSTART</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1);</span>
</div>
<p class="noindent" >We keep track of the indent count, by counting the number of literal characters
found. We can then preserve this indent on each output line when multi-line chunks
are expanded.
</p><p class="noindent" >We then process this first part literal text, and set the chunk which is still to be
processed to be the text after the <span 
class="ectt-1000">\chunkref </span>command, which we will process next as
we continue around the loop.
</p>

<a 
 id="noweb.process-chunk-2"></a><a 
 id="x1-73021"></a><a 
href="#noweb.process-chunk-2"><span 
class="ecrm-0800">62c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-3"><span 
class="ecrm-0800">63a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-126"><span class="label"><a 
 id="x1-73022r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73023r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73024r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">RSTART</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">RLENGTH</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >We then consider the type of chunk command we have found, whether it is the
fangle style command beginning with <span 
class="ectt-1000">=&#x003C; </span>or the older notangle style beginning
with <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;</span>.
</p><p class="noindent" >Fangle chunks may have parameters contained within square brackets. These will
be matched in <span 
class="ectt-1000">line[3] </span>and are considered at this stage of processing to be part of
the name of the chunk to be included.
                                                                  

                                                                  
</p>

<a 
 id="noweb.process-chunk-3"></a><a 
 id="x1-73025"></a><a 
href="#noweb.process-chunk-3"><span 
class="ecrm-0800">63a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk</span><span 
class="ecrm-0800">(text)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.process-chunk-2"><span 
class="ecrm-0800">62c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-4"><span 
class="ecrm-0800">63b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-127"><span class="label"><a 
 id="x1-73026r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73027r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">chunk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">name</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">up</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">to</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73028r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">delatex</span><span 
class="ecrm-0800">(line[3])</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.delatex-1"><span 
class="ecrm-0800">62a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73029r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_include</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[2]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[3],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73030r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73031r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_include</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[4],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73032r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73033r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Unknown</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">fragment</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">[1]);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73034r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >The loop will continue until there are no more chunkref statements in the text, at
which point we process the final part of the chunk.
</p>

<a 
 id="noweb.process-chunk-4"></a><a 
 id="x1-73035"></a><a 
href="#noweb.process-chunk-4"><span 
class="ecrm-0800">63b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk</span><span 
class="ecrm-0800">(text)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.process-chunk-3"><span 
class="ecrm-0800">63a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-5"><span 
class="ecrm-0800">63c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-128"><span class="label"><a 
 id="x1-73036r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-73037r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >We add the newline character as a chunklet on it&#8217;s own, to make it easier to detect
new lines and thus manage indentation when processing the output.
</p>

<a 
 id="noweb.process-chunk-5"></a><a 
 id="x1-73038"></a><a 
href="#noweb.process-chunk-5"><span 
class="ecrm-0800">63c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">process&#8211;chunk</span><span 
class="ecrm-0800">(text)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.process-chunk-1"><span 
class="ecrm-0800">62b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>   <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.process-chunk-4"><span 
class="ecrm-0800">63b</span></a><div class="lstlisting" id="listing-129"><span class="label"><a 
 id="x1-73039r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >We will also permit a chunk-part number to follow in square brackets, so that
<span 
class="ectt-1000">=&#x003C;\chunkref{chunk-name[1]}&#x003E; </span>will refer to the first part only. This can make it
easy to include a C function prototype in a header file, if the first part of the
chunk is just the function prototype without the trailing semi-colon. The
header file would include the prototype with the trailing semi-colon, like
this:
</p><p class="noindent" >
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">=&#x003C;\chunkref{chunk-name[1]}&#x003E;;</span></p></dd></dl>
<p class="noindent" >This is handled in section <a 
href="#x1-7700010.1.1">10.1.1<!--tex4ht:ref: sub:Chunk-parts --></a>
</p><p class="noindent" >We should perhaps introduce a notion of language specific chunk options; so that
perhaps we could specify:
</p><p class="noindent" >
                                                                  

                                                                  
     </p><dl class="list1"><dt class="list">
     </dt><dd 
class="list">
     <p class="noindent" ><span 
class="ectt-1000">=&#x003C;\chunkref{chunk-name[function-declaration]}&#x003E;;</span></p></dd></dl>
<p class="noindent" >which applies a transform <span 
class="ectt-1000">function-declaration </span>to the chunk &#8212; which in this case
would extract a function prototype from a function.
                                                                  

                                                                  
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;9</span><br /><a 
 id="x1-740009"></a>Processing Options</h2>
<p class="noindent" >At the start, first we set the default options.
</p>

<a 
 id="noweb.default-options-1"></a><a 
 id="x1-74001"></a><a 
href="#noweb.default-options-1"><span 
class="ecrm-0800">65a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">default&#8211;options</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.default-options-1"><span 
class="ecrm-0800">65a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-130"><span class="label"><a 
 id="x1-74002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">debug</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">linenos</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">notangle_mode</span><span 
class="ectt-0800">=0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">tabs</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >Then we use getopt the standard way, and null out ARGV afterwards in the normal
AWK fashion.
</p>

<a 
 id="noweb.read-options-1"></a><a 
 id="x1-74007"></a><a 
href="#noweb.read-options-1"><span 
class="ecrm-0800">65b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">read&#8211;options</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.read-options-1"><span 
class="ecrm-0800">65b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-131"><span class="label"><a 
 id="x1-74008r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">skip</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">ARGV</span><span 
class="ecit-0800">[0]</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74009r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">while</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">getopt</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">ARGC</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ARGV</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">LdT</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">hr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)!=-1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74010r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">handle&#8211;options</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.handle-options-1"><span 
class="ecrm-0800">65c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74011r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74012r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ARGV</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">]=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >This is how we handle our options:
</p>

<a 
 id="noweb.handle-options-1"></a><a 
 id="x1-74013"></a><a 
href="#noweb.handle-options-1"><span 
class="ecrm-0800">65c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">handle&#8211;options</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.handle-options-1"><span 
class="ecrm-0800">65c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-132"><span class="label"><a 
 id="x1-74014r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74015r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74016r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">L</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">linenos</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74017r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">debug</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74018r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">T</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tabs</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent_string</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">+0);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74019r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">h</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">help</span><span 
class="ectt-0800">();</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74020r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">?</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">help</span><span 
class="ectt-0800">();</span>
</div>
<p class="noindent" >We do all of this at the beginning of the program
</p>

<a 
 id="noweb.begin-1"></a><a 
 id="x1-74021"></a><a 
href="#noweb.begin-1"><span 
class="ecrm-0800">65d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">begin</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.begin-1"><span 
class="ecrm-0800">65d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-133"><span class="label"><a 
 id="x1-74022r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">BEGIN</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74023r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">constants</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.constants-1"><span 
class="ecrm-0800">71a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74024r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">mode&#8211;definitions</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.mode-definitions-1"><span 
class="ecrm-0800">49a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74025r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">default&#8211;options</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.default-options-1"><span 
class="ecrm-0800">65a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74026r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74027r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">read&#8211;options</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.read-options-1"><span 
class="ecrm-0800">65b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74028r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >And have a simple help function
</p>

<a 
 id="noweb.help()-1"></a><a 
 id="x1-74029"></a><a 
href="#noweb.help()-1"><span 
class="ecrm-0800">65e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">help()</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.help()-1"><span 
class="ecrm-0800">65e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-134"><span class="label"><a 
 id="x1-74030r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">help</span><span 
class="ectt-0800">()</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74031r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Usage</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74032r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">[-</span><span 
class="ectt-0800">L</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">rootname</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">source</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">...]</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74033r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">source</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">...]</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74034r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">If</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">filename</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">source</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">tex</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">specified</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">then</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">stdin</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">used</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74035r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74036r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">L</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">causes</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">C</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">statement</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">lineno</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\"</span><span 
class="ectt-0800">filename</span><span 
class="ectt-0800">\"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">be</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">issued</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74037r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">R</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">causes</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">named</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">be</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">written</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">stdout</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74038r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lists</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">all</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">roots</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">file</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">even</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">those</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">used</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">elsewhere</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74039r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">exit</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-74040r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">}</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;10</span><br /><a 
 id="x1-7500010"></a>Generating the output</h2>
<p class="noindent" >We generate output by calling output_chunk, or listing the chunk names.
</p>

<a 
 id="noweb.generate-output-1"></a><a 
 id="x1-75001"></a><a 
href="#noweb.generate-output-1"><span 
class="ecrm-0800">66a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">generate&#8211;output</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.generate-output-1"><span 
class="ecrm-0800">66a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-135"><span class="label"><a 
 id="x1-75002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk_names</span><span 
class="ectt-0800">();</span>
</div>
<p class="noindent" >We also have some other output debugging:
</p>

<a 
 id="noweb.debug-output-1"></a><a 
 id="x1-75004"></a><a 
href="#noweb.debug-output-1"><span 
class="ecrm-0800">66b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">debug&#8211;output</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.debug-output-1"><span 
class="ecrm-0800">66b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-136"><span class="label"><a 
 id="x1-75005r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">debug</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75006r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">------</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">names</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75007r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk_names</span><span 
class="ectt-0800">();</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75008r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">======</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75009r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunks</span><span 
class="ectt-0800">();</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75010r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">++++++</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">debug</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75011r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75012r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75013r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75014r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We do both of these at the end. We also set <span 
class="ectt-1000">ORS="" </span>because each chunklet is not
necessarily a complete line, and we already added <span 
class="ectt-1000">ORS </span>to each input line in section
<a 
href="#x1-720008.3">8.3<!--tex4ht:ref: sub:ORS-chunk-text --></a>.
</p>

<a 
 id="noweb.end-1"></a><a 
 id="x1-75015"></a><a 
href="#noweb.end-1"><span 
class="ecrm-0800">66c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">end</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.end-1"><span 
class="ecrm-0800">66c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-137"><span class="label"><a 
 id="x1-75016r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">END</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75017r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">debug&#8211;output</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.debug-output-1"><span 
class="ecrm-0800">66b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75018r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ORS</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75019r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">generate&#8211;output</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.generate-output-1"><span 
class="ecrm-0800">66a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75020r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We write chunk names like this. If we seem to be running in notangle compatibility
mode, then we enclose the name like this <span 
class="ectt-1000">&#x003C;&#xFEFF;&#x003C;name&#x003E;&#xFEFF;&#x003E; </span>the same way notangle
does:
</p>

<a 
 id="noweb.output_chunk_names()-1"></a><a 
 id="x1-75021"></a><a 
href="#noweb.output_chunk_names()-1"><span 
class="ecrm-0800">66d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">output_chunk_names()</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.output_chunk_names()-1"><span 
class="ecrm-0800">66d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-138"><span class="label"><a 
 id="x1-75022r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk_names</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prefix</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">suffix</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75023r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75024r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">notangle_mode</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75025r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prefix</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x003C;&#x003C;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75026r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">suffix</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x003E;&#x003E;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75027r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75028r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75029r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prefix</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">suffix</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75030r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75031r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >This function would write out all chunks
</p>

<a 
 id="noweb.output_chunks()-1"></a><a 
 id="x1-75032"></a><a 
href="#noweb.output_chunks()-1"><span 
class="ecrm-0800">66e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">output_chunks()</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.output_chunks()-1"><span 
class="ecrm-0800">66e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-139"><span class="label"><a 
 id="x1-75033r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunks</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75034r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75035r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75036r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">a</span><span 
class="ectt-0800">]);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75037r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75038r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75039r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75040r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">output_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75041r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">newline</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75042r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_needed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">linenos</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75043r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75044r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">write_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-75045r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">}</span>
                                                                  

                                                                  
</div>
<h3 class="sectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-7600010.1"></a>Assembling the chunks</h3>
<p class="noindent" ><span 
class="ectt-1000">chunk_path </span>holds a string consisting of the names of all the chunks that resulted in
this chunk being output. It should probably also contain the source line numbers at
which each inclusion also occured.
</p><p class="noindent" >We first initialize the mode tracker for this chunk.
</p>

<a 
 id="noweb.write_chunk()-1"></a><a 
 id="x1-76001"></a><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-2"><span 
class="ecrm-0800">67b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-140"><span class="label"><a 
 id="x1-76002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">write_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">awk&#8211;delete&#8211;array</span><span 
class="ecrm-0800">(context)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.awk-delete-array-1"><span 
class="ecrm-0800">32d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">write_chunk_r</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.write_chunk()-2"></a><a 
 id="x1-76006"></a><a 
href="#noweb.write_chunk()-2"><span 
class="ecrm-0800">67b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-3"><span 
class="ecrm-0800">67c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-141"><span class="label"><a 
 id="x1-76007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">write_chunk_r</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76008r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">optional</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76009r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_path</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_args</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76010r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_src</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76011r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76012r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part_line</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_frag</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76013r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">only_part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_context</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-76014r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">{</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">10.1.1   </span> <a 
 id="x1-7700010.1.1"></a>Chunk parts</h4>
<p class="noindent" >As mentioned in section <a 
href="#x1-730008.3.1">8.3.1<!--tex4ht:ref: sub:lstlistings-includes --></a>, a chunk name may contain a part specifier in square
brackets, limiting the parts that should be emitted.
</p>

<a 
 id="noweb.write_chunk()-3"></a><a 
 id="x1-77001"></a><a 
href="#noweb.write_chunk()-3"><span 
class="ecrm-0800">67c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write_chunk()-2"><span 
class="ecrm-0800">67b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-4"><span 
class="ecrm-0800">67d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-142"><span class="label"><a 
 id="x1-77002r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^(.*)\\[([0-9]*)\\]</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name_parts</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77003r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name_parts</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77004r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">only_part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name_parts</span><span 
class="ectt-0800">[2];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77005r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We then create a mode tracker
</p>

<a 
 id="noweb.write_chunk()-4"></a><a 
 id="x1-77006"></a><a 
href="#noweb.write_chunk()-4"><span 
class="ecrm-0800">67d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>  <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write_chunk()-3"><span 
class="ecrm-0800">67c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-5"><span 
class="ecrm-0800">68a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-143"><span class="label"><a 
 id="x1-77007r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">new&#8211;mode&#8211;tracker</span><span 
class="ecrm-0800">(context,</span>
<span 
class="ecrm-0800">chunks[chunk_name,"language"],"")</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.new-mode-tracker-1"><span 
class="ecrm-0800">52a</span></a><span 
class="cmsy-8">&#x27E9;</span>
                                                                  

                                                                  
</div>
<p class="noindent" >We extract into <span 
class="ectt-1000">chunk_params </span>the names of the parameters that this chunk accepts,
whose values were (optionally) passed in <span 
class="ectt-1000">chunk_args</span>.
</p>

<a 
 id="noweb.write_chunk()-5"></a><a 
 id="x1-77008"></a><a 
href="#noweb.write_chunk()-5"><span 
class="ecrm-0800">68a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write_chunk()-4"><span 
class="ecrm-0800">67d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-6"><span 
class="ecrm-0800">68b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-144"><span class="label"><a 
 id="x1-77009r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">*</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >To assemble a chunk, we write out each part.
</p>

<a 
 id="noweb.write_chunk()-6"></a><a 
 id="x1-77010"></a><a 
href="#noweb.write_chunk()-6"><span 
class="ecrm-0800">68b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">(text)[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write_chunk()-5"><span 
class="ecrm-0800">68a</span></a><div class="lstlisting" id="listing-145"><span class="label"><a 
 id="x1-77011r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77012r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">sprintf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">The</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">root</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">module</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x003C;&#x003C;%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#x003E;&#x003E;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">was</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">defined</span><span 
class="ectt-0800">.\</span><span 
class="ectt-0800">nUsed</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">by</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77013r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_path</span><span 
class="ectt-0800">));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77014r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77015r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77016r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77017r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_part</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77018r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">only_part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">only_part</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77019r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">write&#8211;part</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-part-1"><span 
class="ecrm-0800">68c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77020r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77021r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77022r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">finalize_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77023r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">dump_mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77024r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">error</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">sprintf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Module</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">did</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">close</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">properly</span><span 
class="ectt-0800">.\</span><span 
class="ectt-0800">nUsed</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">by</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_path</span><span 
class="ectt-0800">));</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77025r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77026r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >A part can either be a chunklet of lines, or an include of another chunk.
</p><p class="noindent" >Chunks may also have parameters, specified in <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> style with braces after the
chunk name &#8212; looking like this in the document: <span 
class="ectt-1000">chunkname{param1, param2}</span>.
Arguments are passed in square brackets: <span 
class="ectt-1000">\chunkref{chunkname}[arg1,</span>
<span 
class="ectt-1000">arg2]</span>.
</p><p class="noindent" >Before we process each part, we check that the source position hasn&#8217;t changed
unexpectedly, so that we can know if we need to output a new file-line directive.
</p>

<a 
 id="noweb.write-part-1"></a><a 
 id="x1-77027"></a><a 
href="#noweb.write-part-1"><span 
class="ecrm-0800">68c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;part</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-part-1"><span 
class="ecrm-0800">68c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-146"><span class="label"><a 
 id="x1-77028r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">check&#8211;source&#8211;jump</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.check-source-jump-1"><span 
class="ecrm-0800">70d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77029r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77030r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77031r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">type</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part_type_chunk</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77032r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">write&#8211;included&#8211;chunk</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-included-chunk-1"><span 
class="ecrm-0800">68d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77033r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77034r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">write&#8211;chunklets</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77035r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77036r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">empty</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">last</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">chunklet</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77037r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >To write an included chunk, we must detect any optional chunk arguments in
parenthesis. Then we recurse calling <span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write_chunk()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write_chunk()-1"><span 
class="ecrm-0800">67a</span></a><span 
class="cmsy-10">&#x27E9;</span>.
</p>

<a 
 id="noweb.write-included-chunk-1"></a><a 
 id="x1-77038"></a><a 
href="#noweb.write-included-chunk-1"><span 
class="ecrm-0800">68d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;included&#8211;chunk</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-included-chunk-1"><span 
class="ecrm-0800">68d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-147"><span class="label"><a 
 id="x1-77039r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">match</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">^([^\\[\\(]*)\\((.*)\\)</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet_parts</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77040r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet_parts</span><span 
class="ectt-0800">[1];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77041r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">parse_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">like</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunklet_parts</span><span 
class="ectt-0800">[2],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77042r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77043r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">expand_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_args</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77044r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77045r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77046r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">split</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77047r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77048r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">update</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">the</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">transforms</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">arrays</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77049r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">new_src</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode_escaper</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77050r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">awk&#8211;delete&#8211;array</span><span 
class="ecrm-0800">(new_context)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.awk-delete-array-1"><span 
class="ecrm-0800">32d</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77051r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">write_chunk_r</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77052r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77053r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77054r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_path</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77055r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">call_chunk_args</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77056r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_src</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >Before we output a chunklet of lines, we first emit the file and line number if we have
one, and if it is safe to do so.
                                                                  

                                                                  
</p><p class="noindent" >Chunklets are generally broken up by includes, so the start of a chunklet is a good
place to do this. Then we output each line of the chunklet.
</p><p class="noindent" >When it is not safe, such as in the middle of a multi-line macro definition,
<span 
class="ectt-1000">lineno_suppressed </span>is set to true, and in such a case we note that we want to emit
the line statement when it is next safe.
</p>

<a 
 id="noweb.write-chunklets-1"></a><a 
 id="x1-77057"></a><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-2"><span 
class="ecrm-0800">69b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-148"><span class="label"><a 
 id="x1-77058r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">max_frag</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77059r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_frag</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77060r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">write&#8211;file&#8211;line</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-file-line-1"><span 
class="ecrm-0800">70c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >We then extract the chunklet text and expand any arguments.
</p>

<a 
 id="noweb.write-chunklets-2"></a><a 
 id="x1-77061"></a><a 
href="#noweb.write-chunklets-2"><span 
class="ecrm-0800">69b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-3"><span 
class="ecrm-0800">69c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-149"><span class="label"><a 
 id="x1-77062r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77063r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77064r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77065r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">/*</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">check</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">params</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">*/</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77066r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">expand_chunk_args</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_args</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >If the text is a single newline (which we keep separate - see <a 
href="#x1-730008.3.1">8.3.1<!--tex4ht:ref: lone-newline --></a>) then we increment
the line number. In the case where this is the last line of a chunk and it is not a
top-level chunk we replace the newline with an empty string &#8212; because the chunk
that included this chunk will have the newline at the end of the line that included
this chunk.
</p><p class="noindent" >We also note by <span 
class="ectt-1000">newline = 1 </span>that we have started a new line, so that indentation
can be managed with the following piece of text.
</p>

<a 
 id="noweb.write-chunklets-3"></a><a 
 id="x1-77067"></a><a 
href="#noweb.write-chunklets-3"><span 
class="ecrm-0800">69c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write-chunklets-2"><span 
class="ecrm-0800">69b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-4"><span 
class="ecrm-0800">69d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-150"><span class="label"><a 
 id="x1-77068r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77069r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77070r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77071r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">frag</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">max_frag</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_path</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77072r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77073r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">break</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77074r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77075r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">newline</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77076r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >If this text does not represent a newline, but we see that we are the first piece of text
on a newline, then we prefix our text with the current indent. NOTE: <span 
class="ectt-1000">newline </span>is a
global output-state variable, but the <span 
class="ectt-1000">indent </span>is not.
</p>

<a 
 id="noweb.write-chunklets-4"></a><a 
 id="x1-77077"></a><a 
href="#noweb.write-chunklets-4"><span 
class="ecrm-0800">69d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write-chunklets-3"><span 
class="ecrm-0800">69c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-5"><span 
class="ecrm-0800">70a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-151"><span class="label"><a 
 id="x1-77078r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77079r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">newline</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77080r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">newline</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77081r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >Tail will soon no longer be relevant once mode-detection is in place.
</p>

                                                                  

                                                                  
<a 
 id="noweb.write-chunklets-5"></a><a 
 id="x1-77084"></a><a 
href="#noweb.write-chunklets-5"><span 
class="ecrm-0800">70a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write-chunklets-4"><span 
class="ecrm-0800">69d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-6"><span 
class="ecrm-0800">70b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-152"><span class="label"><a 
 id="x1-77085r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77086r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">mode_tracker</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">context</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77087r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">transform_escape</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">text</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">src</span><span 
class="ectt-0800">);</span>
</div>
<p class="noindent" >If a line ends in a backslash &#8212; suggesting continuation &#8212; then we supress outputting
file-line as it would probably break the continued lines.
</p>

<a 
 id="noweb.write-chunklets-6"></a><a 
 id="x1-77088"></a><a 
href="#noweb.write-chunklets-6"><span 
class="ecrm-0800">70b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;chunklets</span><span 
class="ecrm-0800">(text)[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-chunklets-1"><span 
class="ecrm-0800">69a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.write-chunklets-5"><span 
class="ecrm-0800">70a</span></a><div class="lstlisting" id="listing-153"><span class="label"><a 
 id="x1-77089r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">linenos</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77090r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_suppressed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">lastline</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">lastline</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77091r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77092r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >Of course there is no point in actually outputting the source filename and line
number (file-line) if they don&#8217;t say anything new! We only need to emit them if they
aren&#8217;t what is expected, or if we we not able to emit one when they had
changed.
</p>

<a 
 id="noweb.write-file-line-1"></a><a 
 id="x1-77093"></a><a 
href="#noweb.write-file-line-1"><span 
class="ecrm-0800">70c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">write&#8211;file&#8211;line</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.write-file-line-1"><span 
class="ecrm-0800">70c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-154"><span class="label"><a 
 id="x1-77094r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">newline</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_needed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_suppressed</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77095r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">filename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a_filename</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77096r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a_lineno</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77097r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">filename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\"\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77098r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_needed</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77099r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >We check if a new file-line is needed by checking if the source line matches what we
(or a compiler) would expect.
</p>

<a 
 id="noweb.check-source-jump-1"></a><a 
 id="x1-77100"></a><a 
href="#noweb.check-source-jump-1"><span 
class="ecrm-0800">70d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">check&#8211;source&#8211;jump</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.check-source-jump-1"><span 
class="ecrm-0800">70d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-155"><span class="label"><a 
 id="x1-77101r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">linenos</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&amp;&amp;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77102r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a_filename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77103r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a_lineno</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">LINENO</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77104r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">a_filename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">filename</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">a_lineno</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77105r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">lineno_needed</span><span 
class="ectt-0800">++;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77106r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-77107r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">}</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;11</span><br /><a 
 id="x1-7800011"></a>Storing chunks</h2>
<p class="noindent" >Awk has pretty limited data structures, so we will use two main hashes.
Uninterrupted sequences of a chunk will be stored in <span 
class="ectt-1000">chunklets </span>and the chunklets
used in a chunk will be stored in <span 
class="ectt-1000">chunks</span>.
</p>

<a 
 id="noweb.constants-1"></a><a 
 id="x1-78001"></a><a 
href="#noweb.constants-1"><span 
class="ecrm-0800">71a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">constants</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.constants-1"><span 
class="ecrm-0800">71a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;           </span><div class="lstlisting" id="listing-156"><span class="label"><a 
 id="x1-78002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">part_type_chunk</span><span 
class="ectt-0800">=1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">;</span>
</div>
<p class="noindent" >The <span 
class="ectt-1000">params </span>mentioned are not chunk parameters for parameterized chunks, as
mentioned in <a 
href="#x1-420006.2">6.2<!--tex4ht:ref: cha:Chunk Arguments --></a>, but the lstlistings style parameters used in the <span 
class="ectt-1000">\Chunk</span>
command<span class="footnote-mark"><a 
href="#fn1x12" id="fn1x12-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-78004f1"></a>.
</p>

<a 
 id="noweb.chunk-storage-functions-1"></a><a 
 id="x1-78005"></a><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunk&#8211;storage&#8211;functions</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-2"><span 
class="ecrm-0800">71c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-157"><span class="label"><a 
 id="x1-78006r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78007r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">local</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">vars</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78008r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78009r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78010r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">HACK</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">WHILE</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">WE</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">CHANGE</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">TO</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">(</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">)</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">for</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">PARAM</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">CHUNKS</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78011r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">gsub</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\\(\\)</span><span 
class="ectt-0800">$</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78012r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78013r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">debug</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">print</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">New</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78014r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78015r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78016r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">p</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78017r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78018r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78019r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">params</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78020r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(!</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_names</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78021r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">warning</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">appended</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">chunk</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">which</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">not</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">defined</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">yet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78022r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">new_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78023r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78024r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_include</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78025r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">append</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ORS</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78026r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78027r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78028r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">active_chunk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78029r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prime_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78030r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">}</span>
</div>

<a 
 id="noweb.chunk-storage-functions-2"></a><a 
 id="x1-78031"></a><a 
href="#noweb.chunk-storage-functions-2"><span 
class="ecrm-0800">71c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunk&#8211;storage&#8211;functions</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-3"><span 
class="ecrm-0800">71d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-158"><span class="label"><a 
 id="x1-78032r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78033r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prime_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78034r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78035r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78036r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">SUBSEP</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">];</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78037r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FILENAME</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78038r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">LINENO</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">FNR</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78039r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78040r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78041r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_line</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">){</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78042r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78043r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">chunklet</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">line</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78044r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >Chunk include represents a <span 
class="ecti-1000">chunkref  </span>statement, and stores the requirement to
include another chunk. The parameter indent represents the quanity of literal text
characters that preceded this <span 
class="ecti-1000">chunkref  </span>statement and therefore by how much
additional lines of the included chunk should be indented.
</p>

<a 
 id="noweb.chunk-storage-functions-3"></a><a 
 id="x1-78047"></a><a 
href="#noweb.chunk-storage-functions-3"><span 
class="ecrm-0800">71d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunk&#8211;storage&#8211;functions</span><span 
class="ecrm-0800">(text)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.chunk-storage-functions-2"><span 
class="ecrm-0800">71c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-4"><span 
class="ecrm-0800">71e</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-159"><span class="label"><a 
 id="x1-78048r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_include</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_ref</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78049r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78050r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunk_ref</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78051r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">type</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">part_type_chunk</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78052r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent_string</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78053r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunks</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">part</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">tail</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78054r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">prime_chunk</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">chunk_name</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78055r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >The indent is calculated by indent_string, which may in future convert some spaces
into tab characters. This function works by generating a printf padded format string,
like <span 
class="ectt-1000">%22s </span>for an indent of 22, and then printing an empty string using that
format.
</p>

<a 
 id="noweb.chunk-storage-functions-4"></a><a 
 id="x1-78058"></a><a 
href="#noweb.chunk-storage-functions-4"><span 
class="ecrm-0800">71e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunk&#8211;storage&#8211;functions</span><span 
class="ecrm-0800">(text)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunk-storage-functions-1"><span 
class="ecrm-0800">71b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.chunk-storage-functions-3"><span 
class="ecrm-0800">71d</span></a><div class="lstlisting" id="listing-160"><span class="label"><a 
 id="x1-78059r51"></a><span 
class="ecrm-0500">51</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent_string</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78060r52"></a><span 
class="ecrm-0500">52</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">sprintf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">indent</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">);</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-78061r53"></a><span 
class="ecrm-0500">53</span></span><span 
class="ectt-0800">}</span>
                                                                  

                                                                  
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;12</span><br /><a 
 id="x1-7900012"></a>getopt</h2>
<p class="noindent" >I use Arnold Robbins public domain getopt (1993 revision). This is probably the
same one that is covered in chapter 12 of &#8220;Edition 3 of GAWK: Effective AWK
Programming: A User&#8217;s Guide for GNU Awk&#8221; but as that is licensed under the GNU
Free Documentation License, Version 1.3, which conflicts with the GPL3, I can&#8217;t use
it from there (or it&#8217;s accompanying explanations), so I do my best to explain how it
works here.
</p><p class="noindent" >The getopt.awk header is:
</p>

<a 
 id="noweb.getopt.awk-header-1"></a><a 
 id="x1-79001"></a><a 
href="#noweb.getopt.awk-header-1"><span 
class="ecrm-0800">73a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk&#8211;header</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-header-1"><span 
class="ecrm-0800">73a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-161"><span class="label"><a 
 id="x1-79002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">getopt</span><span 
class="ecit-0800">.</span><span 
class="ecit-0800">awk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">---</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">do</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">C</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">library</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">getopt</span><span 
class="ecit-0800">(3)</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">function</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">in</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">awk</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Arnold</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Robbins</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">arnold@skeeve</span><span 
class="ecit-0800">.</span><span 
class="ecit-0800">com</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Public</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Domain</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecit-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Initial</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">version</span><span 
class="ecit-0800">:</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">March</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">1991</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Revised</span><span 
class="ecit-0800">:</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">May</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">1993</span>
</div>
<p class="noindent" >The provided explanation is:
</p>

<a 
 id="noweb.getopt.awk-notes-1"></a><a 
 id="x1-79010"></a><a 
href="#noweb.getopt.awk-notes-1"><span 
class="ecrm-0800">73b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk&#8211;notes</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-notes-1"><span 
class="ecrm-0800">73b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-162"><span class="label"><a 
 id="x1-79011r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">External</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">variables</span><span 
class="ecit-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79012r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Optind</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">--</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">index</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">in</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">ARGV</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">of</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">first</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">nonoption</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">argument</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79013r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Optarg</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">--</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">string</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">value</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">of</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">argument</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">to</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">current</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79014r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Opterr</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">--</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">if</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">nonzero</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">print</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">our</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">own</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">diagnostic</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79015r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Optopt</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">--</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">current</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">letter</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79016r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79017r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Returns</span><span 
class="ecit-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79018r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">-1</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">at</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">end</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">of</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">options</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79019r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">?</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">for</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">unrecognized</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79020r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x003C;</span><span 
class="ecit-0800">c</span><span 
class="ecit-0800">&#x003E;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">a</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">character</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">representing</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">the</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">current</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79021r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79022r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Private</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">Data</span><span 
class="ecit-0800">:</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79023r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">_opti</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">--</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">index</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">in</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">multi</span><span 
class="ecit-0800">-</span><span 
class="ecit-0800">flag</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ecit-0800">,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">e</span><span 
class="ecit-0800">.</span><span 
class="ecit-0800">g</span><span 
class="ecit-0800">.,</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">-</span><span 
class="ecit-0800">abc</span>
</div>
<p class="noindent" >The function follows. The final two parameters, <span 
class="ectt-1000">thisopt </span>and <span 
class="ectt-1000">i </span>are local
variables and not parameters &#8212; as indicated by the multiple spaces preceding
them. Awk doesn&#8217;t care, the multiple spaces are a convention to help us
humans.
</p>

<a 
 id="noweb.getopt.awk-getopt()-1"></a><a 
 id="x1-79026"></a><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk&#8211;getopt()</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-2"><span 
class="ecrm-0800">73d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-163"><span class="label"><a 
 id="x1-79027r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">function</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">getopt</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argc</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79028r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79029r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">no</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">options</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">given</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79030r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-1</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79031r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">all</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">done</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79032r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79033r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79034r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-1</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79035r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!~</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">^-[^:</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">t</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">f</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">r</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">v</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">b</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79036r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79037r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-1</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79038r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79039r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79040r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">2</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79041r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79042r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optopt</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79043r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">index</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79044r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79045r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">Opterr</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79046r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">%</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">--</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">invalid</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">option</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79047r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">dev</span><span 
class="ectt-0800">/</span><span 
class="ectt-0800">stderr</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79048r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">]))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79049r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79050r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79051r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79052r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79053r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">?</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79054r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >At this point, the option has been found and we need to know if it takes any
arguments.
</p>

<a 
 id="noweb.getopt.awk-getopt()-2"></a><a 
 id="x1-79055"></a><a 
href="#noweb.getopt.awk-getopt()-2"><span 
class="ecrm-0800">73d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk&#8211;getopt()</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><div class="lstlisting" id="listing-164"><span class="label"><a 
 id="x1-79056r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">options</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">i</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79057r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">get</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">option</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">argument</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79058r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79059r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">substr</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">],</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">+</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79060r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79061r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[++</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79062r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79063r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79064r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79065r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">==</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">||</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003E;=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">length</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">argv</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">]))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79066r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79067r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">0</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79068r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">else</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79069r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_opti</span><span 
class="ectt-0800">++</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79070r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">return</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">thisopt</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79071r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >A test program is built in, too
</p>

                                                                  

                                                                  
<a 
 id="noweb.getopt.awk-begin-1"></a><a 
 id="x1-79072"></a><a 
href="#noweb.getopt.awk-begin-1"><span 
class="ecrm-0800">74a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk&#8211;begin</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-begin-1"><span 
class="ecrm-0800">74a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-165"><span class="label"><a 
 id="x1-79073r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">BEGIN</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79074r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Opterr</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">default</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">is</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">to</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">diagnose</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79075r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">skip</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">ARGV</span><span 
class="ecit-0800">[0]</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79076r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">test</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">program</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79077r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">if</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">_getopt_test</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79078r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">while</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">((</span><span 
class="ectt-0800">_go_c</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">getopt</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">ARGC</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ARGV</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">ab</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">cd</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">))</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">!=</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">-1)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79079r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x003C;%</span><span 
class="ectt-0800">c</span><span 
class="ectt-0800">&#x003E;,</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">optarg</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x003C;%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#x003E;\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79080r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">_go_c</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optarg</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79081r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">non</span><span 
class="ectt-0800">-</span><span 
class="ectt-0800">option</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">arguments</span><span 
class="ectt-0800">:\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79082r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">for</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">(;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x003C;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ARGC</span><span 
class="ectt-0800">;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">++)</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79083r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">printf</span><span 
class="ectt-0800">(</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">\</span><span 
class="ectt-0800">tARGV</span><span 
class="ectt-0800">[%</span><span 
class="ectt-0800">d</span><span 
class="ectt-0800">]</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">=</span><span 
class="ectt-0800">&#x2423;</span><span 
class="ectt-0800">&#x003C;%</span><span 
class="ectt-0800">s</span><span 
class="ectt-0800">&#x003E;\</span><span 
class="ectt-0800">n</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79084r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">ARGV</span><span 
class="ectt-0800">[</span><span 
class="ectt-0800">Optind</span><span 
class="ectt-0800">])</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79085r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79086r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">}</span>
</div>
<p class="noindent" >The entire getopt.awk is made out of these chunks in order
</p>

<a 
 id="noweb.getopt.awk-1"></a><a 
 id="x1-79087"></a><a 
href="#noweb.getopt.awk-1"><span 
class="ecrm-0800">74b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt.awk</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-1"><span 
class="ecrm-0800">74b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-166"><span class="label"><a 
 id="x1-79088r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;header</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-header-1"><span 
class="ecrm-0800">73a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79089r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79090r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;notes</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-notes-1"><span 
class="ecrm-0800">73b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79091r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;getopt()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79092r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;begin</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-begin-1"><span 
class="ecrm-0800">74a</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >Although we only want the header and function:
</p>

<a 
 id="noweb.getopt-1"></a><a 
 id="x1-79093"></a><a 
href="#noweb.getopt-1"><span 
class="ecrm-0800">74c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">getopt</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt-1"><span 
class="ecrm-0800">74c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-167"><span class="label"><a 
 id="x1-79094r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">try</span><span 
class="ecit-0800">:</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">locate</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">getopt</span><span 
class="ecit-0800">.</span><span 
class="ecit-0800">awk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">for</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">the</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">full</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">original</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">file</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79095r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-0800">#</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">as</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">part</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">of</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">your</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">standard</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">awk</span><span 
class="ecit-0800">&#x00A0;</span><span 
class="ecit-0800">installation</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79096r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;header</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-header-1"><span 
class="ecrm-0800">73a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79097r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-79098r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">getopt.awk&#8211;getopt()</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.getopt.awk-getopt()-1"><span 
class="ecrm-0800">73c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;13</span><br /><a 
 id="x1-8000013"></a>Fangle <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> source code</h2>
<h3 class="sectionHead"><span class="titlemark">13.1   </span> <a 
 id="x1-8100013.1"></a>fangle module</h3>
<p class="noindent" >Here we define a Lyx .module file that makes it convenient to use LY X for writing
such literate programs.
</p><p class="noindent" >This file <span 
class="ectt-1000">./fangle.module </span>can be installed in your personal <span 
class="ectt-1000">.lyx/layouts</span>
<span 
class="ectt-1000">folder</span>. You will need to Tools Reconfigure so that LY X notices it. It adds a new
format Chunk, which should precede every listing and contain the chunk
name.
</p>

<a 
 id="noweb../fangle.module-1"></a><a 
 id="x1-81001"></a><a 
href="#noweb../fangle.module-1"><span 
class="ecrm-0800">75a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.module</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.module-1"><span 
class="ecrm-0800">75a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-168"><span class="label"><a 
 id="x1-81002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">#\</span><span 
class="ectt-0800">DeclareLyXModule</span><span 
class="ectt-0800">{</span><span 
class="ectt-0800">Fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Literate</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Listings</span><span 
class="ectt-0800">}</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">DescriptionBegin</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">literate</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">listings</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">allow</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">one</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">write</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">literate</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">programs</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">after</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fashion</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">of</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">,</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">but</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">without</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">having</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">use</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">noweave</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">generate</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">documentation</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Instead</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">listings</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">package</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">is</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">extended</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">in</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">conjunction</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">with</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">the</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">noweb</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">package</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">implement</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">to</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">code</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">formating</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">directly</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">as</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">latex</span><span 
class="ectt-0800">.</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">The</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">fangle</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">awk</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">script</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">#</span><span 
class="ectt-0800">DescriptionEnd</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">gpl3&#8211;copyright.hashed</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gpl3-copyright.hashed-1"><span 
class="ecrm-0800">75b</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">Format</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">11</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">AddToPreamble</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81017r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">./fangle.sty</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81018r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">EndPreamble</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81019r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81020r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">chunkstyle</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkstyle-1"><span 
class="ecrm-0800">76a</span></a><span 
class="cmsy-8">&#x27E9;</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81021r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-81022r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">chunkref</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkref-1"><span 
class="ecrm-0800">76c</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >Because LY X modules are not yet a language supported by fangle or lstlistings,
we resort to this fake awk chunk below in order to have each line of the GPL3 license
commence with a #
</p>

<a 
 id="noweb.gpl3-copyright.hashed-1"></a><a 
 id="x1-81023"></a><a 
href="#noweb.gpl3-copyright.hashed-1"><span 
class="ecrm-0800">75b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">gpl3&#8211;copyright.hashed</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gpl3-copyright.hashed-1"><span 
class="ecrm-0800">75b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;           </span><div class="lstlisting" id="listing-169"><span class="label"><a 
 id="x1-81024r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-0800">#</span><span 
class="cmsy-8">&#x27E8;</span><span 
class="ecti-0800">gpl3&#8211;copyright</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.gpl3-copyright-1"><span 
class="ecrm-0800">4</span></a><span 
class="cmsy-8">&#x27E9;</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.1.1   </span> <a 
 id="x1-8200013.1.1"></a>The Chunk style</h4>
<p class="noindent" >The purpose of the <span 
class="eccc-1000"><span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">N</span><span 
class="small-caps">K</span> </span>style is to make it easier for LY X users to provide the
name to <span 
class="ectt-1000">\lstlistings</span>. Normally this requires right-clicking on the listing, choosing
settings, advanced, and then typing <span 
class="ectt-1000">name=chunk-name</span>. This has the further
disadvantage that the name (and other options) are not generally visible during
document editing.
</p><p class="noindent" >The chunk style is defined as a <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> command, so that all text on the
same line is passed to the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> command <span 
class="ectt-1000">Chunk</span>. This makes it easy to
parse using <span 
class="ectt-1000">fangle</span>, and easy to pass these options on to the listings
package. The first word in a chunk section should be the chunk name, and will
have <span 
class="ectt-1000">name= </span>prepended to it. Any other words are accepted arguments to
<span 
class="ectt-1000">\lstset</span>.
                                                                  

                                                                  
</p><p class="noindent" >We set PassThru to 1 because the user is actually entering raw latex.
</p>

<a 
 id="noweb.chunkstyle-1"></a><a 
 id="x1-82001"></a><a 
href="#noweb.chunkstyle-1"><span 
class="ecrm-0800">76a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunkstyle</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkstyle-1"><span 
class="ecrm-0800">76a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkstyle-2"><span 
class="ecrm-0800">76b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-170"><span class="label"><a 
 id="x1-82002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">Style</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LatexType</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Command</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LatexName</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Margin</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">First_Dynamic</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LeftMargin</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">xxx</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LabelSep</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">xx</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LabelType</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Static</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LabelString</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">Chunk</span><span 
class="ectt-0800">:</span><span 
class="ectt-0800">"</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Align</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Left</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">PassThru</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span>
</div>
<p class="noindent" >To make the label very visible we choose a larger font coloured red.
</p>

<a 
 id="noweb.chunkstyle-2"></a><a 
 id="x1-82014"></a><a 
href="#noweb.chunkstyle-2"><span 
class="ecrm-0800">76b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunkstyle</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkstyle-1"><span 
class="ecrm-0800">76a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.chunkstyle-1"><span 
class="ecrm-0800">76a</span></a><div class="lstlisting" id="listing-171"><span class="label"><a 
 id="x1-82015r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LabelFont</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82016r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Family</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Sans</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82017r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Size</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Large</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82018r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Series</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Bold</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82019r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Shape</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Italic</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82020r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Color</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">red</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82021r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">EndFont</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-82022r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-0800">End</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.1.2   </span> <a 
 id="x1-8300013.1.2"></a>The chunkref style</h4>
<p class="noindent" >We also define the Chunkref style which can be used to express cross references to
chunks.
</p>

<a 
 id="noweb.chunkref-1"></a><a 
 id="x1-83001"></a><a 
href="#noweb.chunkref-1"><span 
class="ecrm-0800">76c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">chunkref </span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.chunkref-1"><span 
class="ecrm-0800">76c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-172"><span class="label"><a 
 id="x1-83002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-0800">InsetLayout</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Chunkref</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LyxType</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">charstyle</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LatexType</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Command</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LatexName</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">chunkref</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">PassThru</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">1</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">LabelFont</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Shape</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Italic</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">Color</span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">red</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-0800">&#x00A0;</span><span 
class="ectt-0800">EndFont</span><span 
class="ectt-0800">&#x00A0;</span><br /><span class="label"><a 
 id="x1-83011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-0800">End</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">13.2   </span> <a 
 id="x1-8400013.2"></a>Latex Macros</h3>
<p class="noindent" >We require the <span 
class="eccc-1000"><span 
class="small-caps">L</span><span 
class="small-caps">I</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">S</span></span>, <span 
class="eccc-1000"><span 
class="small-caps">N</span><span 
class="small-caps">O</span><span 
class="small-caps">W</span><span 
class="small-caps">E</span><span 
class="small-caps">B</span> </span>and <span 
class="eccc-1000"><span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span><span 
class="small-caps">S</span> </span>packages. As noweb defines it&#8217;s own
<span 
class="ectt-1000">\code </span>environment, we re-define the one that LY X logical markup module expects
here.
</p>

                                                                  

                                                                  
<a 
 id="noweb../fangle.sty-1"></a><a 
 id="x1-84001"></a><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-2"><span 
class="ecrm-0800">77b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-173"><span class="label"><a 
 id="x1-84002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">usepackage</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">listings</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">usepackage</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">noweb</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">usepackage</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">xargs</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">renewcommand</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">code</span><span 
class="ectt-1000">}[1]{\</span><span 
class="ectt-1000">texttt</span><span 
class="ectt-1000">{#1}}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We also define a <span 
class="ectt-1000">CChunk </span>macro, for use as: <span 
class="ectt-1000">\begin{CChunk} </span>which will need
renaming to <span 
class="ectt-1000">\begin{Chunk} </span>when I can do this without clashing with <span 
class="ectt-1000">\Chunk</span>.
</p>

<a 
 id="noweb../fangle.sty-2"></a><a 
 id="x1-84006"></a><a 
href="#noweb../fangle.sty-2"><span 
class="ecrm-0800">77b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-3"><span 
class="ecrm-0800">77c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-174"><span class="label"><a 
 id="x1-84007r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lstnewenvironment</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">Chunk</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We also define a suitable <span 
class="ectt-1000">\lstset </span>of parameters that suit the literate programming
style after the fashion of <span 
class="eccc-1000"><span 
class="small-caps">N</span><span 
class="small-caps">O</span><span 
class="small-caps">W</span><span 
class="small-caps">E</span><span 
class="small-caps">A</span><span 
class="small-caps">V</span><span 
class="small-caps">E</span></span>.
</p>

<a 
 id="noweb../fangle.sty-3"></a><a 
 id="x1-84008"></a><a 
href="#noweb../fangle.sty-3"><span 
class="ecrm-0800">77c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-2"><span 
class="ecrm-0800">77b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-4"><span 
class="ecrm-0800">77d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-175"><span class="label"><a 
 id="x1-84009r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lstset</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">numbers</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">left</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">stepnumber</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">numbersep</span><span 
class="ectt-1000">=5</span><span 
class="ectt-1000">pt</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84010r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">breaklines</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">false</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">basicstyle</span><span 
class="ectt-1000">=\</span><span 
class="ectt-1000">ttfamily</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84011r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">numberstyle</span><span 
class="ectt-1000">=\</span><span 
class="ectt-1000">tiny</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">language</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">C</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We also define a notangle-like mechanism for <span 
class="ecti-1000">escaping </span>to <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> from the listing,
and by which we can refer to other listings. We declare the <span 
class="ectt-1000">=&#x003C;</span><span 
class="ectt-1000">&hellip;&#x003E; </span>sequence to contain
<span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> code, and include another like this chunk: <span 
class="ectt-1000">=&#x003C;\chunkref{chunkname}&#x003E;</span>.
However, because <span 
class="ectt-1000">=&#x003C;</span><span 
class="ectt-1000">&hellip;&#x003E; </span>is already defined to contain <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> code for this document
&#8212; this is a <span 
class="eccc-1000"><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">W</span><span 
class="small-caps">F</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span>document after all &#8212; the code fragment below effectively
contains the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> code: <span 
class="ectt-1000">}{</span>. To avoid problems with document generation, I had
to declare an lstlistings property: <span 
class="ectt-1000">escapeinside={} </span>for this listing only; which
in LY X was done by right-clicking the listings inset, choosing <span 
class="ectt-1000">settings</span><span 
class="cmmi-10">&#x22B3;</span>
<span 
class="ectt-1000">advanced</span>.
</p>

<a 
 id="noweb../fangle.sty-4"></a><a 
 id="x1-84012"></a><a 
href="#noweb../fangle.sty-4"><span 
class="ecrm-0800">77d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[4]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-3"><span 
class="ecrm-0800">77c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-5"><span 
class="ecrm-0800">78a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-176"><span class="label"><a 
 id="x1-84013r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lstset</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">escapeinside</span><span 
class="ectt-1000">={=&#x003C;}{&#x003E;}}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >Although our macros will contain the @ symbol, they will be included in a
<span 
class="ectt-1000">\makeatletter </span>section by LY X; however we keep the commented out <span 
class="ectt-1000">\makeatletter</span>
as a reminder. The listings package likes to centre the titles, but noweb titles are
specially formatted and must be left aligned. The simplest way to do this turned out
to be by removing the definition of <span 
class="ectt-1000">\lst@maketitle</span>. This may interact badly if
other listings want a regular title or caption. We remember the old maketitle in case
we need it.
                                                                  

                                                                  
</p>

<a 
 id="noweb../fangle.sty-5"></a><a 
 id="x1-84014"></a><a 
href="#noweb../fangle.sty-5"><span 
class="ecrm-0800">78a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[5]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-4"><span 
class="ecrm-0800">77d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-6"><span 
class="ecrm-0800">78b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-177"><span class="label"><a 
 id="x1-84015r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">makeatletter</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84016r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">somehow</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">re</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">defining</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">maketitle</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">gives</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">us</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">left</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">aligned</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">title</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84017r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">which</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">is</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">extactly</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">what</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">our</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">specially</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">formatted</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">title</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">needs</span><span 
class="ecit-1000">!</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84018r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">let</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@lst@maketitle</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@maketitle</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84019r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@maketitle</span><span 
class="ectt-1000">{}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.2.1   </span> <a 
 id="x1-8500013.2.1"></a>The chunk command</h4>
<p class="noindent" >Our chunk command accepts one argument, and calls <span 
class="ectt-1000">\ltset</span>. Although <span 
class="ectt-1000">\ltset</span>
will note the name, this is erased when the next <span 
class="ectt-1000">\lstlisting </span>starts, so we
make a note of this in <span 
class="ectt-1000">\lst@chunkname </span>and restore in in lstlistings Init
hook.
</p>

<a 
 id="noweb../fangle.sty-6"></a><a 
 id="x1-85001"></a><a 
href="#noweb../fangle.sty-6"><span 
class="ecrm-0800">78b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[6]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-5"><span 
class="ecrm-0800">78a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-7"><span 
class="ecrm-0800">78c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-178"><span class="label"><a 
 id="x1-85002r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">Chunk</span><span 
class="ectt-1000">#1{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-85003r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lstset</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">title</span><span 
class="ectt-1000">={\</span><span 
class="ectt-1000">fanglecaption</span><span 
class="ectt-1000">},</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">=#1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-85004r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@chunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-85005r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-85006r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@chunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">empty</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">13.2.1.1   </span> <a 
 id="x1-8600013.2.1.1"></a>Chunk parameters</h5>
<p class="noindent" >Fangle permits parameterized chunks, and requires the paramters to be specified
as listings options. The fangle script uses this, and although we don&#8217;t do anything
with these in the <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> code right now, we need to stop the listings package
complaining.
</p>

<a 
 id="noweb../fangle.sty-7"></a><a 
 id="x1-86001"></a><a 
href="#noweb../fangle.sty-7"><span 
class="ecrm-0800">78c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[7]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-6"><span 
class="ecrm-0800">78b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-8"><span 
class="ecrm-0800">79a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-179"><span class="label"><a 
 id="x1-86002r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@Key</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">params</span><span 
class="ectt-1000">}\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@chunk@params</span><span 
class="ectt-1000">{#1}}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >As it is common to define a chunk which then needs appending to another chunk,
and annoying to have to declare a single line chunk to manage the include, we
support an <span 
class="ectt-1000">append= </span>option.
                                                                  

                                                                  
</p>

<a 
 id="noweb../fangle.sty-8"></a><a 
 id="x1-86003"></a><a 
href="#noweb../fangle.sty-8"><span 
class="ecrm-0800">79a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[8]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-7"><span 
class="ecrm-0800">78c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-9"><span 
class="ecrm-0800">79b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-180"><span class="label"><a 
 id="x1-86004r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@Key</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">append</span><span 
class="ectt-1000">}\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@chunk@append</span><span 
class="ectt-1000">{#1}}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.2.2   </span> <a 
 id="x1-8700013.2.2"></a>The noweb styled caption</h4>
<p class="noindent" >We define a public macro <span 
class="ectt-1000">\fanglecaption </span>which can be set as a regular title. By
means of <span 
class="ectt-1000">\protect</span>, It expands to <span 
class="ectt-1000">\fangle@caption </span>at the appriate time when
the caption is emitted.
</p>

<a 
 id="noweb../fangle.sty-9"></a><a 
 id="x1-87001"></a><a 
href="#noweb../fangle.sty-9"><span 
class="ecrm-0800">79b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[9]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-8"><span 
class="ecrm-0800">79a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-10"><span 
class="ecrm-0800">82a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-181"><span class="label"><a 
 id="x1-87002r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fanglecaption</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">protect</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@caption</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-87003r1"></a>
                                                                  

                                                                  
<div class="fbox"><div class="minipage">22c      <span 
class="tcrm-1000">&#8249;</span><span 
class="ecti-1000">some-chunk </span>19b<span 
class="tcrm-1000">&#8250;</span><span 
class="cmsy-10">&equiv; </span><span 
class="cmr-10">+                  </span><span 
class="cmmi-10">&#x22B2;</span>22b   24d<span 
class="cmmi-10">&#x22B3;</span>
<p class="noindent" ><span 
class="ecrm-0800">In this example, the current chunk is 22c, and therefore the third chunk on page 22.</span>
</p><p class="noindent" ><span 
class="ecrm-0800">It&#8217;s name is </span><span 
class="ecti-0800">some-chunk</span><span 
class="ecrm-0800">.</span>
</p><p class="noindent" ><span 
class="ecrm-0800">The first chunk with this name (19b) occurs as the second chunk on page 19.</span>
</p><p class="noindent" ><span 
class="ecrm-0800">The previous chunk (22d) with the same name is the second chunk on page 22.</span>
</p><p class="noindent" ><span 
class="ecrm-0800">The next chunk (24d) is the fourth chunk on page 24.</span>
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;13.1: </span><span  
class="content">noweb heading</span></div><!--tex4ht:label?: x1-87003r1 -->                                          </div></div>
                                                                  

                                                                  
</div><hr class="endfigure" />
<p class="noindent" >The general noweb output format compactly identifies the current chunk, and
references to the first chunk, and the previous and next chunks that have the same
name.
</p><p class="noindent" >This means that we need to keep a counter for each chunk-name, that we use to
count chunks of the same name.
</p>
<h4 class="subsectionHead"><span class="titlemark">13.2.3   </span> <a 
 id="x1-8800013.2.3"></a>The chunk counter</h4>
<p class="noindent" >It would be natural to have a counter for each chunk name, but <span class="TEX">T<span 
class="E">E</span>X</span> would soon run out of
counters<span class="footnote-mark"><a 
href="#fn1x14" id="fn1x14-bk"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-88001f1"></a>,
so we have one counter which we save at the end of a chunk and restore at the
beginning of a chunk.
</p>

<a 
 id="noweb../fangle.sty-10"></a><a 
 id="x1-88002"></a><a 
href="#noweb../fangle.sty-10"><span 
class="ecrm-0800">82a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[10]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-9"><span 
class="ecrm-0800">79b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-11"><span 
class="ecrm-0800">83a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-182"><span class="label"><a 
 id="x1-88003r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">newcounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We construct the name of this variable to store the counter to be the text
<span 
class="ectt-1000">lst-chunk- </span>prefixed onto the chunks own name, and store it in <span 
class="ectt-1000">\chunkcount</span>.
</p><p class="noindent" >We save the counter like this:
</p>

<a 
 id="noweb.save-counter-1"></a><a 
 id="x1-88004"></a><a 
href="#noweb.save-counter-1"><span 
class="ecrm-0800">82b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">save&#8211;counter</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.save-counter-1"><span 
class="ecrm-0800">82b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-183"><span class="label"><a 
 id="x1-88005r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">expandafter</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">arabic</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >and restore the counter like this:
</p>

<a 
 id="noweb.restore-counter-1"></a><a 
 id="x1-88006"></a><a 
href="#noweb.restore-counter-1"><span 
class="ecrm-0800">82c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">restore&#8211;counter</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.restore-counter-1"><span 
class="ecrm-0800">82c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-184"><span class="label"><a 
 id="x1-88007r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">setcounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >If there does not already exist a variable whose name is stored in <span 
class="ectt-1000">\chunkcount</span>, then
we know we are the first chunk with this name, and then define a counter.
                                                                  

                                                                  
</p><p class="noindent" >Although chunks of the same name share a common counter, they must still be
distinguished. We use is the internal name of the listing, suffixed by the counter
value. So the first chunk might be <span 
class="ectt-1000">something-1 </span>and the second chunk be
<span 
class="ectt-1000">something-2</span>, etc.
</p><p class="noindent" >We also calculate the name of the previous chunk if we can (before we increment the
chunk counter). If this is the first chunk of that name, then <span 
class="ectt-1000">\prevchunkname </span>is set to
<span 
class="ectt-1000">\relax </span>which the noweb package will interpret as not existing.
</p>

<a 
 id="noweb../fangle.sty-11"></a><a 
 id="x1-88008"></a><a 
href="#noweb../fangle.sty-11"><span 
class="ecrm-0800">83a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[11]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-10"><span 
class="ecrm-0800">82a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-12"><span 
class="ecrm-0800">83b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-185"><span class="label"><a 
 id="x1-88009r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@caption</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88010r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">lst</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88011r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifundefined</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">}{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88012r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">expandafter</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">gdef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">{0}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88013r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">setcounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88014r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">let</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">prevchunkname</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">relax</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88015r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88016r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">setcounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88017r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">prevchunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">arabic</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88018r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >After incrementing the chunk counter, we then define the name of this chunk, as well
as the name of the first chunk.
</p>

<a 
 id="noweb../fangle.sty-12"></a><a 
 id="x1-88019"></a><a 
href="#noweb../fangle.sty-12"><span 
class="ecrm-0800">83b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[12]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-11"><span 
class="ecrm-0800">83a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-13"><span 
class="ecrm-0800">83c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-186"><span class="label"><a 
 id="x1-88020r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">addtocounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}{1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88021r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">expandafter</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">arabic</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88022r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">arabic</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88023r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">firstchunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">-1}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We now need to calculate the name of the next chunk. We do this by temporarily
skipping the counter on by one; however there may not actually be another chunk
with this name! We detect this by also defining a label for each chunk based on the
chunkname. If there is a next chunkname then it will define a label with that name.
As labels are persistent, we can at least tell the second time <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> is run.
If we don&#8217;t find such a defined label then we define <span 
class="ectt-1000">\nextchunkname </span>to
<span 
class="ectt-1000">\relax</span>.
</p>

<a 
 id="noweb../fangle.sty-13"></a><a 
 id="x1-88024"></a><a 
href="#noweb../fangle.sty-13"><span 
class="ecrm-0800">83c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[13]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-12"><span 
class="ecrm-0800">83b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-14"><span 
class="ecrm-0800">84a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-187"><span class="label"><a 
 id="x1-88025r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">addtocounter</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}{1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88026r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">edef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nextchunkname</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">arabic</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunkcounter</span><span 
class="ectt-1000">}}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88027r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifundefined</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">r@label</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">nextchunkname</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">let</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nextchunkname</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">}{}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >The noweb package requires that we define a <span 
class="ectt-1000">\sublabel </span>for every chunk, with a
unique name, which is then used to print out it&#8217;s navigation hints.
</p><p class="noindent" >We also define a regular label for this chunk, as was mentioned above when we
calculated <span 
class="ectt-1000">\nextchunkname</span>. This requires <span class="LATEX">L<span class="A">A</span><span class="TEX">T<span 
class="E">E</span>X</span></span> to be run at least twice after new
chunk sections are added &#8212; but noweb requried that anyway.
</p>

                                                                  

                                                                  
<a 
 id="noweb../fangle.sty-14"></a><a 
 id="x1-88028"></a><a 
href="#noweb../fangle.sty-14"><span 
class="ecrm-0800">84a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[14]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-13"><span 
class="ecrm-0800">83c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-15"><span 
class="ecrm-0800">84b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-188"><span class="label"><a 
 id="x1-88029r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">sublabel</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88030r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">define</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">this</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">label</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">for</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">every</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">chunk</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">instance</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">so</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">we</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88031r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">can</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">tell</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">when</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">we</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">are</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">last</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">chunk</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">of</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">this</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">name</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88032r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">-\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We also try and add the chunk to the list of listings, but I&#8217;m afraid we don&#8217;t do very
well. We want each chunk name listing once, with all of it&#8217;s references.
</p>

<a 
 id="noweb../fangle.sty-15"></a><a 
 id="x1-88033"></a><a 
href="#noweb../fangle.sty-15"><span 
class="ecrm-0800">84b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[15]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-14"><span 
class="ecrm-0800">84a</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-16"><span 
class="ecrm-0800">84c</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-189"><span class="label"><a 
 id="x1-88034r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">addcontentsline</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">lol</span><span 
class="ectt-1000">}{</span><span 
class="ectt-1000">lstlisting</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">lst@name</span><span 
class="ectt-1000">~[\</span><span 
class="ectt-1000">protect</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">subpageref</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">}]}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >We then call the noweb output macros in the same way that noweave generates them,
except that we don&#8217;t need to call <span 
class="ectt-1000">\nwstartdeflinemarkup </span>or <span 
class="ectt-1000">\nwenddeflinemarkup</span>
&#8211; and if we do it messes up the output somewhat.
</p>

<a 
 id="noweb../fangle.sty-16"></a><a 
 id="x1-88035"></a><a 
href="#noweb../fangle.sty-16"><span 
class="ecrm-0800">84c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[16]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-15"><span 
class="ecrm-0800">84b</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-17"><span 
class="ecrm-0800">84d</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-190"><span class="label"><a 
 id="x1-88036r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nwmargintag</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88037r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88038r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nwtagstyle</span><span 
class="ectt-1000">{}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88039r49"></a><span 
class="ecrm-0500">49</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">subpageref</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88040r50"></a><span 
class="ecrm-0500">50</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88041r51"></a><span 
class="ecrm-0500">51</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88042r52"></a><span 
class="ecrm-0500">52</span></span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88043r53"></a><span 
class="ecrm-0500">53</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">moddef</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88044r54"></a><span 
class="ecrm-0500">54</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">lst@name</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88045r55"></a><span 
class="ecrm-0500">55</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88046r56"></a><span 
class="ecrm-0500">56</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nwtagstyle</span><span 
class="ectt-1000">{}\/</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88047r57"></a><span 
class="ecrm-0500">57</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifundefined</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunk@params</span><span 
class="ectt-1000">}{}{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88048r58"></a><span 
class="ecrm-0500">58</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(\</span><span 
class="ectt-1000">fangle@chunk@params</span><span 
class="ectt-1000">)</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88049r59"></a><span 
class="ecrm-0500">59</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88050r60"></a><span 
class="ecrm-0500">60</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[\</span><span 
class="ectt-1000">csname</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkcount</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endcsname</span><span 
class="ectt-1000">]~</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88051r61"></a><span 
class="ecrm-0500">61</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">subpageref</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">firstchunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88052r62"></a><span 
class="ecrm-0500">62</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88053r63"></a><span 
class="ecrm-0500">63</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifundefined</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">fangle@chunk@append</span><span 
class="ectt-1000">}{}{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88054r64"></a><span 
class="ecrm-0500">64</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">ifx</span><span 
class="ectt-1000">{}\</span><span 
class="ectt-1000">fangle@chunk@append</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">}\</span><span 
class="ectt-1000">else</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88055r65"></a><span 
class="ecrm-0500">65</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">,~</span><span 
class="ectt-1000">add</span><span 
class="ectt-1000">~</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">~\</span><span 
class="ectt-1000">fangle@chunk@append</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88056r66"></a><span 
class="ecrm-0500">66</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fi</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88057r67"></a><span 
class="ecrm-0500">67</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88058r68"></a><span 
class="ecrm-0500">68</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fangle@chunk@append</span><span 
class="ectt-1000">{}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88059r69"></a><span 
class="ecrm-0500">69</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lstset</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">append</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88060r70"></a><span 
class="ecrm-0500">70</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88061r71"></a><span 
class="ecrm-0500">71</span></span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88062r72"></a><span 
class="ecrm-0500">72</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">ifx</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">prevchunkname</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">endmoddef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">plusendmoddef</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fi</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88063r73"></a><span 
class="ecrm-0500">73</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">nwstartdeflinemarkup</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88064r74"></a><span 
class="ecrm-0500">74</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nwprevnextdefs</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">prevchunkname</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">nextchunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88065r75"></a><span 
class="ecrm-0500">75</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">nwenddeflinemarkup</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88066r76"></a><span 
class="ecrm-0500">76</span></span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >Originally this was developed as a <span 
class="ectt-1000">listings </span>aspect, in the Init hook, but it was
found easier to affect the title without using a hook &#8212; <span 
class="ectt-1000">\lst@AddToHookExe{PreSet}</span>
is still required to set the listings name to the name passed to the <span 
class="ectt-1000">\Chunk </span>command,
though.
</p>

<a 
 id="noweb../fangle.sty-17"></a><a 
 id="x1-88067"></a><a 
href="#noweb../fangle.sty-17"><span 
class="ecrm-0800">84d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[17]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-16"><span 
class="ecrm-0800">84c</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-18"><span 
class="ecrm-0800">85a</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-191"><span class="label"><a 
 id="x1-88068r77"></a><span 
class="ecrm-0500">77</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">lst@BeginAspect</span><span 
class="ecit-1000">{</span><span 
class="ecit-1000">fangle</span><span 
class="ecit-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88069r78"></a><span 
class="ecrm-0500">78</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">lst@Key</span><span 
class="ecit-1000">{</span><span 
class="ecit-1000">fangle</span><span 
class="ecit-1000">}{</span><span 
class="ecit-1000">true</span><span 
class="ecit-1000">}[</span><span 
class="ecit-1000">t</span><span 
class="ecit-1000">]{\</span><span 
class="ecit-1000">lstKV@SetIf</span><span 
class="ecit-1000">{#1}{</span><span 
class="ecit-1000">true</span><span 
class="ecit-1000">}}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88070r79"></a><span 
class="ecrm-0500">79</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@AddToHookExe</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">PreSet</span><span 
class="ectt-1000">}{\</span><span 
class="ectt-1000">global</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">let</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@intname</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@chunkname</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88071r80"></a><span 
class="ecrm-0500">80</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@AddToHook</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">Init</span><span 
class="ectt-1000">}{}</span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">fangle@caption</span><span 
class="ecit-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-88072r81"></a><span 
class="ecrm-0500">81</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">lst@EndAspect</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.2.4   </span> <a 
 id="x1-8900013.2.4"></a>Cross references</h4>
<p class="noindent" >We define the \chunkref command which makes it easy to generate visual references
to different code chunks, e.g.
</p>
                                                                  

                                                                  
<div class="tabular"> <table id="TBL-4" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /></colgroup><colgroup id="TBL-4-2g"><col 
id="TBL-4-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-1"  
class="td11">           Macro                 </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-2"  
class="td11">      Appearance         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-1"  
class="td11">     \chunkref{preamble}       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-2"  
class="td11">     <span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">preamble</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.preamble-1"><span 
class="ecbx-0800">??</span></a><span 
class="cmsy-10">&#x27E9;   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-1"  
class="td11">    \chunkref[3]{preamble}      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-2"  
class="td11">    <span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">preamble</span><span 
class="ecrm-0800">[3]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.preamble-3"><span 
class="ecbx-0800">??</span></a><span 
class="cmsy-10">&#x27E9;   </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-1"  
class="td11">\chunkref{preamble}[arg1, arg2]</td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-2"  
class="td11"><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">preamble</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.preamble-1"><span 
class="ecbx-0800">??</span></a><span 
class="cmsy-10">&#x27E9;</span>[arg1, arg2]</td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-1"  
class="td11">                           </td>
</tr></table></div>
<p class="noindent" >Chunkref can also be used within a code chunk to include another code chunk. The
third optional parameter to chunkref is a comma sepatarated list of arguments, which
will replace defined parameters in the chunkref.
</p>

<a 
 id="noweb../fangle.sty-18"></a><a 
 id="x1-89001"></a><a 
href="#noweb../fangle.sty-18"><span 
class="ecrm-0800">85a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[18]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-17"><span 
class="ecrm-0800">84d</span></a><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-19"><span 
class="ecrm-0800">85b</span></a> <span 
class="cmmi-8">&#x22B3;</span><div class="lstlisting" id="listing-192"><span class="label"><a 
 id="x1-89002r82"></a><span 
class="ecrm-0500">82</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkref@args</span><span 
class="ectt-1000">#1,{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89003r83"></a><span 
class="ecrm-0500">83</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">arg</span><span 
class="ectt-1000">{#1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89004r84"></a><span 
class="ecrm-0500">84</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@ReplaceIn</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">arg</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@filenamerpl</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89005r85"></a><span 
class="ecrm-0500">85</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">arg</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89006r86"></a><span 
class="ecrm-0500">86</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifnextchar</span><span 
class="ectt-1000">){\</span><span 
class="ectt-1000">relax</span><span 
class="ectt-1000">}{,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkref@args</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89007r87"></a><span 
class="ecrm-0500">87</span></span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89008r88"></a><span 
class="ecrm-0500">88</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">newcommand</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkref</span><span 
class="ectt-1000">[2][0]{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89009r89"></a><span 
class="ecrm-0500">89</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">@ifnextchar</span><span 
class="ectt-1000">({\</span><span 
class="ectt-1000">chunkref@i</span><span 
class="ectt-1000">{#1}{#2}}{\</span><span 
class="ectt-1000">chunkref@i</span><span 
class="ectt-1000">{#1}{#2}()}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89010r90"></a><span 
class="ecrm-0500">90</span></span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89011r91"></a><span 
class="ecrm-0500">91</span></span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkref@i</span><span 
class="ectt-1000">#1#2(#3){</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89012r92"></a><span 
class="ecrm-0500">92</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">zero</span><span 
class="ectt-1000">{0}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89013r93"></a><span 
class="ecrm-0500">93</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">{#2}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89014r94"></a><span 
class="ecrm-0500">94</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkno</span><span 
class="ectt-1000">{#1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89015r95"></a><span 
class="ecrm-0500">95</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkargs</span><span 
class="ectt-1000">{#3}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89016r96"></a><span 
class="ecrm-0500">96</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">ifx</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkno</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">zero</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89017r97"></a><span 
class="ecrm-0500">97</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">{#2-1}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89018r98"></a><span 
class="ecrm-0500">98</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">else</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89019r99"></a><span 
class="ecrm-0500">99</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">def</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">{#2-\</span><span 
class="ectt-1000">chunkno</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89020r100"></a><span 
class="ecrm-0500">100</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fi</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89021r101"></a><span 
class="ecrm-0500">101</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">let</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@arg</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunk</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89022r102"></a><span 
class="ecrm-0500">102</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@ReplaceIn</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">lst@filenamerpl</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89023r103"></a><span 
class="ecrm-0500">103</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">LA</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">moddef</span><span 
class="ecit-1000">{%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89024r104"></a><span 
class="ecrm-0500">104</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89025r105"></a><span 
class="ecrm-0500">105</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89026r106"></a><span 
class="ecrm-0500">106</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">nwtagstyle</span><span 
class="ectt-1000">{}\/</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89027r107"></a><span 
class="ecrm-0500">107</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">ifx</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkno</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">zero</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89028r108"></a><span 
class="ecrm-0500">108</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">else</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89029r109"></a><span 
class="ecrm-0500">109</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[\</span><span 
class="ectt-1000">chunkno</span><span 
class="ectt-1000">]</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89030r110"></a><span 
class="ecrm-0500">110</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fi</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89031r111"></a><span 
class="ecrm-0500">111</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">ifx</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">chunkargs</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">empty</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89032r112"></a><span 
class="ecrm-0500">112</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">else</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89033r113"></a><span 
class="ecrm-0500">113</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(\</span><span 
class="ectt-1000">chunkref@args</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">#3,)</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89034r114"></a><span 
class="ecrm-0500">114</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">fi</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89035r115"></a><span 
class="ecrm-0500">115</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">~\</span><span 
class="ectt-1000">subpageref</span><span 
class="ectt-1000">{\</span><span 
class="ectt-1000">chunkname</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89036r116"></a><span 
class="ecrm-0500">116</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89037r117"></a><span 
class="ecrm-0500">117</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89038r118"></a><span 
class="ecrm-0500">118</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">RA</span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">endmoddef</span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-89039r119"></a><span 
class="ecrm-0500">119</span></span><span 
class="ectt-1000">}</span><span 
class="ecit-1000">%</span>
</div>
<p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">13.2.5   </span> <a 
 id="x1-9000013.2.5"></a>The end</h4>

<a 
 id="noweb../fangle.sty-19"></a><a 
 id="x1-90001"></a><a 
href="#noweb../fangle.sty-19"><span 
class="ecrm-0800">85b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./fangle.sty</span><span 
class="ecrm-0800">(text)[19]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../fangle.sty-1"><span 
class="ecrm-0800">77a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span>        <span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb../fangle.sty-18"><span 
class="ecrm-0800">85a</span></a><div class="lstlisting" id="listing-193"><span class="label"><a 
 id="x1-90002r120"></a><span 
class="ecrm-0500">120</span></span><span 
class="ecit-1000">%</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-90003r121"></a><span 
class="ecrm-0500">121</span></span><span 
class="ecit-1000">%</span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">makeatother</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;14</span><br /><a 
 id="x1-9100014"></a>Extracting fangle</h2>
<h3 class="sectionHead"><span class="titlemark">14.1   </span> <a 
 id="x1-9200014.1"></a>Extracting from Lyx</h3>
<p class="noindent" >To extract from LY X, you will need to configure LY X as explained in section
<a 
href="#x1-140003.1.2">3.1.2<!--tex4ht:ref: sub:Configuring-the-build --></a>.
</p><p class="noindent" >And this lyx-build scrap will extract fangle for me.
</p>

<a 
 id="noweb.lyx-build-2"></a><a 
 id="x1-92001"></a><a 
href="#noweb.lyx-build-2"><span 
class="ecrm-0800">86a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-1"><span 
class="ecrm-0800">21b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.lyx-build-1"><span 
class="ecrm-0800">21b</span></a><div class="lstlisting" id="listing-194"><span class="label"><a 
 id="x1-92002r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">!</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">bin</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">sh</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92003r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-1000">set</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92004r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92005r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build&#8211;helper</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92006r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-1000">cd</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$PROJECT_DIR</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exit</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92007r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92008r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">usr</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">local</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">bin</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92009r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">usr</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">local</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">bin</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">module</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">module</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92010r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92011r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:helpers</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:helpers-1"><span 
class="ecrm-0800">87b</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92012r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-1000">export</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">FANGLE</span><span 
class="ectt-1000">=./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92013r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-1000">export</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">TMP</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">TMP</span><span 
class="ectt-1000">:-/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92014r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:run&#8211;tests</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:run-tests-1"><span 
class="ecrm-0800">86b</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92015r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">Now</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">check</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">that</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">we</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">can</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">extract</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">fangle</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">that</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">also</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">passes</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">tests</span><span 
class="ecit-1000">!</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92016r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-1000">$FANGLE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92017r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-1000">export</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">FANGLE</span><span 
class="ectt-1000">=./</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92018r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:run&#8211;tests</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:run-tests-1"><span 
class="ecrm-0800">86b</span></a><span 
class="cmsy-10">&#x27E9;</span>
</div>

<a 
 id="noweb.test:run-tests-1"></a><a 
 id="x1-92019"></a><a 
href="#noweb.test:run-tests-1"><span 
class="ecrm-0800">86b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:run&#8211;tests</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:run-tests-1"><span 
class="ecrm-0800">86b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-195"><span class="label"><a 
 id="x1-92020r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">run</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">tests</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92021r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">$FANGLE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">Rpca</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">awk</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">awk</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">f</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exit</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92022r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:cromulence</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:cromulence-1"><span 
class="ecrm-0800">53c</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92023r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:escapes</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:escapes-1"><span 
class="ecrm-0800">57d</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92024r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params-1"><span 
class="ecrm-0800">90e</span></a><span 
class="cmsy-10">&#x27E9;</span>
</div>
<p class="noindent" >With a lyx-build-helper
</p>

<a 
 id="noweb.lyx-build-helper-2"></a><a 
 id="x1-92025"></a><a 
href="#noweb.lyx-build-helper-2"><span 
class="ecrm-0800">86c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build&#8211;helper</span><span 
class="ecrm-0800">(text)[2]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;</span><span 
class="cmr-10">+</span><span 
class="cmsy-10">&equiv;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="ecrm-0800">&#x00A0;</span><span 
class="cmmi-8">&#x22B2;</span><a 
href="#noweb.lyx-build-helper-1"><span 
class="ecrm-0800">21a</span></a><div class="lstlisting" id="listing-196"><span class="label"><a 
 id="x1-92026r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-1000">PROJECT_DIR</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$LYX_r</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92027r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-1000">LYX_SRC</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$PROJECT_DIR</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">LYX_i</span><span 
class="ectt-1000">%.</span><span 
class="ectt-1000">tex</span><span 
class="ectt-1000">}.</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92028r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-1000">TEX_DIR</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$LYX_p</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-92029r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-1000">TEX_SRC</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$TEX_DIR</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">$LYX_i</span><span 
class="ectt-1000">"</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">14.2   </span> <a 
 id="x1-9300014.2"></a>Extracting documentation</h3>

<a 
 id="noweb../gen-www-1"></a><a 
 id="x1-93001"></a><a 
href="#noweb../gen-www-1"><span 
class="ecrm-0800">86d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./gen&#8211;www</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../gen-www-1"><span 
class="ecrm-0800">86d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-197"><span class="label"><a 
 id="x1-93002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">python</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">m</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">elyxer</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">--</span><span 
class="ecit-1000">css</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">lyx</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">css</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">$LYX_SRC</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">iconv</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">f</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">utf</span><span 
class="ecit-1000">-8</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">t</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">ISO</span><span 
class="ecit-1000">-8859-1//</span><span 
class="ecit-1000">TRANSLIT</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">sed</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#8217;</span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">UTF</span><span 
class="ecit-1000">-8"\(.\)&#x003E;/</span><span 
class="ecit-1000">ISO</span><span 
class="ecit-1000">-8859-1"\1&#x003E;/&#8217;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#x003E;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">www</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">docs</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">fangle</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">html</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-1000">python</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">m</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">elyxer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--</span><span 
class="ectt-1000">css</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">css</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--</span><span 
class="ectt-1000">iso885915</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--</span><span 
class="ectt-1000">html</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--</span><span 
class="ectt-1000">destdirectory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">html</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">mkdir</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">p</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cd</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">latex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">../../../</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">htlatex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">../../../</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">tex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">xhtml</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">fn</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">/&#x003C;!--</span><span 
class="ectt-1000">l</span><span 
class="ectt-1000">\.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[0-9][0-9]*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*--&#x003E;//</span><span 
class="ectt-1000">g</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">html</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">mkdir</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">p</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">literate</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cd</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">www</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">docs</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">literate</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">latex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">../../../</span><span 
class="ectt-1000">literate</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">htlatex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">../../../</span><span 
class="ectt-1000">literate</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">tex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">xhtml</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">fn</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93017r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">/&#x003C;!--</span><span 
class="ectt-1000">l</span><span 
class="ectt-1000">\.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[0-9][0-9]*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*--&#x003E;</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">g</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">literate</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">html</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-93018r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-1000">)</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">14.3   </span> <a 
 id="x1-9400014.3"></a>Extracting from the command line</h3>
<p class="noindent" >First you will need the tex output, then you can extract:
</p>

<a 
 id="noweb.lyx-build-manual-1"></a><a 
 id="x1-94001"></a><a 
href="#noweb.lyx-build-manual-1"><span 
class="ecrm-0800">87a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">lyx&#8211;build&#8211;manual</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.lyx-build-manual-1"><span 
class="ecrm-0800">87a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-198"><span class="label"><a 
 id="x1-94002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">latex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">lyx</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-94003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">tex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-94004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">module</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">tex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">./</span><span 
class="ectt-1000">fangle</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">module</span>
</div>
<p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">14.4   </span> <a 
 id="x1-9500014.4"></a>Testing</h3>

<a 
 id="noweb.test:helpers-1"></a><a 
 id="x1-95001"></a><a 
href="#noweb.test:helpers-1"><span 
class="ecrm-0800">87b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:helpers</span><span 
class="ecrm-0800">(text)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:helpers-1"><span 
class="ecrm-0800">87b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-199"><span class="label"><a 
 id="x1-95002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">passtest</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$@</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">then</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Passed</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Failed</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fi</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-1000">failtest</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">!</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$@</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">then</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Passed</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Failed</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fi</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-95016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-1000">}</span>
</div>
                                                                  

                                                                  
<p class="noindent" >
                                                                  

                                                                  
</p>
<h1 class="partHead"><span class="titlemark">Part&#x00A0;III<br /></span><a 
 id="x1-96000III"></a>Tests</h1>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;15</span><br /><a 
 id="x1-9700015"></a>Chunk Parameters</h2>

<a 
 id="noweb.test:chunk-params:sub-1"></a><a 
 id="x1-97001"></a><a 
href="#noweb.test:chunk-params:sub-1"><span 
class="ecrm-0800">90a</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:sub</span><span 
class="ecrm-0800">(THING;colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:sub-1"><span 
class="ecrm-0800">90a</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-200"><span class="label"><a 
 id="x1-97002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">I</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">see</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">THING</span><span 
class="ectt-1000">},</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">THING</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">colour</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">colour</span><span 
class="ectt-1000">},</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">and</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">looking</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">closer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:sub:sub</span><span 
class="ecrm-0800">($colour)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:sub:sub-1"><span 
class="ecrm-0800">90b</span></a><span 
class="cmsy-10">&#x27E9;</span>
</div>

<a 
 id="noweb.test:chunk-params:sub:sub-1"></a><a 
 id="x1-97005"></a><a 
href="#noweb.test:chunk-params:sub:sub-1"><span 
class="ecrm-0800">90b</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:sub:sub</span><span 
class="ecrm-0800">(colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:sub:sub-1"><span 
class="ecrm-0800">90b</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-201"><span class="label"><a 
 id="x1-97006r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">funny</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">shade</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">colour</span><span 
class="ectt-1000">}</span>
</div>

<a 
 id="noweb.test:chunk-params:text-1"></a><a 
 id="x1-97007"></a><a 
href="#noweb.test:chunk-params:text-1"><span 
class="ecrm-0800">90c</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:text</span><span 
class="ecrm-0800">(colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:text-1"><span 
class="ecrm-0800">90c</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-202"><span class="label"><a 
 id="x1-97008r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">What</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">do</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">you</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">see</span><span 
class="ectt-1000">?</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:sub</span><span 
class="ecrm-0800">(joe,</span>
<span 
class="ecrm-0800">red)</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:sub-1"><span 
class="ecrm-0800">90a</span></a><span 
class="cmsy-10">&#x27E9;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97009r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">Well</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fancy</span><span 
class="ectt-1000">!</span>
</div>
<p class="noindent" >Should generate output:
</p>

<a 
 id="noweb.test:chunk-params:result-1"></a><a 
 id="x1-97010"></a><a 
href="#noweb.test:chunk-params:result-1"><span 
class="ecrm-0800">90d</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params:result</span><span 
class="ecrm-0800">(colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params:result-1"><span 
class="ecrm-0800">90d</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-203"><span class="label"><a 
 id="x1-97011r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">What</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">do</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">you</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">see</span><span 
class="ectt-1000">?</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">I</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">see</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">joe</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97012r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">joe</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">colour</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">red</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97013r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">and</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">looking</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">closer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">funny</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">shade</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">red</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97014r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-1000">Well</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fancy</span><span 
class="ectt-1000">!</span>
</div>
<p class="noindent" >And this chunk will perform the test:
</p>

<a 
 id="noweb.test:chunk-params-1"></a><a 
 id="x1-97015"></a><a 
href="#noweb.test:chunk-params-1"><span 
class="ecrm-0800">90e</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">test:chunk&#8211;params</span><span 
class="ecrm-0800">(colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb.test:chunk-params-1"><span 
class="ecrm-0800">90e</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-204"><span class="label"><a 
 id="x1-97016r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ectt-1000">$FANGLE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">Rtest</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">params</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TMP</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">answer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exit</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97017r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ectt-1000">$FANGLE</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">Rtest</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">params</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">text</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TEX_SRC</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TMP</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exit</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-97018r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">passtest</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TMP</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">answer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$TMP</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">echo</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">chunk</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">params</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">text</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">failed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exit</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1)</span>
</div>
                                                                  

                                                                  
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;16</span><br /><a 
 id="x1-9800016"></a>Compile-log-lyx</h2>

<a 
 id="noweb../compile-log-lyx-1"></a><a 
 id="x1-98001"></a><a 
href="#noweb../compile-log-lyx-1"><span 
class="ecrm-0800">91</span></a><span 
class="cmsy-10">&#x27E8;</span><span 
class="ecti-1000">./compile&#8211;log&#8211;lyx</span><span 
class="ecrm-0800">(colour)[1]</span><span 
class="ecrm-0800">&#x00A0;</span><a 
href="#noweb../compile-log-lyx-1"><span 
class="ecrm-0800">91</span></a><span 
class="ecti-1000">,</span><span 
class="ecti-1000">&#x00A0;add</span><span 
class="ecti-1000">&#x00A0;to</span><span 
class="ecti-1000">&#x00A0;</span><span 
class="cmsy-10">&#x27E9;&equiv;</span><div class="lstlisting" id="listing-205"><span class="label"><a 
 id="x1-98002r1"></a><span 
class="ecrm-0500">1</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">!</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">bin</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">sh</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98003r2"></a><span 
class="ecrm-0500">2</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">can</span><span 
class="ecit-1000">&#8217;</span><span 
class="ecit-1000">t</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">use</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">gtkdialog</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">cos</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">it</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">uses</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">"</span><span 
class="ecit-1000">source</span><span 
class="ecit-1000">"</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">command</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">which</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">ubuntu</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">sh</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">doesn</span><span 
class="ecit-1000">&#8217;</span><span 
class="ecit-1000">t</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">have</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98004r3"></a><span 
class="ecrm-0500">3</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98005r4"></a><span 
class="ecrm-0500">4</span></span><span 
class="ectt-1000">main</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98006r5"></a><span 
class="ecrm-0500">5</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">errors</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">compile</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">log</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">$$</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98007r6"></a><span 
class="ecrm-0500">6</span></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">if</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">grep</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#8217;^[^</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">]*:\(</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">In</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">\|[0-9][0-9]*:</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">[^</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">]*:\)&#8217;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">&#x003E;</span><span 
class="ecit-1000">&#x00A0;</span><span 
class="ecit-1000">$errors</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98008r7"></a><span 
class="ecrm-0500">7</span></span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">grep</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;^[^</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]*(\([0-9][0-9]*\))</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*\(</span><span 
class="ectt-1000">error</span><span 
class="ectt-1000">\|</span><span 
class="ectt-1000">warning</span><span 
class="ectt-1000">\)&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$errors</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98009r8"></a><span 
class="ecrm-0500">8</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">then</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98010r9"></a><span 
class="ecrm-0500">9</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">e</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">/^[^</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]*[/\\]\([^/\\]*\)(\([</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0-9][</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0-9]*\))</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*/\1:\2|\2|/&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$errors</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98011r10"></a><span 
class="ecrm-0500">10</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">COMPILE_DIALOG</span><span 
class="ectt-1000">=&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98012r11"></a><span 
class="ecrm-0500">11</span></span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">vbox</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98013r12"></a><span 
class="ecrm-0500">12</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">text</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98014r13"></a><span 
class="ecrm-0500">13</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">Compiler</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">errors</span><span 
class="ectt-1000">:&#x003C;/</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98015r14"></a><span 
class="ecrm-0500">14</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">text</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98016r15"></a><span 
class="ecrm-0500">15</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">tree</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">exported_column</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98017r16"></a><span 
class="ecrm-0500">16</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">LINE</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98018r17"></a><span 
class="ecrm-0500">17</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">height</span><span 
class="ectt-1000">&#x003E;400&#x003C;/</span><span 
class="ectt-1000">height</span><span 
class="ectt-1000">&#x003E;&#x003C;</span><span 
class="ectt-1000">width</span><span 
class="ectt-1000">&#x003E;800&#x003C;/</span><span 
class="ectt-1000">width</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98019r18"></a><span 
class="ecrm-0500">18</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">File</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Line</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Message</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98020r19"></a><span 
class="ecrm-0500">19</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">action</span><span 
class="ectt-1000">&#x003E;&#8217;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">$SELF</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">lyxgoto</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$LINE</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">action</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98021r20"></a><span 
class="ecrm-0500">20</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">input</span><span 
class="ectt-1000">&#x003E;&#8217;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">cat</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">$errors</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#8217;&#x003C;/</span><span 
class="ectt-1000">input</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98022r21"></a><span 
class="ecrm-0500">21</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">tree</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98023r22"></a><span 
class="ecrm-0500">22</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">hbox</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98024r23"></a><span 
class="ecrm-0500">23</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">button</span><span 
class="ectt-1000">&#x003E;&#x003C;</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">Build</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">label</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98025r24"></a><span 
class="ecrm-0500">24</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">action</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">lyxclient</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">LYXCMD</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">build</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">program</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&#x003C;/</span><span 
class="ectt-1000">action</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98026r25"></a><span 
class="ecrm-0500">25</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">button</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98027r26"></a><span 
class="ecrm-0500">26</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">button</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ok</span><span 
class="ectt-1000">&#x003E;&#x003C;/</span><span 
class="ectt-1000">button</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98028r27"></a><span 
class="ecrm-0500">27</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">hbox</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98029r28"></a><span 
class="ecrm-0500">28</span></span><span 
class="ectt-1000">&#x003C;/</span><span 
class="ectt-1000">vbox</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98030r29"></a><span 
class="ecrm-0500">29</span></span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98031r30"></a><span 
class="ecrm-0500">30</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">export</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">COMPILE_DIALOG</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98032r31"></a><span 
class="ecrm-0500">31</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">gtkdialog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--</span><span 
class="ectt-1000">program</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">COMPILE_DIALOG</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rm</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$errors</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98033r32"></a><span 
class="ecrm-0500">32</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98034r33"></a><span 
class="ecrm-0500">33</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rm</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$errors</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98035r34"></a><span 
class="ecrm-0500">34</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fi</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98036r35"></a><span 
class="ecrm-0500">35</span></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98037r36"></a><span 
class="ecrm-0500">36</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98038r37"></a><span 
class="ecrm-0500">37</span></span><span 
class="ectt-1000">lyxgoto</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98039r38"></a><span 
class="ecrm-0500">38</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">file</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">LINE</span><span 
class="ectt-1000">%:*}</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98040r39"></a><span 
class="ecrm-0500">39</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">line</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">LINE</span><span 
class="ectt-1000">##*:}</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98041r40"></a><span 
class="ecrm-0500">40</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">extraline</span><span 
class="ectt-1000">=&#8216;</span><span 
class="ectt-1000">cat</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$file</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">head</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">n</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$line</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">tac</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;/^\\\\</span><span 
class="ectt-1000">begin</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">lstlisting</span><span 
class="ectt-1000">}/</span><span 
class="ectt-1000">q</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">|</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wc</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">l</span><span 
class="ectt-1000">&#8216;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98042r41"></a><span 
class="ecrm-0500">41</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">extraline</span><span 
class="ectt-1000">=&#8216;</span><span 
class="ectt-1000">expr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">$extraline</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1&#8216;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98043r42"></a><span 
class="ecrm-0500">42</span></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">lyxclient</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">LYXCMD</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">command</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">sequence</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">server</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">goto</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">file</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">row</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">$file</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">$line</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">char</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">repeat</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">$extraline</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">paragraph</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">down</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x2423;</span><span 
class="ectt-1000">paragraph</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">up</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">select</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98044r43"></a><span 
class="ecrm-0500">43</span></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98045r44"></a><span 
class="ecrm-0500">44</span></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98046r45"></a><span 
class="ecrm-0500">45</span></span><span 
class="ectt-1000">SELF</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98047r46"></a><span 
class="ecrm-0500">46</span></span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">test</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">z</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$COMPILE_DIALOG</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98048r47"></a><span 
class="ecrm-0500">47</span></span><span 
class="ectt-1000">then</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">main</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">$@</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-98049r48"></a><span 
class="ecrm-0500">48</span></span><span 
class="ectt-1000">fi</span>
</div>
<div class="footnotes"><p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x4-bk" id="fn1x4"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">There is some bash plumbing to get a copy of stderr but this footnote is too small</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn2x4-bk" id="fn2x4"><sup class="textsuperscript">2</sup></a></span><span 
class="ecrm-0800">It ought to apply only to subsequent chunks of the same name. I&#8217;ll fix that later</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn3x4-bk" id="fn3x4"><sup class="textsuperscript">3</sup></a></span><span 
class="ecrm-0800">on a plate</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x5-bk" id="fn1x5"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">The Lyx command </span><span 
class="ecti-0800">server-goto-file-line </span><span 
class="ecrm-0800">is used to position the Lyx cursor at the compiler</span>
<span 
class="ecrm-0800">errors.</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn2x5-bk" id="fn2x5"><sup class="textsuperscript">2</sup></a></span><span 
class="ecti-0800">So you still need noweb installed in order to use cpif</span> </p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x7-bk" id="fn1x7"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">as AWK doesn&#8217;t have nested-hash support</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn2x7-bk" id="fn2x7"><sup class="textsuperscript">2</sup></a></span><span 
class="ecrm-0800">I know that I couldn&#8217;t cope with users doing such things, and although the GPL3 license</span>
<span 
class="ecrm-0800">prevents me from actually forbidding anyone from trying, if they want it to work they&#8217;ll have to</span>
<span 
class="ecrm-0800">write the code themselves and not expect any support from me.</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn3x7-bk" id="fn3x7"><sup class="textsuperscript">3</sup></a></span><span 
class="ecrm-0800">Probably when L</span><span 
class="ecrm-0800">Y</span> <span 
class="ecrm-0800">X&#8217;s listings inset can recognize and render it, so that I no longer have to type</span>
<span 
class="ecrm-0800">=&#x003C;</span><span 
class="ecrm-0800">&hellip;&#x003E;</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn4x7-bk" id="fn4x7"><sup class="textsuperscript">4</sup></a></span><span 
class="ecrm-0800">I don&#8217;t know why I think that it will enumerate the array in order, but it seems to</span>
<span 
class="ecrm-0800">work</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x8-bk" id="fn1x8"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">Because we are using the sub-mode characters as the mode identifier it means we can&#8217;t currently</span>
<span 
class="ecrm-0800">have a mode character dependant on it&#8217;s context; i.e. </span><span 
class="ectt-0800">{ </span><span 
class="ecrm-0800">can&#8217;t behave differently when it is inside</span>
<span 
class="ectt-0800">[</span><span 
class="ecrm-0800">.</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x9-bk" id="fn1x9"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">Is there such a thing as plain </span><span class="LATEX"><span 
class="ecrm-0800">L</span><span class="A"><span 
class="ecrm-0800">A</span></span><span class="TEX"><span 
class="ecrm-0800">T</span><span 
class="E"><span 
class="ecrm-0800">E</span></span><span 
class="ecrm-0800">X</span></span></span><span 
class="ecrm-0800">?</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn2x9-bk" id="fn2x9"><sup class="textsuperscript">2</sup></a></span><span 
class="ecrm-0800">but not yet supported in the </span><span class="LATEX"><span 
class="ecrm-0800">L</span><span class="A"><span 
class="ecrm-0800">A</span></span><span class="TEX"><span 
class="ecrm-0800">T</span><span 
class="E"><span 
class="ecrm-0800">E</span></span><span 
class="ecrm-0800">X</span></span></span> <span 
class="ecrm-0800">macros</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn3x9-bk" id="fn3x9"><sup class="textsuperscript">3</sup></a></span><span 
class="ecrm-0800">So that we can print partial lines using </span><span 
class="ectt-0800">print </span><span 
class="ecrm-0800">instead of </span><span 
class="ectt-0800">printf</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn4x9-bk" id="fn4x9"><sup class="textsuperscript">4</sup></a></span><span 
class="ecrm-0800">Contrary to our use of </span><span 
class="ectt-0800">split </span><span 
class="ecrm-0800">when substituting parameters in chapter </span><a 
href="#x1-430006.3"><span 
class="ecrm-0800">6.3</span><!--tex4ht:ref: Here-we-split --></a></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x12-bk" id="fn1x12"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">The </span><span 
class="ectt-0800">params </span><span 
class="ecrm-0800">parameter is used to hold the parameters for parameterized chunks</span></p>
<p class="noindent" ><span class="footnote-mark"><a 
href="#fn1x14-bk" id="fn1x14"><sup class="textsuperscript">1</sup></a></span><span 
class="ecrm-0800">&hellip;soon </span><span 
class="ecti-0800">did </span><span 
class="ecrm-0800">run out of counters and so I had to re-write the </span><span class="LATEX"><span 
class="ecrm-0800">L</span><span class="A"><span 
class="ecrm-0800">A</span></span><span class="TEX"><span 
class="ecrm-0800">T</span><span 
class="E"><span 
class="ecrm-0800">E</span></span><span 
class="ecrm-0800">X</span></span></span> <span 
class="ecrm-0800">macros to share a counter as</span>
<span 
class="ecrm-0800">described here</span></p>                                                        </div>
 
</body></html> 

                                                                  


